/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  JournalingAssistantPlugin: () => JournalingAssistantPlugin,
  default: () => main_default
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/types.ts
var DEFAULT_SETTINGS = {
  journalFolder: "Journal",
  inputsFolder: "Inputs",
  openAIApiKey: "",
  numberOfPastEntries: 3,
  useStreamingResponse: true,
  useCustomPrompts: false,
  language: "en",
  customPromptPaths: {
    journal: "",
    chat: "",
    summary: ""
  }
};

// src/core/journal/JournalService.ts
var import_obsidian3 = require("obsidian");

// src/core/transcription/AudioProcessingService.ts
var AudioProcessingService = class {
  constructor(vault) {
    this.vault = vault;
  }
  async convertM4AtoWAV(file) {
    try {
      const arrayBuffer = await this.vault.readBinary(file);
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
      const offlineContext = new OfflineAudioContext(
        audioBuffer.numberOfChannels,
        audioBuffer.length,
        audioBuffer.sampleRate
      );
      const source = offlineContext.createBufferSource();
      source.buffer = audioBuffer;
      source.connect(offlineContext.destination);
      source.start(0);
      const renderedBuffer = await offlineContext.startRendering();
      return {
        buffer: this.createWAVFile(renderedBuffer),
        mimeType: "audio/wav"
      };
    } catch (error) {
      console.error("Error converting M4A to WAV:", error);
      throw new Error("Failed to convert M4A to WAV format");
    }
  }
  createWAVFile(audioBuffer) {
    const length = audioBuffer.length * 2;
    const outputBuffer = new ArrayBuffer(44 + length);
    const view = new DataView(outputBuffer);
    this.writeWAVHeader(view, length, audioBuffer);
    const data = new Float32Array(audioBuffer.getChannelData(0));
    let offset = 44;
    for (let i = 0; i < data.length; i++) {
      const sample = Math.max(-1, Math.min(1, data[i]));
      view.setInt16(offset, sample < 0 ? sample * 32768 : sample * 32767, true);
      offset += 2;
    }
    return outputBuffer;
  }
  writeWAVHeader(view, length, audioBuffer) {
    const writeString = (offset, string) => {
      for (let i = 0; i < string.length; i++) {
        view.setUint8(offset + i, string.charCodeAt(i));
      }
    };
    writeString(0, "RIFF");
    view.setUint32(4, 36 + length, true);
    writeString(8, "WAVE");
    writeString(12, "fmt ");
    view.setUint32(16, 16, true);
    view.setUint16(20, 1, true);
    view.setUint16(22, audioBuffer.numberOfChannels, true);
    view.setUint32(24, audioBuffer.sampleRate, true);
    view.setUint32(28, audioBuffer.sampleRate * 2, true);
    view.setUint16(32, 2, true);
    view.setUint16(34, 16, true);
    writeString(36, "data");
    view.setUint32(40, length, true);
  }
};

// src/core/ai/services/WhisperService.ts
var _WhisperService = class {
  constructor(vault, apiKey) {
    this.vault = vault;
    this.apiKey = apiKey;
    this.audioProcessor = new AudioProcessingService(vault);
  }
  setApiKey(apiKey) {
    this.apiKey = apiKey;
  }
  static isSupportedFormat(file) {
    const extension = file.extension.toLowerCase();
    return _WhisperService.SUPPORTED_FORMATS.includes(extension);
  }
  async prepareAudioForTranscription(file) {
    if (file.extension.toLowerCase() === "m4a") {
      console.log("Converting M4A to WAV format...");
      const { buffer, mimeType: mimeType2 } = await this.audioProcessor.convertM4AtoWAV(file);
      return {
        blob: new Blob([buffer], { type: mimeType2 }),
        mimeType: mimeType2
      };
    }
    const arrayBuffer = await this.vault.readBinary(file);
    const mimeType = _WhisperService.MIME_TYPES[file.extension.toLowerCase()];
    if (!mimeType) {
      throw new Error(`Unsupported MIME type for extension: ${file.extension}`);
    }
    return {
      blob: new Blob([arrayBuffer], { type: mimeType }),
      mimeType
    };
  }
  async transcribeFile(audioFile) {
    var _a;
    try {
      if (!this.apiKey) {
        throw new Error("OpenAI API key is required for transcription");
      }
      if (!_WhisperService.isSupportedFormat(audioFile)) {
        throw new Error(`Unsupported audio format: ${audioFile.extension}`);
      }
      const { blob, mimeType } = await this.prepareAudioForTranscription(audioFile);
      console.log(`Processing file: ${audioFile.name} with MIME type: ${mimeType}`);
      const formData = new FormData();
      const extension = audioFile.extension.toLowerCase() === "m4a" ? "wav" : audioFile.extension;
      formData.append("file", blob, `${audioFile.basename}.${extension}`);
      formData.append("model", "whisper-1");
      const response = await fetch("https://api.openai.com/v1/audio/transcriptions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${this.apiKey}`
        },
        body: formData
      });
      if (!response.ok) {
        const errorData = await response.json();
        console.error("OpenAI API Error:", {
          status: response.status,
          statusText: response.statusText,
          error: errorData
        });
        throw new Error(((_a = errorData.error) == null ? void 0 : _a.message) || `Transcription failed with status ${response.status}`);
      }
      const result = await response.json();
      return result.text;
    } catch (error) {
      console.error("Detailed transcription error:", {
        fileName: audioFile.name,
        extension: audioFile.extension,
        error: error instanceof Error ? {
          message: error.message,
          stack: error.stack
        } : error
      });
      throw error;
    }
  }
};
var WhisperService = _WhisperService;
WhisperService.SUPPORTED_FORMATS = ["flac", "mp3", "mp4", "mpeg", "mpga", "m4a", "ogg", "wav", "webm"];
WhisperService.MIME_TYPES = {
  "flac": "audio/flac",
  "mp3": "audio/mpeg",
  "mp4": "audio/mp4",
  "mpeg": "audio/mpeg",
  "mpga": "audio/mpeg",
  "m4a": "audio/mp4",
  "ogg": "audio/ogg",
  "wav": "audio/wav",
  "webm": "audio/webm"
};

// src/core/transcription/TranscriptionService.ts
var import_obsidian = require("obsidian");

// src/utils/helpers.ts
var getRecordingEmbedPattern = () => {
  return /!\[\[.+\.(flac|mp3|mp4|mpeg|mpga|m4a|ogg|wav|webm)\]\]/g;
};
var getTodayFileName = () => {
  const date = new Date();
  return date.toISOString().split("T")[0] + ".md";
};

// src/core/transcription/TranscriptionService.ts
var TranscriptionService = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
    this.whisperService = new WhisperService(this.app.vault, this.settings.openAIApiKey);
  }
  updateSettings(settings) {
    this.settings = settings;
    this.whisperService.setApiKey(settings.openAIApiKey);
  }
  async transcribeRecordings() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (!activeView) {
      new import_obsidian.Notice("Please open a note first");
      return;
    }
    if (!this.settings.openAIApiKey) {
      new import_obsidian.Notice("OpenAI API key not configured");
      return;
    }
    const editor = activeView.editor;
    const content = editor.getValue();
    const recordingPattern = getRecordingEmbedPattern();
    const recordings = content.match(recordingPattern);
    if (!recordings || recordings.length === 0) {
      new import_obsidian.Notice("No recordings found in the current note");
      return;
    }
    new import_obsidian.Notice("Starting transcription...");
    let updatedContent = content;
    let hasErrors = false;
    try {
      for (const recording of recordings) {
        const fileName = recording.slice(3, -2);
        const file = this.app.metadataCache.getFirstLinkpathDest(fileName, "");
        if (!(file instanceof import_obsidian.TFile)) {
          new import_obsidian.Notice(`Could not find file: ${fileName}`);
          hasErrors = true;
          continue;
        }
        try {
          const transcript = await this.whisperService.transcribeFile(file);
          updatedContent = updatedContent.replace(recording, transcript);
        } catch (error) {
          new import_obsidian.Notice(`Failed to transcribe ${fileName}: ${error.message}`);
          hasErrors = true;
          continue;
        }
      }
      editor.setValue(updatedContent);
      if (hasErrors) {
        new import_obsidian.Notice("Transcription completed with some errors");
      } else {
        new import_obsidian.Notice("Transcription completed successfully");
      }
    } catch (error) {
      new import_obsidian.Notice(`Transcription failed: ${error.message}`);
      console.error("Transcription error:", error);
    }
  }
};

// src/core/summary/SummarizationService.ts
var import_obsidian2 = require("obsidian");
var SummarizationService = class {
  constructor(openAIService, promptService) {
    this.openAIService = openAIService;
    this.promptService = promptService;
  }
  async summarize(content, useStreaming = false, onChunk) {
    try {
      const summaryPrompt = await this.promptService.getPrompt("summary");
      const prompt = `${summaryPrompt}

${content}`;
      return await this.openAIService.makeOpenAIRequest(
        prompt,
        useStreaming ? onChunk : void 0
      );
    } catch (error) {
      new import_obsidian2.Notice(`Error during summarization: ${error.message}`);
      throw error;
    }
  }
};

// src/core/ai/services/ChatService.ts
var ChatService = class {
  constructor(openAIService, promptService) {
    this.openAIService = openAIService;
    this.promptService = promptService;
  }
  async chat(transcribedText) {
    const chatPrompt = await this.promptService.getPrompt("chat");
    const prompt = `${chatPrompt}

User: ${transcribedText}

Assistant:`;
    return this.openAIService.makeOpenAIRequest(prompt);
  }
};

// src/core/journal/JournalManager.ts
var JournalManager = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  async ensureFolder(folderPath) {
    if (!await this.app.vault.adapter.exists(folderPath)) {
      await this.app.vault.createFolder(folderPath);
    }
  }
  getTodayFileName() {
    return getTodayFileName();
  }
  async getPastJournalEntries(count) {
    const folder = this.app.vault.getAbstractFileByPath(this.settings.journalFolder);
    if (!folder)
      return [];
    const files = this.app.vault.getMarkdownFiles().filter((file) => file.path.startsWith(this.settings.journalFolder + "/")).sort((a, b) => b.stat.mtime - a.stat.mtime).slice(1, count + 1);
    const entries = await Promise.all(
      files.map(async (file) => {
        const content = await this.app.vault.read(file);
        return {
          date: file.basename,
          content
        };
      })
    );
    return entries.map((entry) => `Date: ${entry.date}
${entry.content}`);
  }
  async createNewJournalEntry() {
    const fileName = this.getTodayFileName();
    const filePath = `${this.settings.journalFolder}/${fileName}`;
    const initialContent = `# Journal Entry - ${new Date().toLocaleDateString()}

`;
    return await this.app.vault.create(filePath, initialContent);
  }
};

// src/core/journal/JournalService.ts
var _JournalService = class {
  constructor(app, settings, openAIService, promptService) {
    this.app = app;
    this.settings = settings;
    this.openAIService = openAIService;
    this.promptService = promptService;
    this.journalManager = new JournalManager(this.app, this.settings);
    this.whisperService = new WhisperService(this.app.vault, this.settings.openAIApiKey);
    this.summarizationService = new SummarizationService(this.openAIService, this.promptService);
    this.chatService = new ChatService(this.openAIService, this.promptService);
    this.transcriptionService = new TranscriptionService(this.app, this.settings);
  }
  updateSettings(settings) {
    this.settings = settings;
    this.whisperService.setApiKey(settings.openAIApiKey);
    this.transcriptionService.updateSettings(settings);
    this.openAIService.updateSettings(settings);
  }
  async openTodaysJournal() {
    try {
      await this.journalManager.ensureFolder(this.settings.journalFolder);
      const filePath = `${this.settings.journalFolder}/${this.journalManager.getTodayFileName()}`;
      let file = this.app.vault.getAbstractFileByPath(filePath);
      if (!file) {
        const loadingNotice = new import_obsidian3.Notice("Generating journal prompt...", 0);
        try {
          file = await this.journalManager.createNewJournalEntry();
          const pastEntries = await this.journalManager.getPastJournalEntries(this.settings.numberOfPastEntries);
          const leaf = this.app.workspace.getLeaf(false);
          await leaf.openFile(file);
          const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
          if (view) {
            if (this.settings.useStreamingResponse) {
              await this.openAIService.makeOpenAIRequest(
                await this.createJournalPrompt(pastEntries),
                (chunk) => {
                  const currentContent = view.editor.getValue();
                  view.editor.setValue(currentContent + chunk);
                }
              );
            } else {
              const aiPrompt = await this.openAIService.makeOpenAIRequest(
                await this.createJournalPrompt(pastEntries)
              );
              view.editor.setValue(view.editor.getValue() + aiPrompt);
            }
            view.editor.setValue(view.editor.getValue() + "\n\n## Your Journal Response\n\n");
          }
          loadingNotice.hide();
          new import_obsidian3.Notice("Created new journal entry for today");
        } catch (error) {
          new import_obsidian3.Notice("Error generating prompt: " + error.message);
          const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
          if (view) {
            view.editor.setValue(view.editor.getValue() + "\n\n## Your Journal Response\n\n");
          }
        }
      } else {
        const leaf = this.app.workspace.getLeaf(false);
        await leaf.openFile(file);
      }
    } catch (error) {
      new import_obsidian3.Notice("Error opening today's journal: " + error.message);
      console.error("Error opening today's journal:", error);
    }
  }
  async createJournalPrompt(pastEntries) {
    const journalPrompt = await this.promptService.getPrompt("journal");
    const pastEntriesText = pastEntries.length > 0 ? `Past Entries:

${pastEntries.join("\n\n---\n\n")}` : "No past entries available.";
    return `${journalPrompt}

${pastEntriesText}`;
  }
  async summarizeJournalingSession() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView || !activeView.file) {
      new import_obsidian3.Notice("Please open a note first");
      return;
    }
    try {
      const originalContent = activeView.editor.getValue();
      const fileName = activeView.file.name;
      const inputPath = `${this.settings.inputsFolder}/${fileName}`;
      await this.journalManager.ensureFolder(this.settings.inputsFolder);
      await this.app.vault.create(inputPath, originalContent);
      await this.transcriptionService.transcribeRecordings();
      const processedContent = activeView.editor.getValue();
      const responseMatch = processedContent.match(_JournalService.JOURNAL_RESPONSE_PATTERN);
      if (!responseMatch) {
        new import_obsidian3.Notice("Could not find journal response section");
        return;
      }
      const userResponse = responseMatch[1].trim();
      let summary;
      if (this.settings.useStreamingResponse) {
        let streamedSummary = "";
        summary = await this.summarizationService.summarize(
          userResponse,
          true,
          (chunk) => {
            streamedSummary += chunk;
            const updatedContent = processedContent.replace(
              _JournalService.JOURNAL_RESPONSE_PATTERN,
              `## Your Journal Response

${streamedSummary}`
            );
            activeView.editor.setValue(updatedContent);
          }
        );
      } else {
        summary = await this.summarizationService.summarize(userResponse);
        const updatedContent = processedContent.replace(
          _JournalService.JOURNAL_RESPONSE_PATTERN,
          `## Your Journal Response

${summary}`
        );
        activeView.editor.setValue(updatedContent);
      }
      new import_obsidian3.Notice("Journal session summarized");
    } catch (error) {
      new import_obsidian3.Notice(`Error: ${error.message}`);
      console.error("Summarization error:", error);
    }
  }
  async chatWithAI() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView) {
      new import_obsidian3.Notice("Please open a note first");
      return;
    }
    try {
      await this.transcriptionService.transcribeRecordings();
      const content = activeView.editor.getValue();
      const chatResponse = await this.chatService.chat(content);
      activeView.editor.setValue(
        content + "\n\n---\n## AI Chat\n\n" + chatResponse + "\n\n---\n## Me\n"
      );
      new import_obsidian3.Notice("AI responded in note");
    } catch (error) {
      new import_obsidian3.Notice(`Error during chat: ${error.message}`);
    }
  }
};
var JournalService = _JournalService;
JournalService.JOURNAL_RESPONSE_PATTERN = /## Your Journal Response\s*([\s\S]*$)/;

// src/core/ai/services/OpenAIService.ts
var OpenAIService = class {
  constructor(settings) {
    this.settings = settings;
  }
  updateSettings(settings) {
    this.settings = settings;
  }
  async makeOpenAIRequest(prompt, onChunk) {
    var _a, _b, _c, _d;
    if (!this.settings.openAIApiKey) {
      throw new Error("OpenAI API key not configured");
    }
    try {
      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${this.settings.openAIApiKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "gpt-4o-mini",
          messages: [{ role: "user", content: prompt }],
          temperature: 0.7,
          stream: !!onChunk
        })
      });
      if (!response.ok) {
        const error = await response.json();
        throw new Error(((_a = error.error) == null ? void 0 : _a.message) || "API request failed");
      }
      if (onChunk) {
        const reader = (_b = response.body) == null ? void 0 : _b.getReader();
        const decoder = new TextDecoder();
        let fullResponse = "";
        if (!reader)
          throw new Error("Response body is null");
        while (true) {
          const { done, value } = await reader.read();
          if (done)
            break;
          const chunk = decoder.decode(value);
          const lines = chunk.split("\n").filter((line) => line.trim() !== "");
          for (const line of lines) {
            if (line.includes("[DONE]"))
              continue;
            if (!line.startsWith("data:"))
              continue;
            try {
              const json = JSON.parse(line.slice(5));
              const content = (_d = (_c = json.choices[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                fullResponse += content;
                onChunk(content);
              }
            } catch (e) {
              console.warn("Failed to parse streaming response:", e);
            }
          }
        }
        return fullResponse;
      }
      const data = await response.json();
      return data.choices[0].message.content;
    } catch (error) {
      console.error("OpenAI API error:", error);
      throw error;
    }
  }
};

// src/settings/SettingTab.ts
var import_obsidian4 = require("obsidian");
var JournalingAssistantSettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Journaling Assistant Settings" });
    new import_obsidian4.Setting(containerEl).setName("Journal Folder").setDesc("The folder where your journal entries will be stored").addText((text) => text.setPlaceholder("Journal").setValue(this.plugin.settings.journalFolder).onChange(async (value) => {
      this.plugin.settings.journalFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Journal Inputs Folder").setDesc("The folder where your journal inputs will be stored").addText((text) => text.setPlaceholder("Inputs").setValue(this.plugin.settings.inputsFolder).onChange(async (value) => {
      this.plugin.settings.inputsFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("OpenAI API Key").setDesc("Your OpenAI API key for generating prompts and summaries").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openAIApiKey).onChange(async (value) => {
      this.plugin.settings.openAIApiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Number of Past Entries").setDesc("Number of past journal entries to consider when generating prompts").addSlider((slider) => slider.setLimits(0, 10, 1).setValue(this.plugin.settings.numberOfPastEntries).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.numberOfPastEntries = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Use Streaming Response").setDesc("Stream AI responses in real-time (recommended for better experience)").addToggle((toggle) => toggle.setValue(this.plugin.settings.useStreamingResponse).onChange(async (value) => {
      this.plugin.settings.useStreamingResponse = value;
      await this.plugin.saveSettings();
    }));
    containerEl.createEl("h3", { text: "Prompt Settings" });
    new import_obsidian4.Setting(containerEl).setName("Use Custom Prompts").setDesc("Toggle between default language prompts and custom prompts").addToggle((toggle) => toggle.setValue(this.plugin.settings.useCustomPrompts).onChange(async (value) => {
      this.plugin.settings.useCustomPrompts = value;
      await this.plugin.saveSettings();
      this.display();
    }));
    if (!this.plugin.settings.useCustomPrompts) {
      new import_obsidian4.Setting(containerEl).setName("Language").setDesc("Select prompt language").addDropdown((dropdown) => dropdown.addOption("en", "English").addOption("pl", "Polish").setValue(this.plugin.settings.language).onChange(async (value) => {
        this.plugin.settings.language = value;
        await this.plugin.saveSettings();
      }));
    } else {
      new import_obsidian4.Setting(containerEl).setName("Journal Prompt File").setDesc("Path to custom journal prompt file").addText((text) => text.setPlaceholder("prompts/journal.md").setValue(this.plugin.settings.customPromptPaths.journal).onChange(async (value) => {
        this.plugin.settings.customPromptPaths.journal = value;
        await this.plugin.saveSettings();
      }));
      new import_obsidian4.Setting(containerEl).setName("Chat Prompt File").setDesc("Path to custom chat prompt file").addText((text) => text.setPlaceholder("prompts/chat.md").setValue(this.plugin.settings.customPromptPaths.chat).onChange(async (value) => {
        this.plugin.settings.customPromptPaths.chat = value;
        await this.plugin.saveSettings();
      }));
      new import_obsidian4.Setting(containerEl).setName("Summary Prompt File").setDesc("Path to custom summary prompt file").addText((text) => text.setPlaceholder("prompts/summary.md").setValue(this.plugin.settings.customPromptPaths.summary).onChange(async (value) => {
        this.plugin.settings.customPromptPaths.summary = value;
        await this.plugin.saveSettings();
      }));
    }
  }
};

// src/core/ai/prompts/en/chatPrompt.ts
var chatPrompt_default = `As an AI journaling assistant, you are helping the user explore their thoughts and goals.
Guiding principles:
\u2022 Maintain a friendly, empathetic tone
\u2022 Please keep it a conversation, not a list of questions, use second person, and use the word "you"
\u2022 The user should feel like they are talking to a wise mentor friend
\u2022 Ask clarifying questions or deeper prompts
\u2022 Avoid steering the user to specific beliefs or conclusions unless they are explicitly asking for it
\u2022 Keep the conversation relevant to the user's stated goals
\u2022 Encourage reflection and actionable outcomes where appropriate
Remember: all interactions take place in the user's note.`;

// src/core/ai/prompts/en/journalPrompt.ts
var journalPrompt_default = `As a friendly journaling guide, analyze these past journal entries and create a thought-provoking prompt 
that encourages deeper self-reflection while maintaining continuity with previous themes and insights. 
Write the outline in a second person, the user should feel like they are talking to a friend.

Before the prompt:
1. Outline the aspects of past entries to allow for better self-reflection, only if there are past entries.
2. Don't make up information, only use the information that is provided in the past entries.
3. Keep a friendly tone, the user should feel like they are talking to a friend
4. Be concise and to the point
5. Always start with "## Recap of past entries", even if there are no past entries.
6. If there's an information that there are no past entries, just write "No past entries available."

The prompt should:
1. Be specific and actionable
2. Keep a friendly tone, the user should feel like they are talking to a friend
3. Don't steer the user into any particular direction, we want to let the user explore their own thoughts and feelings
4. Make the prompt open-ended, in the first message we want to explore how the user is feeling today and what they want to achieve with the journal
5. Inform the user that they can choose one question and continue conversation with the assistant
6. Be concise, if you ask questions, make them a list of bullet points so it's easy to read
7. Start with "## Today's Prompt"

Keep the prompt concise and focused on a single aspect of self-reflection. Please structure your output so it's easy to read and understand.

The final structure should look like this:

## Recap of past entries
<outline of past entries>

## Today's Prompt
<prompt>`;

// src/core/ai/prompts/en/summaryPrompt.ts
var summaryPrompt_default = `As a journaling assistant, analyze this journal entry and create a summary of journaling conversation.

Please follow these guidelines:

1. Think about the highlights of the journal entry that the user would want to remember for the future
2. Retrieve the memories of the user from the journal entry
3. Identify the main themes and insights
4. Highlight key realizations or breakthroughs
5. Note any action items or intentions expressed
6. Preserve the emotional tone of the entry

Focus on extracting the most meaningful elements while maintaining the personal nature of the reflection.`;

// src/core/ai/prompts/pl/chatPrompt.ts
var chatPrompt_default2 = `Jako asystent AI do prowadzenia dziennika, pomagasz u\u017Cytkownikowi eksplorowa\u0107 jego my\u015Bli i cele.
Zasady przewodnie:
\u2022 Zachowaj przyjazny, empatyczny ton
\u2022 Prowad\u017A konwersacj\u0119, nie list\u0119 pyta\u0144, u\u017Cywaj drugiej osoby i s\u0142owa "ty"
\u2022 U\u017Cytkownik powinien czu\u0107, \u017Ce rozmawia z m\u0105drym przyjacielem-mentorem
\u2022 Zadawaj pytania wyja\u015Bniaj\u0105ce lub g\u0142\u0119bsze
\u2022 Unikaj kierowania u\u017Cytkownika w stron\u0119 konkretnych przekona\u0144 lub wniosk\xF3w, chyba \u017Ce wyra\u017Anie o to prosi
\u2022 Utrzymuj rozmow\u0119 zwi\u0105zan\u0105 z okre\u015Blonymi celami u\u017Cytkownika
\u2022 Zach\u0119caj do refleksji i dzia\u0142a\u0144, gdy to w\u0142a\u015Bciwe
Pami\u0119taj: wszystkie interakcje odbywaj\u0105 si\u0119 w notatce u\u017Cytkownika.`;

// src/core/ai/prompts/pl/journalPrompt.ts
var journalPrompt_default2 = `Jako przyjazny przewodnik po dzienniku, przeanalizuj poprzednie wpisy i stw\xF3rz sk\u0142aniaj\u0105ce do my\u015Blenia pytanie,
kt\xF3re zach\u0119ci do g\u0142\u0119bszej autorefleksji, zachowuj\u0105c ci\u0105g\u0142o\u015B\u0107 z poprzednimi tematami i spostrze\u017Ceniami.
Pisz w drugiej osobie, u\u017Cytkownik powinien czu\u0107, \u017Ce rozmawia z przyjacielem.

Przed pytaniem:
1. Przedstaw aspekty poprzednich wpis\xF3w, aby umo\u017Cliwi\u0107 lepsz\u0105 autorefleksj\u0119, tylko je\u015Bli s\u0105 poprzednie wpisy.
2. Nie wymy\u015Blaj informacji, u\u017Cywaj tylko tych, kt\xF3re znajduj\u0105 si\u0119 w poprzednich wpisach.
3. Zachowaj przyjazny ton, u\u017Cytkownik powinien czu\u0107, \u017Ce rozmawia z przyjacielem
4. B\u0105d\u017A zwi\u0119z\u0142y i rzeczowy
5. Zawsze zaczynaj od "## Podsumowanie poprzednich wpis\xF3w", nawet je\u015Bli nie ma poprzednich wpis\xF3w.
6. Je\u015Bli nie ma poprzednich wpis\xF3w, napisz po prostu "Brak poprzednich wpis\xF3w."

Pytanie powinno:
1. By\u0107 konkretne i mo\u017Cliwe do realizacji
2. Zachowa\u0107 przyjazny ton, u\u017Cytkownik powinien czu\u0107, \u017Ce rozmawia z przyjacielem
3. Nie kierowa\u0107 u\u017Cytkownika w \u017Cadnym konkretnym kierunku, chcemy pozwoli\u0107 u\u017Cytkownikowi eksplorowa\u0107 w\u0142asne my\u015Bli i uczucia
4. By\u0107 otwarte, w pierwszej wiadomo\u015Bci chcemy pozna\u0107, jak u\u017Cytkownik czuje si\u0119 dzi\u015B i co chce osi\u0105gn\u0105\u0107 poprzez dziennik
5. Poinformowa\u0107 u\u017Cytkownika, \u017Ce mo\u017Ce wybra\u0107 jedno pytanie i kontynuowa\u0107 rozmow\u0119 z asystentem
6. By\u0107 zwi\u0119z\u0142e, je\u015Bli zadajesz pytania, przedstaw je jako list\u0119 punkt\xF3w, aby by\u0142y \u0142atwe do przeczytania
7. Zaczyna\u0107 si\u0119 od "## Dzisiejsze pytanie"

Zachowaj zwi\u0119z\u0142o\u015B\u0107 pytania i skup si\u0119 na jednym aspekcie autorefleksji. Prosz\u0119 ustrukturyzuj swoj\u0105 odpowied\u017A tak, aby by\u0142a \u0142atwa do przeczytania i zrozumienia.

Ko\u0144cowa struktura powinna wygl\u0105da\u0107 tak:

## Podsumowanie poprzednich wpis\xF3w
<zarys poprzednich wpis\xF3w>

## Dzisiejsze pytanie
<pytanie>`;

// src/core/ai/prompts/pl/summaryPrompt.ts
var summaryPrompt_default2 = `Jako asystent prowadzenia dziennika, przeanalizuj ten wpis i stw\xF3rz podsumowanie rozmowy.

Prosz\u0119 post\u0119puj zgodnie z tymi wytycznymi:

1. Pomy\u015Bl o najwa\u017Cniejszych punktach wpisu, kt\xF3re u\u017Cytkownik chcia\u0142by zapami\u0119ta\u0107 na przysz\u0142o\u015B\u0107
2. Wydob\u0105d\u017A wspomnienia u\u017Cytkownika z wpisu
3. Zidentyfikuj g\u0142\xF3wne tematy i spostrze\u017Cenia
4. Podkre\u015Bl kluczowe odkrycia lub prze\u0142omowe momenty
5. Zanotuj wszelkie zaplanowane dzia\u0142ania lub wyra\u017Cone intencje
6. Zachowaj emocjonalny ton wpisu

Skup si\u0119 na wydobyciu najbardziej znacz\u0105cych element\xF3w, zachowuj\u0105c osobisty charakter refleksji.`;

// src/core/ai/services/PromptService.ts
var PromptService = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
    this.defaultPrompts = {
      en: {
        chat: chatPrompt_default,
        journal: journalPrompt_default,
        summary: summaryPrompt_default
      },
      pl: {
        chat: chatPrompt_default2,
        journal: journalPrompt_default2,
        summary: summaryPrompt_default2
      }
    };
  }
  async getPrompt(type) {
    if (this.settings.useCustomPrompts) {
      const path = this.settings.customPromptPaths[type];
      if (!path) {
        throw new Error(`Custom prompt path not set for ${type}`);
      }
      const file = this.app.vault.getAbstractFileByPath(path);
      if (!file) {
        throw new Error(`Custom prompt file not found: ${path}`);
      }
      try {
        return await this.app.vault.read(file);
      } catch (error) {
        throw new Error(`Failed to read custom prompt file: ${error.message}`);
      }
    }
    return this.defaultPrompts[this.settings.language][type];
  }
  updateSettings(settings) {
    this.settings = settings;
  }
};

// main.ts
var JournalingAssistantPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    this.openAIService = new OpenAIService(this.settings);
    this.transcriptionService = new TranscriptionService(this.app, this.settings);
    this.promptService = new PromptService(this.app, this.settings);
    this.journalService = new JournalService(
      this.app,
      this.settings,
      this.openAIService,
      this.promptService
    );
    this.addSettingTab(new JournalingAssistantSettingTab(this.app, this));
    this.addRibbonIcon("bot", "Journaling Assistant", (evt) => {
      const menu = new import_obsidian5.Menu();
      menu.addItem(
        (item) => item.setTitle("Open Today's Journal").setIcon("calendar-plus").onClick(() => {
          this.journalService.openTodaysJournal();
        })
      );
      menu.addItem(
        (item) => item.setTitle("Chat with AI").setIcon("message-square").onClick(() => {
          this.journalService.chatWithAI();
        })
      );
      menu.addItem(
        (item) => item.setTitle("Summarize Journaling Session").setIcon("book").onClick(() => {
          this.journalService.summarizeJournalingSession();
        })
      );
      menu.showAtMouseEvent(evt);
    });
    this.addCommands();
  }
  addCommands() {
    this.addCommand({
      id: "open-todays-journal",
      name: "Open Today's Journal",
      callback: async () => {
        await this.journalService.openTodaysJournal();
      }
    });
    this.addCommand({
      id: "transcribe-recordings",
      name: "Transcribe Recordings",
      callback: async () => {
        await this.transcriptionService.transcribeRecordings();
      }
    });
    this.addCommand({
      id: "summarize-journal",
      name: "Summarize Journaling Session",
      callback: async () => {
        await this.journalService.summarizeJournalingSession();
      }
    });
    this.addCommand({
      id: "chat-with-ai",
      name: "Chat with AI",
      callback: async () => {
        await this.journalService.chatWithAI();
      }
    });
  }
  async loadSettings() {
    const data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.openAIService.updateSettings(this.settings);
    this.transcriptionService.updateSettings(this.settings);
    this.journalService.updateSettings(this.settings);
    this.promptService.updateSettings(this.settings);
  }
  onunload() {
    console.log("Unloading Journaling Assistant Plugin...");
  }
};
var main_default = JournalingAssistantPlugin;
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdHlwZXMudHMiLCAic3JjL2NvcmUvam91cm5hbC9Kb3VybmFsU2VydmljZS50cyIsICJzcmMvY29yZS90cmFuc2NyaXB0aW9uL0F1ZGlvUHJvY2Vzc2luZ1NlcnZpY2UudHMiLCAic3JjL2NvcmUvYWkvc2VydmljZXMvV2hpc3BlclNlcnZpY2UudHMiLCAic3JjL2NvcmUvdHJhbnNjcmlwdGlvbi9UcmFuc2NyaXB0aW9uU2VydmljZS50cyIsICJzcmMvdXRpbHMvaGVscGVycy50cyIsICJzcmMvY29yZS9zdW1tYXJ5L1N1bW1hcml6YXRpb25TZXJ2aWNlLnRzIiwgInNyYy9jb3JlL2FpL3NlcnZpY2VzL0NoYXRTZXJ2aWNlLnRzIiwgInNyYy9jb3JlL2pvdXJuYWwvSm91cm5hbE1hbmFnZXIudHMiLCAic3JjL2NvcmUvYWkvc2VydmljZXMvT3BlbkFJU2VydmljZS50cyIsICJzcmMvc2V0dGluZ3MvU2V0dGluZ1RhYi50cyIsICJzcmMvY29yZS9haS9wcm9tcHRzL2VuL2NoYXRQcm9tcHQudHMiLCAic3JjL2NvcmUvYWkvcHJvbXB0cy9lbi9qb3VybmFsUHJvbXB0LnRzIiwgInNyYy9jb3JlL2FpL3Byb21wdHMvZW4vc3VtbWFyeVByb21wdC50cyIsICJzcmMvY29yZS9haS9wcm9tcHRzL3BsL2NoYXRQcm9tcHQudHMiLCAic3JjL2NvcmUvYWkvcHJvbXB0cy9wbC9qb3VybmFsUHJvbXB0LnRzIiwgInNyYy9jb3JlL2FpL3Byb21wdHMvcGwvc3VtbWFyeVByb21wdC50cyIsICJzcmMvY29yZS9haS9zZXJ2aWNlcy9Qcm9tcHRTZXJ2aWNlLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBBcHAsIFBsdWdpbiwgTm90aWNlLCBNZW51IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSAnLi9zcmMvdHlwZXMnO1xuaW1wb3J0IHsgSm91cm5hbFNlcnZpY2UgfSBmcm9tICcuL3NyYy9jb3JlL2pvdXJuYWwvSm91cm5hbFNlcnZpY2UnO1xuaW1wb3J0IHsgT3BlbkFJU2VydmljZSB9IGZyb20gJy4vc3JjL2NvcmUvYWkvc2VydmljZXMvT3BlbkFJU2VydmljZSc7XG5pbXBvcnQgeyBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ1RhYiB9IGZyb20gJy4vc3JjL3NldHRpbmdzL1NldHRpbmdUYWInO1xuaW1wb3J0IHsgVHJhbnNjcmlwdGlvblNlcnZpY2UgfSBmcm9tICcuL3NyYy9jb3JlL3RyYW5zY3JpcHRpb24vVHJhbnNjcmlwdGlvblNlcnZpY2UnO1xuaW1wb3J0IHsgUHJvbXB0U2VydmljZSB9IGZyb20gJy4vc3JjL2NvcmUvYWkvc2VydmljZXMvUHJvbXB0U2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBKb3VybmFsaW5nQXNzaXN0YW50UGx1Z2luIGV4dGVuZHMgUGx1Z2luIHtcbiAgICBzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzO1xuICAgIHByaXZhdGUgam91cm5hbFNlcnZpY2U6IEpvdXJuYWxTZXJ2aWNlO1xuICAgIHByaXZhdGUgb3BlbkFJU2VydmljZTogT3BlbkFJU2VydmljZTtcbiAgICBwcml2YXRlIHRyYW5zY3JpcHRpb25TZXJ2aWNlOiBUcmFuc2NyaXB0aW9uU2VydmljZTtcbiAgICBwcml2YXRlIHByb21wdFNlcnZpY2U6IFByb21wdFNlcnZpY2U7XG5cbiAgICBhc3luYyBvbmxvYWQoKSB7XG4gICAgICAgIGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG4gICAgICAgIFxuICAgICAgICAvLyBJbml0aWFsaXplIHNlcnZpY2VzIHdpdGggdGhlIG5ldyBzdHJ1Y3R1cmVcbiAgICAgICAgdGhpcy5vcGVuQUlTZXJ2aWNlID0gbmV3IE9wZW5BSVNlcnZpY2UodGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UgPSBuZXcgVHJhbnNjcmlwdGlvblNlcnZpY2UodGhpcy5hcHAsIHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLnByb21wdFNlcnZpY2UgPSBuZXcgUHJvbXB0U2VydmljZSh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuam91cm5hbFNlcnZpY2UgPSBuZXcgSm91cm5hbFNlcnZpY2UoXG4gICAgICAgICAgICB0aGlzLmFwcCwgXG4gICAgICAgICAgICB0aGlzLnNldHRpbmdzLCBcbiAgICAgICAgICAgIHRoaXMub3BlbkFJU2VydmljZSxcbiAgICAgICAgICAgIHRoaXMucHJvbXB0U2VydmljZVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIEFkZCBzZXR0aW5ncyB0YWJcbiAgICAgICAgdGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG4gICAgICAgIC8vIEFkZCByaWJib24gaWNvbiB3aXRoIG1lbnVcbiAgICAgICAgdGhpcy5hZGRSaWJib25JY29uKCdib3QnLCAnSm91cm5hbGluZyBBc3Npc3RhbnQnLCAoZXZ0OiBNb3VzZUV2ZW50IHwgUG9pbnRlckV2ZW50KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBtZW51ID0gbmV3IE1lbnUoKTtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIk9wZW4gVG9kYXkncyBKb3VybmFsXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdjYWxlbmRhci1wbHVzJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb3VybmFsU2VydmljZS5vcGVuVG9kYXlzSm91cm5hbCgpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIkNoYXQgd2l0aCBBSVwiKVxuICAgICAgICAgICAgICAgICAgICAuc2V0SWNvbignbWVzc2FnZS1zcXVhcmUnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvdXJuYWxTZXJ2aWNlLmNoYXRXaXRoQUkoKTtcbiAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBtZW51LmFkZEl0ZW0oKGl0ZW0pID0+XG4gICAgICAgICAgICAgICAgaXRlbVxuICAgICAgICAgICAgICAgICAgICAuc2V0VGl0bGUoXCJTdW1tYXJpemUgSm91cm5hbGluZyBTZXNzaW9uXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdib29rJylcbiAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5qb3VybmFsU2VydmljZS5zdW1tYXJpemVKb3VybmFsaW5nU2Vzc2lvbigpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIG1lbnUuc2hvd0F0TW91c2VFdmVudChldnQpO1xuICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLmFkZENvbW1hbmRzKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBhZGRDb21tYW5kcygpIHtcbiAgICAgICAgLy8gQ29tbWFuZCB0byBvcGVuIHRvZGF5J3Mgam91cm5hbFxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdvcGVuLXRvZGF5cy1qb3VybmFsJyxcbiAgICAgICAgICAgIG5hbWU6ICdPcGVuIFRvZGF5XFwncyBKb3VybmFsJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5qb3VybmFsU2VydmljZS5vcGVuVG9kYXlzSm91cm5hbCgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29tbWFuZCB0byB0cmFuc2NyaWJlIHJlY29yZGluZ3NcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAndHJhbnNjcmliZS1yZWNvcmRpbmdzJyxcbiAgICAgICAgICAgIG5hbWU6ICdUcmFuc2NyaWJlIFJlY29yZGluZ3MnLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnRyYW5zY3JpcHRpb25TZXJ2aWNlLnRyYW5zY3JpYmVSZWNvcmRpbmdzKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDb21tYW5kIHRvIHN1bW1hcml6ZSBqb3VybmFsXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ3N1bW1hcml6ZS1qb3VybmFsJyxcbiAgICAgICAgICAgIG5hbWU6ICdTdW1tYXJpemUgSm91cm5hbGluZyBTZXNzaW9uJyxcbiAgICAgICAgICAgIGNhbGxiYWNrOiBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5qb3VybmFsU2VydmljZS5zdW1tYXJpemVKb3VybmFsaW5nU2Vzc2lvbigpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLy8gQ29tbWFuZCB0byBjaGF0IHdpdGggQUlcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnY2hhdC13aXRoLWFpJyxcbiAgICAgICAgICAgIG5hbWU6ICdDaGF0IHdpdGggQUknLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxTZXJ2aWNlLmNoYXRXaXRoQUkoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRoaXMubG9hZERhdGEoKTtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IE9iamVjdC5hc3NpZ24oe30sIERFRkFVTFRfU0VUVElOR1MsIGRhdGEpO1xuICAgIH1cblxuICAgIGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcbiAgICAgICAgYXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgLy8gVXBkYXRlIGFsbCBzZXJ2aWNlcyB3aXRoIG5ldyBzZXR0aW5nc1xuICAgICAgICB0aGlzLm9wZW5BSVNlcnZpY2UudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMuam91cm5hbFNlcnZpY2UudXBkYXRlU2V0dGluZ3ModGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMucHJvbXB0U2VydmljZS51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJVbmxvYWRpbmcgSm91cm5hbGluZyBBc3Npc3RhbnQgUGx1Z2luLi4uXCIpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgSm91cm5hbGluZ0Fzc2lzdGFudFBsdWdpbjtcbiIsICJleHBvcnQgaW50ZXJmYWNlIEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB7XG4gICAgam91cm5hbEZvbGRlcjogc3RyaW5nO1xuICAgIGlucHV0c0ZvbGRlcjogc3RyaW5nO1xuICAgIG9wZW5BSUFwaUtleTogc3RyaW5nO1xuICAgIG51bWJlck9mUGFzdEVudHJpZXM6IG51bWJlcjtcbiAgICB1c2VTdHJlYW1pbmdSZXNwb25zZTogYm9vbGVhbjtcbiAgICB1c2VDdXN0b21Qcm9tcHRzOiBib29sZWFuO1xuICAgIGxhbmd1YWdlOiAnZW4nIHwgJ3BsJztcbiAgICBjdXN0b21Qcm9tcHRQYXRoczoge1xuICAgICAgICBqb3VybmFsOiBzdHJpbmc7XG4gICAgICAgIGNoYXQ6IHN0cmluZztcbiAgICAgICAgc3VtbWFyeTogc3RyaW5nO1xuICAgIH07XG59XG5cbmV4cG9ydCBjb25zdCBERUZBVUxUX1NFVFRJTkdTOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MgPSB7XG4gICAgam91cm5hbEZvbGRlcjogJ0pvdXJuYWwnLFxuICAgIGlucHV0c0ZvbGRlcjogJ0lucHV0cycsXG4gICAgb3BlbkFJQXBpS2V5OiAnJyxcbiAgICBudW1iZXJPZlBhc3RFbnRyaWVzOiAzLFxuICAgIHVzZVN0cmVhbWluZ1Jlc3BvbnNlOiB0cnVlLFxuICAgIHVzZUN1c3RvbVByb21wdHM6IGZhbHNlLFxuICAgIGxhbmd1YWdlOiAnZW4nLFxuICAgIGN1c3RvbVByb21wdFBhdGhzOiB7XG4gICAgICAgIGpvdXJuYWw6ICcnLFxuICAgICAgICBjaGF0OiAnJyxcbiAgICAgICAgc3VtbWFyeTogJydcbiAgICB9XG59OyAiLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MgfSBmcm9tICcuLi8uLi90eXBlcyc7XG5pbXBvcnQgeyBJSm91cm5hbFNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IE9wZW5BSVNlcnZpY2UgfSBmcm9tICcuLi9haS9zZXJ2aWNlcy9PcGVuQUlTZXJ2aWNlJztcbmltcG9ydCB7IFdoaXNwZXJTZXJ2aWNlIH0gZnJvbSAnLi4vYWkvc2VydmljZXMvV2hpc3BlclNlcnZpY2UnO1xuaW1wb3J0IHsgVHJhbnNjcmlwdGlvblNlcnZpY2UgfSBmcm9tICcuLi90cmFuc2NyaXB0aW9uL1RyYW5zY3JpcHRpb25TZXJ2aWNlJztcbmltcG9ydCB7IFN1bW1hcml6YXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc3VtbWFyeS9TdW1tYXJpemF0aW9uU2VydmljZSc7XG5pbXBvcnQgeyBDaGF0U2VydmljZSB9IGZyb20gJy4uL2FpL3NlcnZpY2VzL0NoYXRTZXJ2aWNlJztcbmltcG9ydCB7IEpvdXJuYWxNYW5hZ2VyIH0gZnJvbSAnLi9Kb3VybmFsTWFuYWdlcic7XG5pbXBvcnQgeyBQcm9tcHRTZXJ2aWNlIH0gZnJvbSAnLi4vYWkvc2VydmljZXMvUHJvbXB0U2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBKb3VybmFsU2VydmljZSBpbXBsZW1lbnRzIElKb3VybmFsU2VydmljZSB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgSk9VUk5BTF9SRVNQT05TRV9QQVRURVJOID0gLyMjIFlvdXIgSm91cm5hbCBSZXNwb25zZVxccyooW1xcc1xcU10qJCkvO1xuICAgIHByaXZhdGUgam91cm5hbE1hbmFnZXI6IEpvdXJuYWxNYW5hZ2VyO1xuICAgIHByaXZhdGUgd2hpc3BlclNlcnZpY2U6IFdoaXNwZXJTZXJ2aWNlO1xuICAgIHByaXZhdGUgc3VtbWFyaXphdGlvblNlcnZpY2U6IFN1bW1hcml6YXRpb25TZXJ2aWNlO1xuICAgIHByaXZhdGUgY2hhdFNlcnZpY2U6IENoYXRTZXJ2aWNlO1xuICAgIHByaXZhdGUgdHJhbnNjcmlwdGlvblNlcnZpY2U6IFRyYW5zY3JpcHRpb25TZXJ2aWNlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYXBwOiBBcHAsXG4gICAgICAgIHByaXZhdGUgc2V0dGluZ3M6IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyxcbiAgICAgICAgcHJpdmF0ZSBvcGVuQUlTZXJ2aWNlOiBPcGVuQUlTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHByb21wdFNlcnZpY2U6IFByb21wdFNlcnZpY2VcbiAgICApIHtcbiAgICAgICAgdGhpcy5qb3VybmFsTWFuYWdlciA9IG5ldyBKb3VybmFsTWFuYWdlcih0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XG4gICAgICAgIHRoaXMud2hpc3BlclNlcnZpY2UgPSBuZXcgV2hpc3BlclNlcnZpY2UodGhpcy5hcHAudmF1bHQsIHRoaXMuc2V0dGluZ3Mub3BlbkFJQXBpS2V5KTtcbiAgICAgICAgdGhpcy5zdW1tYXJpemF0aW9uU2VydmljZSA9IG5ldyBTdW1tYXJpemF0aW9uU2VydmljZSh0aGlzLm9wZW5BSVNlcnZpY2UsIHRoaXMucHJvbXB0U2VydmljZSk7XG4gICAgICAgIHRoaXMuY2hhdFNlcnZpY2UgPSBuZXcgQ2hhdFNlcnZpY2UodGhpcy5vcGVuQUlTZXJ2aWNlLCB0aGlzLnByb21wdFNlcnZpY2UpO1xuICAgICAgICB0aGlzLnRyYW5zY3JpcHRpb25TZXJ2aWNlID0gbmV3IFRyYW5zY3JpcHRpb25TZXJ2aWNlKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgdGhpcy53aGlzcGVyU2VydmljZS5zZXRBcGlLZXkoc2V0dGluZ3Mub3BlbkFJQXBpS2V5KTtcbiAgICAgICAgdGhpcy50cmFuc2NyaXB0aW9uU2VydmljZS51cGRhdGVTZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgICAgIHRoaXMub3BlbkFJU2VydmljZS51cGRhdGVTZXR0aW5ncyhzZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgYXN5bmMgb3BlblRvZGF5c0pvdXJuYWwoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxNYW5hZ2VyLmVuc3VyZUZvbGRlcih0aGlzLnNldHRpbmdzLmpvdXJuYWxGb2xkZXIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGAke3RoaXMuc2V0dGluZ3Muam91cm5hbEZvbGRlcn0vJHt0aGlzLmpvdXJuYWxNYW5hZ2VyLmdldFRvZGF5RmlsZU5hbWUoKX1gO1xuICAgICAgICAgICAgbGV0IGZpbGUgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgpO1xuXG4gICAgICAgICAgICBpZiAoIWZpbGUpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBsb2FkaW5nTm90aWNlID0gbmV3IE5vdGljZSgnR2VuZXJhdGluZyBqb3VybmFsIHByb21wdC4uLicsIDApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBuZXcgam91cm5hbCBlbnRyeVxuICAgICAgICAgICAgICAgICAgICBmaWxlID0gYXdhaXQgdGhpcy5qb3VybmFsTWFuYWdlci5jcmVhdGVOZXdKb3VybmFsRW50cnkoKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEdldCBwYXN0IGVudHJpZXMgZm9yIGNvbnRleHRcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcGFzdEVudHJpZXMgPSBhd2FpdCB0aGlzLmpvdXJuYWxNYW5hZ2VyLmdldFBhc3RKb3VybmFsRW50cmllcyh0aGlzLnNldHRpbmdzLm51bWJlck9mUGFzdEVudHJpZXMpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gT3BlbiB0aGUgZmlsZVxuICAgICAgICAgICAgICAgICAgICBjb25zdCBsZWFmID0gdGhpcy5hcHAud29ya3NwYWNlLmdldExlYWYoZmFsc2UpO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUgYXMgVEZpbGUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmICh2aWV3KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VTdHJlYW1pbmdSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFN0cmVhbSB0aGUgQUkgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLm9wZW5BSVNlcnZpY2UubWFrZU9wZW5BSVJlcXVlc3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlSm91cm5hbFByb21wdChwYXN0RW50cmllcyksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChjaHVuaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudENvbnRlbnQgPSB2aWV3LmVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5lZGl0b3Iuc2V0VmFsdWUoY3VycmVudENvbnRlbnQgKyBjaHVuayk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBHZXQgY29tcGxldGUgcmVzcG9uc2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBhaVByb21wdCA9IGF3YWl0IHRoaXMub3BlbkFJU2VydmljZS5tYWtlT3BlbkFJUmVxdWVzdChcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVKb3VybmFsUHJvbXB0KHBhc3RFbnRyaWVzKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5lZGl0b3Iuc2V0VmFsdWUodmlldy5lZGl0b3IuZ2V0VmFsdWUoKSArIGFpUHJvbXB0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQWRkIHJlc3BvbnNlIHNlY3Rpb25cbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFZhbHVlKHZpZXcuZWRpdG9yLmdldFZhbHVlKCkgKyAnXFxuXFxuIyMgWW91ciBKb3VybmFsIFJlc3BvbnNlXFxuXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGxvYWRpbmdOb3RpY2UuaGlkZSgpO1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdDcmVhdGVkIG5ldyBqb3VybmFsIGVudHJ5IGZvciB0b2RheScpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0Vycm9yIGdlbmVyYXRpbmcgcHJvbXB0OiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICAgICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmlldy5lZGl0b3Iuc2V0VmFsdWUodmlldy5lZGl0b3IuZ2V0VmFsdWUoKSArICdcXG5cXG4jIyBZb3VyIEpvdXJuYWwgUmVzcG9uc2VcXG5cXG4nKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgICAgICBhd2FpdCBsZWFmLm9wZW5GaWxlKGZpbGUgYXMgVEZpbGUpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBvcGVuaW5nIHRvZGF5XFwncyBqb3VybmFsOiAnICsgZXJyb3IubWVzc2FnZSk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBvcGVuaW5nIHRvZGF5XFwncyBqb3VybmFsOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlSm91cm5hbFByb21wdChwYXN0RW50cmllczogc3RyaW5nW10pOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBqb3VybmFsUHJvbXB0ID0gYXdhaXQgdGhpcy5wcm9tcHRTZXJ2aWNlLmdldFByb21wdCgnam91cm5hbCcpO1xuICAgICAgICBjb25zdCBwYXN0RW50cmllc1RleHQgPSBwYXN0RW50cmllcy5sZW5ndGggPiAwIFxuICAgICAgICAgICAgPyBgUGFzdCBFbnRyaWVzOlxcblxcbiR7cGFzdEVudHJpZXMuam9pbignXFxuXFxuLS0tXFxuXFxuJyl9YFxuICAgICAgICAgICAgOiAnTm8gcGFzdCBlbnRyaWVzIGF2YWlsYWJsZS4nO1xuXG4gICAgICAgIHJldHVybiBgJHtqb3VybmFsUHJvbXB0fVxcblxcbiR7cGFzdEVudHJpZXNUZXh0fWA7XG4gICAgfVxuXG4gICAgYXN5bmMgc3VtbWFyaXplSm91cm5hbGluZ1Nlc3Npb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcgfHwgIWFjdGl2ZVZpZXcuZmlsZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIG9wZW4gYSBub3RlIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gU2F2ZSBvcmlnaW5hbCBjb250ZW50XG4gICAgICAgICAgICBjb25zdCBvcmlnaW5hbENvbnRlbnQgPSBhY3RpdmVWaWV3LmVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSBhY3RpdmVWaWV3LmZpbGUubmFtZTtcbiAgICAgICAgICAgIGNvbnN0IGlucHV0UGF0aCA9IGAke3RoaXMuc2V0dGluZ3MuaW5wdXRzRm9sZGVyfS8ke2ZpbGVOYW1lfWA7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuam91cm5hbE1hbmFnZXIuZW5zdXJlRm9sZGVyKHRoaXMuc2V0dGluZ3MuaW5wdXRzRm9sZGVyKTtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShpbnB1dFBhdGgsIG9yaWdpbmFsQ29udGVudCk7XG5cbiAgICAgICAgICAgIC8vIFByb2Nlc3MgY29udGVudCAodHJhbnNjcmliZSByZWNvcmRpbmdzIGlmIGFueSlcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UudHJhbnNjcmliZVJlY29yZGluZ3MoKTtcbiAgICAgICAgICAgIGNvbnN0IHByb2Nlc3NlZENvbnRlbnQgPSBhY3RpdmVWaWV3LmVkaXRvci5nZXRWYWx1ZSgpO1xuXG4gICAgICAgICAgICAvLyBFeHRyYWN0IHVzZXIncyByZXNwb25zZSBzZWN0aW9uIC0gaW1wcm92ZWQgcmVnZXggcGF0dGVyblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2VNYXRjaCA9IHByb2Nlc3NlZENvbnRlbnQubWF0Y2goSm91cm5hbFNlcnZpY2UuSk9VUk5BTF9SRVNQT05TRV9QQVRURVJOKTtcbiAgICAgICAgICAgIGlmICghcmVzcG9uc2VNYXRjaCkge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0NvdWxkIG5vdCBmaW5kIGpvdXJuYWwgcmVzcG9uc2Ugc2VjdGlvbicpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgdXNlclJlc3BvbnNlID0gcmVzcG9uc2VNYXRjaFsxXS50cmltKCk7XG4gICAgICAgICAgICBsZXQgc3VtbWFyeTogc3RyaW5nO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VTdHJlYW1pbmdSZXNwb25zZSkge1xuICAgICAgICAgICAgICAgIGxldCBzdHJlYW1lZFN1bW1hcnkgPSAnJztcbiAgICAgICAgICAgICAgICBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5zdW1tYXJpemF0aW9uU2VydmljZS5zdW1tYXJpemUoXG4gICAgICAgICAgICAgICAgICAgIHVzZXJSZXNwb25zZSxcbiAgICAgICAgICAgICAgICAgICAgdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgKGNodW5rKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBzdHJlYW1lZFN1bW1hcnkgKz0gY2h1bms7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IHByb2Nlc3NlZENvbnRlbnQucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBKb3VybmFsU2VydmljZS5KT1VSTkFMX1JFU1BPTlNFX1BBVFRFUk4sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYCMjIFlvdXIgSm91cm5hbCBSZXNwb25zZVxcblxcbiR7c3RyZWFtZWRTdW1tYXJ5fWBcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBhY3RpdmVWaWV3LmVkaXRvci5zZXRWYWx1ZSh1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdW1tYXJ5ID0gYXdhaXQgdGhpcy5zdW1tYXJpemF0aW9uU2VydmljZS5zdW1tYXJpemUodXNlclJlc3BvbnNlKTtcbiAgICAgICAgICAgICAgICBjb25zdCB1cGRhdGVkQ29udGVudCA9IHByb2Nlc3NlZENvbnRlbnQucmVwbGFjZShcbiAgICAgICAgICAgICAgICAgICAgSm91cm5hbFNlcnZpY2UuSk9VUk5BTF9SRVNQT05TRV9QQVRURVJOLFxuICAgICAgICAgICAgICAgICAgICBgIyMgWW91ciBKb3VybmFsIFJlc3BvbnNlXFxuXFxuJHtzdW1tYXJ5fWBcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIGFjdGl2ZVZpZXcuZWRpdG9yLnNldFZhbHVlKHVwZGF0ZWRDb250ZW50KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgbmV3IE5vdGljZSgnSm91cm5hbCBzZXNzaW9uIHN1bW1hcml6ZWQnKTtcblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1N1bW1hcml6YXRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY2hhdFdpdGhBSSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICghYWN0aXZlVmlldykge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIG9wZW4gYSBub3RlIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gVHJhbnNjcmliZSBhbnkgYXVkaW8gcmVjb3JkaW5nc1xuICAgICAgICAgICAgYXdhaXQgdGhpcy50cmFuc2NyaXB0aW9uU2VydmljZS50cmFuc2NyaWJlUmVjb3JkaW5ncygpO1xuXG4gICAgICAgICAgICAvLyBHZXQgdXBkYXRlZCBjb250ZW50IGFuZCBjaGF0XG4gICAgICAgICAgICBjb25zdCBjb250ZW50ID0gYWN0aXZlVmlldy5lZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGNoYXRSZXNwb25zZSA9IGF3YWl0IHRoaXMuY2hhdFNlcnZpY2UuY2hhdChjb250ZW50KTtcblxuICAgICAgICAgICAgLy8gQXBwZW5kIEFJJ3MgcmVzcG9uc2VcbiAgICAgICAgICAgIGFjdGl2ZVZpZXcuZWRpdG9yLnNldFZhbHVlKFxuICAgICAgICAgICAgICAgIGNvbnRlbnQgKyAnXFxuXFxuLS0tXFxuIyMgQUkgQ2hhdFxcblxcbicgKyBjaGF0UmVzcG9uc2UgKyAnXFxuXFxuLS0tXFxuIyMgTWVcXG4nXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBuZXcgTm90aWNlKCdBSSByZXNwb25kZWQgaW4gbm90ZScpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKGBFcnJvciBkdXJpbmcgY2hhdDogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICB9XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgVEZpbGUsIFZhdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY2xhc3MgQXVkaW9Qcm9jZXNzaW5nU2VydmljZSB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSB2YXVsdDogVmF1bHQpIHt9XG5cbiAgICBhc3luYyBjb252ZXJ0TTRBdG9XQVYoZmlsZTogVEZpbGUpOiBQcm9taXNlPHsgYnVmZmVyOiBBcnJheUJ1ZmZlcjsgbWltZVR5cGU6IHN0cmluZyB9PiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IHRoaXMudmF1bHQucmVhZEJpbmFyeShmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvQ29udGV4dCA9IG5ldyAod2luZG93LkF1ZGlvQ29udGV4dCB8fCAod2luZG93IGFzIGFueSkud2Via2l0QXVkaW9Db250ZXh0KSgpO1xuICAgICAgICAgICAgY29uc3QgYXVkaW9CdWZmZXIgPSBhd2FpdCBhdWRpb0NvbnRleHQuZGVjb2RlQXVkaW9EYXRhKGFycmF5QnVmZmVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3Qgb2ZmbGluZUNvbnRleHQgPSBuZXcgT2ZmbGluZUF1ZGlvQ29udGV4dChcbiAgICAgICAgICAgICAgICBhdWRpb0J1ZmZlci5udW1iZXJPZkNoYW5uZWxzLFxuICAgICAgICAgICAgICAgIGF1ZGlvQnVmZmVyLmxlbmd0aCxcbiAgICAgICAgICAgICAgICBhdWRpb0J1ZmZlci5zYW1wbGVSYXRlXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBjb25zdCBzb3VyY2UgPSBvZmZsaW5lQ29udGV4dC5jcmVhdGVCdWZmZXJTb3VyY2UoKTtcbiAgICAgICAgICAgIHNvdXJjZS5idWZmZXIgPSBhdWRpb0J1ZmZlcjtcbiAgICAgICAgICAgIHNvdXJjZS5jb25uZWN0KG9mZmxpbmVDb250ZXh0LmRlc3RpbmF0aW9uKTtcbiAgICAgICAgICAgIHNvdXJjZS5zdGFydCgwKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgcmVuZGVyZWRCdWZmZXIgPSBhd2FpdCBvZmZsaW5lQ29udGV4dC5zdGFydFJlbmRlcmluZygpO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBidWZmZXI6IHRoaXMuY3JlYXRlV0FWRmlsZShyZW5kZXJlZEJ1ZmZlciksXG4gICAgICAgICAgICAgICAgbWltZVR5cGU6ICdhdWRpby93YXYnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3IgY29udmVydGluZyBNNEEgdG8gV0FWOicsIGVycm9yKTtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGNvbnZlcnQgTTRBIHRvIFdBViBmb3JtYXQnKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlV0FWRmlsZShhdWRpb0J1ZmZlcjogQXVkaW9CdWZmZXIpOiBBcnJheUJ1ZmZlciB7XG4gICAgICAgIGNvbnN0IGxlbmd0aCA9IGF1ZGlvQnVmZmVyLmxlbmd0aCAqIDI7XG4gICAgICAgIGNvbnN0IG91dHB1dEJ1ZmZlciA9IG5ldyBBcnJheUJ1ZmZlcig0NCArIGxlbmd0aCk7XG4gICAgICAgIGNvbnN0IHZpZXcgPSBuZXcgRGF0YVZpZXcob3V0cHV0QnVmZmVyKTtcbiAgICAgICAgXG4gICAgICAgIHRoaXMud3JpdGVXQVZIZWFkZXIodmlldywgbGVuZ3RoLCBhdWRpb0J1ZmZlcik7XG4gICAgICAgIFxuICAgICAgICBjb25zdCBkYXRhID0gbmV3IEZsb2F0MzJBcnJheShhdWRpb0J1ZmZlci5nZXRDaGFubmVsRGF0YSgwKSk7XG4gICAgICAgIGxldCBvZmZzZXQgPSA0NDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCBzYW1wbGUgPSBNYXRoLm1heCgtMSwgTWF0aC5taW4oMSwgZGF0YVtpXSkpO1xuICAgICAgICAgICAgdmlldy5zZXRJbnQxNihvZmZzZXQsIHNhbXBsZSA8IDAgPyBzYW1wbGUgKiAweDgwMDAgOiBzYW1wbGUgKiAweDdGRkYsIHRydWUpO1xuICAgICAgICAgICAgb2Zmc2V0ICs9IDI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBvdXRwdXRCdWZmZXI7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB3cml0ZVdBVkhlYWRlcih2aWV3OiBEYXRhVmlldywgbGVuZ3RoOiBudW1iZXIsIGF1ZGlvQnVmZmVyOiBBdWRpb0J1ZmZlcik6IHZvaWQge1xuICAgICAgICBjb25zdCB3cml0ZVN0cmluZyA9IChvZmZzZXQ6IG51bWJlciwgc3RyaW5nOiBzdHJpbmcpID0+IHtcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyaW5nLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgdmlldy5zZXRVaW50OChvZmZzZXQgKyBpLCBzdHJpbmcuY2hhckNvZGVBdChpKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgd3JpdGVTdHJpbmcoMCwgJ1JJRkYnKTtcbiAgICAgICAgdmlldy5zZXRVaW50MzIoNCwgMzYgKyBsZW5ndGgsIHRydWUpO1xuICAgICAgICB3cml0ZVN0cmluZyg4LCAnV0FWRScpO1xuICAgICAgICB3cml0ZVN0cmluZygxMiwgJ2ZtdCAnKTtcbiAgICAgICAgdmlldy5zZXRVaW50MzIoMTYsIDE2LCB0cnVlKTtcbiAgICAgICAgdmlldy5zZXRVaW50MTYoMjAsIDEsIHRydWUpO1xuICAgICAgICB2aWV3LnNldFVpbnQxNigyMiwgYXVkaW9CdWZmZXIubnVtYmVyT2ZDaGFubmVscywgdHJ1ZSk7XG4gICAgICAgIHZpZXcuc2V0VWludDMyKDI0LCBhdWRpb0J1ZmZlci5zYW1wbGVSYXRlLCB0cnVlKTtcbiAgICAgICAgdmlldy5zZXRVaW50MzIoMjgsIGF1ZGlvQnVmZmVyLnNhbXBsZVJhdGUgKiAyLCB0cnVlKTtcbiAgICAgICAgdmlldy5zZXRVaW50MTYoMzIsIDIsIHRydWUpO1xuICAgICAgICB2aWV3LnNldFVpbnQxNigzNCwgMTYsIHRydWUpO1xuICAgICAgICB3cml0ZVN0cmluZygzNiwgJ2RhdGEnKTtcbiAgICAgICAgdmlldy5zZXRVaW50MzIoNDAsIGxlbmd0aCwgdHJ1ZSk7XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgVEZpbGUsIFZhdWx0IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgSVdoaXNwZXJTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBBdWRpb1Byb2Nlc3NpbmdTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vdHJhbnNjcmlwdGlvbi9BdWRpb1Byb2Nlc3NpbmdTZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIFdoaXNwZXJTZXJ2aWNlIGltcGxlbWVudHMgSVdoaXNwZXJTZXJ2aWNlIHtcbiAgICBwcml2YXRlIHN0YXRpYyByZWFkb25seSBTVVBQT1JURURfRk9STUFUUyA9IFsnZmxhYycsICdtcDMnLCAnbXA0JywgJ21wZWcnLCAnbXBnYScsICdtNGEnLCAnb2dnJywgJ3dhdicsICd3ZWJtJ107XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgTUlNRV9UWVBFUzogeyBba2V5OiBzdHJpbmddOiBzdHJpbmcgfSA9IHtcbiAgICAgICAgJ2ZsYWMnOiAnYXVkaW8vZmxhYycsXG4gICAgICAgICdtcDMnOiAnYXVkaW8vbXBlZycsXG4gICAgICAgICdtcDQnOiAnYXVkaW8vbXA0JyxcbiAgICAgICAgJ21wZWcnOiAnYXVkaW8vbXBlZycsXG4gICAgICAgICdtcGdhJzogJ2F1ZGlvL21wZWcnLFxuICAgICAgICAnbTRhJzogJ2F1ZGlvL21wNCcsXG4gICAgICAgICdvZ2cnOiAnYXVkaW8vb2dnJyxcbiAgICAgICAgJ3dhdic6ICdhdWRpby93YXYnLFxuICAgICAgICAnd2VibSc6ICdhdWRpby93ZWJtJ1xuICAgIH07XG5cbiAgICBwcml2YXRlIGF1ZGlvUHJvY2Vzc29yOiBBdWRpb1Byb2Nlc3NpbmdTZXJ2aWNlO1xuXG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgdmF1bHQ6IFZhdWx0LFxuICAgICAgICBwcml2YXRlIGFwaUtleTogc3RyaW5nXG4gICAgKSB7XG4gICAgICAgIHRoaXMuYXVkaW9Qcm9jZXNzb3IgPSBuZXcgQXVkaW9Qcm9jZXNzaW5nU2VydmljZSh2YXVsdCk7XG4gICAgfVxuXG4gICAgc2V0QXBpS2V5KGFwaUtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgICAgIHRoaXMuYXBpS2V5ID0gYXBpS2V5O1xuICAgIH1cblxuICAgIHByaXZhdGUgc3RhdGljIGlzU3VwcG9ydGVkRm9ybWF0KGZpbGU6IFRGaWxlKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiBXaGlzcGVyU2VydmljZS5TVVBQT1JURURfRk9STUFUUy5pbmNsdWRlcyhleHRlbnNpb24pO1xuICAgIH1cblxuICAgIHByaXZhdGUgYXN5bmMgcHJlcGFyZUF1ZGlvRm9yVHJhbnNjcmlwdGlvbihmaWxlOiBURmlsZSk6IFByb21pc2U8eyBibG9iOiBCbG9iOyBtaW1lVHlwZTogc3RyaW5nIH0+IHtcbiAgICAgICAgaWYgKGZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCkgPT09ICdtNGEnKSB7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnQ29udmVydGluZyBNNEEgdG8gV0FWIGZvcm1hdC4uLicpO1xuICAgICAgICAgICAgY29uc3QgeyBidWZmZXIsIG1pbWVUeXBlIH0gPSBhd2FpdCB0aGlzLmF1ZGlvUHJvY2Vzc29yLmNvbnZlcnRNNEF0b1dBVihmaWxlKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYmxvYjogbmV3IEJsb2IoW2J1ZmZlcl0sIHsgdHlwZTogbWltZVR5cGUgfSksXG4gICAgICAgICAgICAgICAgbWltZVR5cGVcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnN0IGFycmF5QnVmZmVyID0gYXdhaXQgdGhpcy52YXVsdC5yZWFkQmluYXJ5KGZpbGUpO1xuICAgICAgICBjb25zdCBtaW1lVHlwZSA9IFdoaXNwZXJTZXJ2aWNlLk1JTUVfVFlQRVNbZmlsZS5leHRlbnNpb24udG9Mb3dlckNhc2UoKV07XG4gICAgICAgIFxuICAgICAgICBpZiAoIW1pbWVUeXBlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIE1JTUUgdHlwZSBmb3IgZXh0ZW5zaW9uOiAke2ZpbGUuZXh0ZW5zaW9ufWApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgYmxvYjogbmV3IEJsb2IoW2FycmF5QnVmZmVyXSwgeyB0eXBlOiBtaW1lVHlwZSB9KSxcbiAgICAgICAgICAgIG1pbWVUeXBlXG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYXN5bmMgdHJhbnNjcmliZUZpbGUoYXVkaW9GaWxlOiBURmlsZSk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBpZiAoIXRoaXMuYXBpS2V5KSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBpcyByZXF1aXJlZCBmb3IgdHJhbnNjcmlwdGlvbicpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIVdoaXNwZXJTZXJ2aWNlLmlzU3VwcG9ydGVkRm9ybWF0KGF1ZGlvRmlsZSkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVuc3VwcG9ydGVkIGF1ZGlvIGZvcm1hdDogJHthdWRpb0ZpbGUuZXh0ZW5zaW9ufWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCB7IGJsb2IsIG1pbWVUeXBlIH0gPSBhd2FpdCB0aGlzLnByZXBhcmVBdWRpb0ZvclRyYW5zY3JpcHRpb24oYXVkaW9GaWxlKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzaW5nIGZpbGU6ICR7YXVkaW9GaWxlLm5hbWV9IHdpdGggTUlNRSB0eXBlOiAke21pbWVUeXBlfWApO1xuXG4gICAgICAgICAgICBjb25zdCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpO1xuICAgICAgICAgICAgY29uc3QgZXh0ZW5zaW9uID0gYXVkaW9GaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpID09PSAnbTRhJyA/ICd3YXYnIDogYXVkaW9GaWxlLmV4dGVuc2lvbjtcbiAgICAgICAgICAgIGZvcm1EYXRhLmFwcGVuZCgnZmlsZScsIGJsb2IsIGAke2F1ZGlvRmlsZS5iYXNlbmFtZX0uJHtleHRlbnNpb259YCk7XG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ21vZGVsJywgJ3doaXNwZXItMScpO1xuXG4gICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCdodHRwczovL2FwaS5vcGVuYWkuY29tL3YxL2F1ZGlvL3RyYW5zY3JpcHRpb25zJywge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5hcGlLZXl9YFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgYm9keTogZm9ybURhdGFcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZXJyb3JEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ09wZW5BSSBBUEkgRXJyb3I6Jywge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzVGV4dDogcmVzcG9uc2Uuc3RhdHVzVGV4dCxcbiAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGVycm9yRGF0YVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvckRhdGEuZXJyb3I/Lm1lc3NhZ2UgfHwgYFRyYW5zY3JpcHRpb24gZmFpbGVkIHdpdGggc3RhdHVzICR7cmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0LnRleHQ7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdEZXRhaWxlZCB0cmFuc2NyaXB0aW9uIGVycm9yOicsIHtcbiAgICAgICAgICAgICAgICBmaWxlTmFtZTogYXVkaW9GaWxlLm5hbWUsXG4gICAgICAgICAgICAgICAgZXh0ZW5zaW9uOiBhdWRpb0ZpbGUuZXh0ZW5zaW9uLFxuICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8ge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxuICAgICAgICAgICAgICAgICAgICBzdGFjazogZXJyb3Iuc3RhY2tcbiAgICAgICAgICAgICAgICB9IDogZXJyb3JcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG59ICIsICJpbXBvcnQgeyBOb3RpY2UsIE1hcmtkb3duVmlldywgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBXaGlzcGVyU2VydmljZSB9IGZyb20gJy4uL2FpL3NlcnZpY2VzL1doaXNwZXJTZXJ2aWNlJztcbmltcG9ydCB7IElUcmFuc2NyaXB0aW9uU2VydmljZSB9IGZyb20gJy4uLy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzIH0gZnJvbSAnLi4vLi4vdHlwZXMnO1xuaW1wb3J0IHsgZ2V0UmVjb3JkaW5nRW1iZWRQYXR0ZXJuLCBpc1N1cHBvcnRlZEF1ZGlvRm9ybWF0IH0gZnJvbSAnLi4vLi4vdXRpbHMvaGVscGVycyc7XG5pbXBvcnQgdHlwZSB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIFRyYW5zY3JpcHRpb25TZXJ2aWNlIGltcGxlbWVudHMgSVRyYW5zY3JpcHRpb25TZXJ2aWNlIHtcbiAgICBwcml2YXRlIHdoaXNwZXJTZXJ2aWNlOiBXaGlzcGVyU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3NcbiAgICApIHtcbiAgICAgICAgdGhpcy53aGlzcGVyU2VydmljZSA9IG5ldyBXaGlzcGVyU2VydmljZSh0aGlzLmFwcC52YXVsdCwgdGhpcy5zZXR0aW5ncy5vcGVuQUlBcGlLZXkpO1xuICAgIH1cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgICAgICB0aGlzLndoaXNwZXJTZXJ2aWNlLnNldEFwaUtleShzZXR0aW5ncy5vcGVuQUlBcGlLZXkpO1xuICAgIH1cblxuICAgIGFzeW5jIHRyYW5zY3JpYmVSZWNvcmRpbmdzKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCFhY3RpdmVWaWV3KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdQbGVhc2Ugb3BlbiBhIG5vdGUgZmlyc3QnKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICghdGhpcy5zZXR0aW5ncy5vcGVuQUlBcGlLZXkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcbiAgICAgICAgY29uc3QgY29udGVudCA9IGVkaXRvci5nZXRWYWx1ZSgpO1xuICAgICAgICBjb25zdCByZWNvcmRpbmdQYXR0ZXJuID0gZ2V0UmVjb3JkaW5nRW1iZWRQYXR0ZXJuKCk7XG4gICAgICAgIGNvbnN0IHJlY29yZGluZ3MgPSBjb250ZW50Lm1hdGNoKHJlY29yZGluZ1BhdHRlcm4pO1xuXG4gICAgICAgIGlmICghcmVjb3JkaW5ncyB8fCByZWNvcmRpbmdzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnTm8gcmVjb3JkaW5ncyBmb3VuZCBpbiB0aGUgY3VycmVudCBub3RlJyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBuZXcgTm90aWNlKCdTdGFydGluZyB0cmFuc2NyaXB0aW9uLi4uJyk7XG5cbiAgICAgICAgbGV0IHVwZGF0ZWRDb250ZW50ID0gY29udGVudDtcbiAgICAgICAgbGV0IGhhc0Vycm9ycyA9IGZhbHNlO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKGNvbnN0IHJlY29yZGluZyBvZiByZWNvcmRpbmdzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZU5hbWUgPSByZWNvcmRpbmcuc2xpY2UoMywgLTIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpcnN0TGlua3BhdGhEZXN0KGZpbGVOYW1lLCBcIlwiKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAoIShmaWxlIGluc3RhbmNlb2YgVEZpbGUpKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoYENvdWxkIG5vdCBmaW5kIGZpbGU6ICR7ZmlsZU5hbWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIGhhc0Vycm9ycyA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHRyYW5zY3JpcHQgPSBhd2FpdCB0aGlzLndoaXNwZXJTZXJ2aWNlLnRyYW5zY3JpYmVGaWxlKGZpbGUpO1xuICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQ29udGVudCA9IHVwZGF0ZWRDb250ZW50LnJlcGxhY2UocmVjb3JkaW5nLCB0cmFuc2NyaXB0KTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBGYWlsZWQgdG8gdHJhbnNjcmliZSAke2ZpbGVOYW1lfTogJHtlcnJvci5tZXNzYWdlfWApO1xuICAgICAgICAgICAgICAgICAgICBoYXNFcnJvcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGVkaXRvci5zZXRWYWx1ZSh1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmIChoYXNFcnJvcnMpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdUcmFuc2NyaXB0aW9uIGNvbXBsZXRlZCB3aXRoIHNvbWUgZXJyb3JzJyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1RyYW5zY3JpcHRpb24gY29tcGxldGVkIHN1Y2Nlc3NmdWxseScpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgVHJhbnNjcmlwdGlvbiBmYWlsZWQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ1RyYW5zY3JpcHRpb24gZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICB9XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgVEZpbGUgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjb25zdCBpc1N1cHBvcnRlZEF1ZGlvRm9ybWF0ID0gKGZpbGU6IFRGaWxlKTogYm9vbGVhbiA9PiB7XG4gICAgY29uc3Qgc3VwcG9ydGVkRm9ybWF0cyA9IFsnZmxhYycsICdtNGEnLCAnbXAzJywgJ21wNCcsICdtcGVnJywgJ21wZ2EnLCAnb2dhJywgJ29nZycsICd3YXYnLCAnd2VibSddO1xuICAgIGNvbnN0IGV4dGVuc2lvbiA9IGZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCk7XG4gICAgcmV0dXJuIHN1cHBvcnRlZEZvcm1hdHMuaW5jbHVkZXMoZXh0ZW5zaW9uKTtcbn07XG5cbmV4cG9ydCBjb25zdCBnZXRSZWNvcmRpbmdFbWJlZFBhdHRlcm4gPSAoKTogUmVnRXhwID0+IHtcbiAgICByZXR1cm4gLyFcXFtcXFsuK1xcLihmbGFjfG1wM3xtcDR8bXBlZ3xtcGdhfG00YXxvZ2d8d2F2fHdlYm0pXFxdXFxdL2c7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0VG9kYXlGaWxlTmFtZSA9ICgpOiBzdHJpbmcgPT4ge1xuICAgIGNvbnN0IGRhdGUgPSBuZXcgRGF0ZSgpO1xuICAgIHJldHVybiBkYXRlLnRvSVNPU3RyaW5nKCkuc3BsaXQoJ1QnKVswXSArICcubWQnOyAvLyBGb3JtYXQ6IFlZWVktTU0tREQubWRcbn07ICIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBPcGVuQUlTZXJ2aWNlIH0gZnJvbSAnLi4vYWkvc2VydmljZXMvT3BlbkFJU2VydmljZSc7XG5pbXBvcnQgeyBJU3VtbWFyaXphdGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IFByb21wdFNlcnZpY2UgfSBmcm9tICcuLi9haS9zZXJ2aWNlcy9Qcm9tcHRTZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIFN1bW1hcml6YXRpb25TZXJ2aWNlIGltcGxlbWVudHMgSVN1bW1hcml6YXRpb25TZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBvcGVuQUlTZXJ2aWNlOiBPcGVuQUlTZXJ2aWNlLFxuICAgICAgICBwcml2YXRlIHByb21wdFNlcnZpY2U6IFByb21wdFNlcnZpY2VcbiAgICApIHt9XG5cbiAgICBhc3luYyBzdW1tYXJpemUoXG4gICAgICAgIGNvbnRlbnQ6IHN0cmluZywgXG4gICAgICAgIHVzZVN0cmVhbWluZzogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBvbkNodW5rPzogKGNodW5rOiBzdHJpbmcpID0+IHZvaWRcbiAgICApOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc3VtbWFyeVByb21wdCA9IGF3YWl0IHRoaXMucHJvbXB0U2VydmljZS5nZXRQcm9tcHQoJ3N1bW1hcnknKTtcbiAgICAgICAgICAgIGNvbnN0IHByb21wdCA9IGAke3N1bW1hcnlQcm9tcHR9XFxuXFxuJHtjb250ZW50fWA7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5vcGVuQUlTZXJ2aWNlLm1ha2VPcGVuQUlSZXF1ZXN0KFxuICAgICAgICAgICAgICAgIHByb21wdCwgXG4gICAgICAgICAgICAgICAgdXNlU3RyZWFtaW5nID8gb25DaHVuayA6IHVuZGVmaW5lZFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3IgZHVyaW5nIHN1bW1hcml6YXRpb246ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBPcGVuQUlTZXJ2aWNlIH0gZnJvbSAnLi9PcGVuQUlTZXJ2aWNlJztcbmltcG9ydCB7IFByb21wdFNlcnZpY2UgfSBmcm9tICcuL1Byb21wdFNlcnZpY2UnO1xuXG5leHBvcnQgY2xhc3MgQ2hhdFNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIG9wZW5BSVNlcnZpY2U6IE9wZW5BSVNlcnZpY2UsXG4gICAgICAgIHByaXZhdGUgcHJvbXB0U2VydmljZTogUHJvbXB0U2VydmljZVxuICAgICkge31cblxuICAgIGFzeW5jIGNoYXQodHJhbnNjcmliZWRUZXh0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBjaGF0UHJvbXB0ID0gYXdhaXQgdGhpcy5wcm9tcHRTZXJ2aWNlLmdldFByb21wdCgnY2hhdCcpO1xuICAgICAgICBjb25zdCBwcm9tcHQgPSBgJHtjaGF0UHJvbXB0fVxcblxcblVzZXI6ICR7dHJhbnNjcmliZWRUZXh0fVxcblxcbkFzc2lzdGFudDpgO1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuQUlTZXJ2aWNlLm1ha2VPcGVuQUlSZXF1ZXN0KHByb21wdCk7XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCB7IGdldFRvZGF5RmlsZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9oZWxwZXJzJztcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzXG4gICAgKSB7fVxuXG4gICAgYXN5bmMgZW5zdXJlRm9sZGVyKGZvbGRlclBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIShhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhmb2xkZXJQYXRoKSkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFRvZGF5RmlsZU5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGdldFRvZGF5RmlsZU5hbWUoKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRQYXN0Sm91cm5hbEVudHJpZXMoY291bnQ6IG51bWJlcik6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3Muam91cm5hbEZvbGRlcik7XG4gICAgICAgIGlmICghZm9sZGVyKSByZXR1cm4gW107XG5cbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLmpvdXJuYWxGb2xkZXIgKyAnLycpKVxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc3RhdC5tdGltZSAtIGEuc3RhdC5tdGltZSlcbiAgICAgICAgICAgIC5zbGljZSgxLCBjb3VudCsxKTtcblxuICAgICAgICBjb25zdCBlbnRyaWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBmaWxlcy5tYXAoYXN5bmMgZmlsZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBlbnRyaWVzLm1hcChlbnRyeSA9PiBgRGF0ZTogJHtlbnRyeS5kYXRlfVxcbiR7ZW50cnkuY29udGVudH1gKTtcbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVOZXdKb3VybmFsRW50cnkoKTogUHJvbWlzZTxURmlsZT4ge1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHRoaXMuZ2V0VG9kYXlGaWxlTmFtZSgpO1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGAke3RoaXMuc2V0dGluZ3Muam91cm5hbEZvbGRlcn0vJHtmaWxlTmFtZX1gO1xuICAgICAgICBjb25zdCBpbml0aWFsQ29udGVudCA9IGAjIEpvdXJuYWwgRW50cnkgLSAke25ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9XFxuXFxuYDtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgaW5pdGlhbENvbnRlbnQpO1xuICAgIH1cbn0gIiwgImltcG9ydCB7IE5vdGljZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcbmltcG9ydCB7IElPcGVuQUlTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vLi4vaW50ZXJmYWNlcyc7XG5cbmV4cG9ydCBjbGFzcyBPcGVuQUlTZXJ2aWNlIGltcGxlbWVudHMgSU9wZW5BSVNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgc2V0dGluZ3M6IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncykge31cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNldHRpbmdzO1xuICAgIH1cblxuICAgIGFzeW5jIG1ha2VPcGVuQUlSZXF1ZXN0KHByb21wdDogc3RyaW5nLCBvbkNodW5rPzogKGNodW5rOiBzdHJpbmcpID0+IHZvaWQpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3Mub3BlbkFJQXBpS2V5KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ09wZW5BSSBBUEkga2V5IG5vdCBjb25maWd1cmVkJyk7XG4gICAgICAgIH1cblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9jaGF0L2NvbXBsZXRpb25zJywge1xuICAgICAgICAgICAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dGhpcy5zZXR0aW5ncy5vcGVuQUlBcGlLZXl9YCxcbiAgICAgICAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgICAgICAgICAgbW9kZWw6ICdncHQtNG8tbWluaScsXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2VzOiBbeyByb2xlOiAndXNlcicsIGNvbnRlbnQ6IHByb21wdCB9XSxcbiAgICAgICAgICAgICAgICAgICAgdGVtcGVyYXR1cmU6IDAuNyxcbiAgICAgICAgICAgICAgICAgICAgc3RyZWFtOiAhIW9uQ2h1bmssXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihlcnJvci5lcnJvcj8ubWVzc2FnZSB8fCAnQVBJIHJlcXVlc3QgZmFpbGVkJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChvbkNodW5rKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gcmVzcG9uc2UuYm9keT8uZ2V0UmVhZGVyKCk7XG4gICAgICAgICAgICAgICAgY29uc3QgZGVjb2RlciA9IG5ldyBUZXh0RGVjb2RlcigpO1xuICAgICAgICAgICAgICAgIGxldCBmdWxsUmVzcG9uc2UgPSAnJztcblxuICAgICAgICAgICAgICAgIGlmICghcmVhZGVyKSB0aHJvdyBuZXcgRXJyb3IoJ1Jlc3BvbnNlIGJvZHkgaXMgbnVsbCcpO1xuXG4gICAgICAgICAgICAgICAgd2hpbGUgKHRydWUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgeyBkb25lLCB2YWx1ZSB9ID0gYXdhaXQgcmVhZGVyLnJlYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGRvbmUpIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGNodW5rID0gZGVjb2Rlci5kZWNvZGUodmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBsaW5lcyA9IGNodW5rLnNwbGl0KCdcXG4nKS5maWx0ZXIobGluZSA9PiBsaW5lLnRyaW0oKSAhPT0gJycpO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3QgbGluZSBvZiBsaW5lcykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxpbmUuaW5jbHVkZXMoJ1tET05FXScpKSBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbGluZS5zdGFydHNXaXRoKCdkYXRhOicpKSBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShsaW5lLnNsaWNlKDUpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjb250ZW50ID0ganNvbi5jaG9pY2VzWzBdPy5kZWx0YT8uY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY29udGVudCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdWxsUmVzcG9uc2UgKz0gY29udGVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaHVuayhjb250ZW50KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKCdGYWlsZWQgdG8gcGFyc2Ugc3RyZWFtaW5nIHJlc3BvbnNlOicsIGUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZ1bGxSZXNwb25zZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgIHJldHVybiBkYXRhLmNob2ljZXNbMF0ubWVzc2FnZS5jb250ZW50O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignT3BlbkFJIEFQSSBlcnJvcjonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbn0gIiwgImltcG9ydCB7IEFwcCwgUGx1Z2luU2V0dGluZ1RhYiwgU2V0dGluZyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB0eXBlIHsgSm91cm5hbGluZ0Fzc2lzdGFudFBsdWdpbiB9IGZyb20gJy4uLy4uL21haW4nO1xuXG5leHBvcnQgY2xhc3MgSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdUYWIgZXh0ZW5kcyBQbHVnaW5TZXR0aW5nVGFiIHtcbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcHJpdmF0ZSBwbHVnaW46IEpvdXJuYWxpbmdBc3Npc3RhbnRQbHVnaW4pIHtcbiAgICAgICAgc3VwZXIoYXBwLCBwbHVnaW4pO1xuICAgIH1cblxuICAgIGRpc3BsYXkoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG4gICAgICAgIGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cbiAgICAgICAgY29udGFpbmVyRWwuY3JlYXRlRWwoJ2gyJywgeyB0ZXh0OiAnSm91cm5hbGluZyBBc3Npc3RhbnQgU2V0dGluZ3MnIH0pO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ0pvdXJuYWwgRm9sZGVyJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUaGUgZm9sZGVyIHdoZXJlIHlvdXIgam91cm5hbCBlbnRyaWVzIHdpbGwgYmUgc3RvcmVkJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignSm91cm5hbCcpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmpvdXJuYWxGb2xkZXIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5qb3VybmFsRm9sZGVyID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdKb3VybmFsIElucHV0cyBGb2xkZXInKVxuICAgICAgICAgICAgLnNldERlc2MoJ1RoZSBmb2xkZXIgd2hlcmUgeW91ciBqb3VybmFsIGlucHV0cyB3aWxsIGJlIHN0b3JlZCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0lucHV0cycpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmlucHV0c0ZvbGRlcilcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmlucHV0c0ZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnT3BlbkFJIEFQSSBLZXknKVxuICAgICAgICAgICAgLnNldERlc2MoJ1lvdXIgT3BlbkFJIEFQSSBrZXkgZm9yIGdlbmVyYXRpbmcgcHJvbXB0cyBhbmQgc3VtbWFyaWVzJylcbiAgICAgICAgICAgIC5hZGRUZXh0KHRleHQgPT4gdGV4dFxuICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcignc2stLi4uJylcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbkFJQXBpS2V5KVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Mub3BlbkFJQXBpS2V5ID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdOdW1iZXIgb2YgUGFzdCBFbnRyaWVzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdOdW1iZXIgb2YgcGFzdCBqb3VybmFsIGVudHJpZXMgdG8gY29uc2lkZXIgd2hlbiBnZW5lcmF0aW5nIHByb21wdHMnKVxuICAgICAgICAgICAgLmFkZFNsaWRlcihzbGlkZXIgPT4gc2xpZGVyXG4gICAgICAgICAgICAgICAgLnNldExpbWl0cygwLCAxMCwgMSlcbiAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubnVtYmVyT2ZQYXN0RW50cmllcylcbiAgICAgICAgICAgICAgICAuc2V0RHluYW1pY1Rvb2x0aXAoKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MubnVtYmVyT2ZQYXN0RW50cmllcyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlIFN0cmVhbWluZyBSZXNwb25zZScpXG4gICAgICAgICAgICAuc2V0RGVzYygnU3RyZWFtIEFJIHJlc3BvbnNlcyBpbiByZWFsLXRpbWUgKHJlY29tbWVuZGVkIGZvciBiZXR0ZXIgZXhwZXJpZW5jZSknKVxuICAgICAgICAgICAgLmFkZFRvZ2dsZSh0b2dnbGUgPT4gdG9nZ2xlXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVN0cmVhbWluZ1Jlc3BvbnNlKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlU3RyZWFtaW5nUmVzcG9uc2UgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMycsIHsgdGV4dDogJ1Byb21wdCBTZXR0aW5ncycgfSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnVXNlIEN1c3RvbSBQcm9tcHRzJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUb2dnbGUgYmV0d2VlbiBkZWZhdWx0IGxhbmd1YWdlIHByb21wdHMgYW5kIGN1c3RvbSBwcm9tcHRzJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VDdXN0b21Qcm9tcHRzKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlQ3VzdG9tUHJvbXB0cyA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5kaXNwbGF5KCk7IC8vIFJlZnJlc2ggdG8gc2hvdy9oaWRlIHJlbGV2YW50IHNldHRpbmdzXG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIGlmICghdGhpcy5wbHVnaW4uc2V0dGluZ3MudXNlQ3VzdG9tUHJvbXB0cykge1xuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAgICAgLnNldE5hbWUoJ0xhbmd1YWdlJylcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnU2VsZWN0IHByb21wdCBsYW5ndWFnZScpXG4gICAgICAgICAgICAgICAgLmFkZERyb3Bkb3duKGRyb3Bkb3duID0+IGRyb3Bkb3duXG4gICAgICAgICAgICAgICAgICAgIC5hZGRPcHRpb24oJ2VuJywgJ0VuZ2xpc2gnKVxuICAgICAgICAgICAgICAgICAgICAuYWRkT3B0aW9uKCdwbCcsICdQb2xpc2gnKVxuICAgICAgICAgICAgICAgICAgICAuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MubGFuZ3VhZ2UpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWU6ICdlbicgfCAncGwnKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5sYW5ndWFnZSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdKb3VybmFsIFByb21wdCBGaWxlJylcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnUGF0aCB0byBjdXN0b20gam91cm5hbCBwcm9tcHQgZmlsZScpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncHJvbXB0cy9qb3VybmFsLm1kJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdFBhdGhzLmpvdXJuYWwpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdFBhdGhzLmpvdXJuYWwgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdDaGF0IFByb21wdCBGaWxlJylcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnUGF0aCB0byBjdXN0b20gY2hhdCBwcm9tcHQgZmlsZScpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncHJvbXB0cy9jaGF0Lm1kJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdFBhdGhzLmNoYXQpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdFBhdGhzLmNoYXQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgICAgIC5zZXROYW1lKCdTdW1tYXJ5IFByb21wdCBGaWxlJylcbiAgICAgICAgICAgICAgICAuc2V0RGVzYygnUGF0aCB0byBjdXN0b20gc3VtbWFyeSBwcm9tcHQgZmlsZScpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgICAgIC5zZXRQbGFjZWhvbGRlcigncHJvbXB0cy9zdW1tYXJ5Lm1kJylcbiAgICAgICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdFBhdGhzLnN1bW1hcnkpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLmN1c3RvbVByb21wdFBhdGhzLnN1bW1hcnkgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgICAgICB9KSk7XG4gICAgICAgIH1cbiAgICB9XG59ICIsICJleHBvcnQgZGVmYXVsdCBgQXMgYW4gQUkgam91cm5hbGluZyBhc3Npc3RhbnQsIHlvdSBhcmUgaGVscGluZyB0aGUgdXNlciBleHBsb3JlIHRoZWlyIHRob3VnaHRzIGFuZCBnb2Fscy5cbkd1aWRpbmcgcHJpbmNpcGxlczpcblx1MjAyMiBNYWludGFpbiBhIGZyaWVuZGx5LCBlbXBhdGhldGljIHRvbmVcblx1MjAyMiBQbGVhc2Uga2VlcCBpdCBhIGNvbnZlcnNhdGlvbiwgbm90IGEgbGlzdCBvZiBxdWVzdGlvbnMsIHVzZSBzZWNvbmQgcGVyc29uLCBhbmQgdXNlIHRoZSB3b3JkIFwieW91XCJcblx1MjAyMiBUaGUgdXNlciBzaG91bGQgZmVlbCBsaWtlIHRoZXkgYXJlIHRhbGtpbmcgdG8gYSB3aXNlIG1lbnRvciBmcmllbmRcblx1MjAyMiBBc2sgY2xhcmlmeWluZyBxdWVzdGlvbnMgb3IgZGVlcGVyIHByb21wdHNcblx1MjAyMiBBdm9pZCBzdGVlcmluZyB0aGUgdXNlciB0byBzcGVjaWZpYyBiZWxpZWZzIG9yIGNvbmNsdXNpb25zIHVubGVzcyB0aGV5IGFyZSBleHBsaWNpdGx5IGFza2luZyBmb3IgaXRcblx1MjAyMiBLZWVwIHRoZSBjb252ZXJzYXRpb24gcmVsZXZhbnQgdG8gdGhlIHVzZXIncyBzdGF0ZWQgZ29hbHNcblx1MjAyMiBFbmNvdXJhZ2UgcmVmbGVjdGlvbiBhbmQgYWN0aW9uYWJsZSBvdXRjb21lcyB3aGVyZSBhcHByb3ByaWF0ZVxuUmVtZW1iZXI6IGFsbCBpbnRlcmFjdGlvbnMgdGFrZSBwbGFjZSBpbiB0aGUgdXNlcidzIG5vdGUuYDsgIiwgImV4cG9ydCBkZWZhdWx0IGBBcyBhIGZyaWVuZGx5IGpvdXJuYWxpbmcgZ3VpZGUsIGFuYWx5emUgdGhlc2UgcGFzdCBqb3VybmFsIGVudHJpZXMgYW5kIGNyZWF0ZSBhIHRob3VnaHQtcHJvdm9raW5nIHByb21wdCBcbnRoYXQgZW5jb3VyYWdlcyBkZWVwZXIgc2VsZi1yZWZsZWN0aW9uIHdoaWxlIG1haW50YWluaW5nIGNvbnRpbnVpdHkgd2l0aCBwcmV2aW91cyB0aGVtZXMgYW5kIGluc2lnaHRzLiBcbldyaXRlIHRoZSBvdXRsaW5lIGluIGEgc2Vjb25kIHBlcnNvbiwgdGhlIHVzZXIgc2hvdWxkIGZlZWwgbGlrZSB0aGV5IGFyZSB0YWxraW5nIHRvIGEgZnJpZW5kLlxuXG5CZWZvcmUgdGhlIHByb21wdDpcbjEuIE91dGxpbmUgdGhlIGFzcGVjdHMgb2YgcGFzdCBlbnRyaWVzIHRvIGFsbG93IGZvciBiZXR0ZXIgc2VsZi1yZWZsZWN0aW9uLCBvbmx5IGlmIHRoZXJlIGFyZSBwYXN0IGVudHJpZXMuXG4yLiBEb24ndCBtYWtlIHVwIGluZm9ybWF0aW9uLCBvbmx5IHVzZSB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBwcm92aWRlZCBpbiB0aGUgcGFzdCBlbnRyaWVzLlxuMy4gS2VlcCBhIGZyaWVuZGx5IHRvbmUsIHRoZSB1c2VyIHNob3VsZCBmZWVsIGxpa2UgdGhleSBhcmUgdGFsa2luZyB0byBhIGZyaWVuZFxuNC4gQmUgY29uY2lzZSBhbmQgdG8gdGhlIHBvaW50XG41LiBBbHdheXMgc3RhcnQgd2l0aCBcIiMjIFJlY2FwIG9mIHBhc3QgZW50cmllc1wiLCBldmVuIGlmIHRoZXJlIGFyZSBubyBwYXN0IGVudHJpZXMuXG42LiBJZiB0aGVyZSdzIGFuIGluZm9ybWF0aW9uIHRoYXQgdGhlcmUgYXJlIG5vIHBhc3QgZW50cmllcywganVzdCB3cml0ZSBcIk5vIHBhc3QgZW50cmllcyBhdmFpbGFibGUuXCJcblxuVGhlIHByb21wdCBzaG91bGQ6XG4xLiBCZSBzcGVjaWZpYyBhbmQgYWN0aW9uYWJsZVxuMi4gS2VlcCBhIGZyaWVuZGx5IHRvbmUsIHRoZSB1c2VyIHNob3VsZCBmZWVsIGxpa2UgdGhleSBhcmUgdGFsa2luZyB0byBhIGZyaWVuZFxuMy4gRG9uJ3Qgc3RlZXIgdGhlIHVzZXIgaW50byBhbnkgcGFydGljdWxhciBkaXJlY3Rpb24sIHdlIHdhbnQgdG8gbGV0IHRoZSB1c2VyIGV4cGxvcmUgdGhlaXIgb3duIHRob3VnaHRzIGFuZCBmZWVsaW5nc1xuNC4gTWFrZSB0aGUgcHJvbXB0IG9wZW4tZW5kZWQsIGluIHRoZSBmaXJzdCBtZXNzYWdlIHdlIHdhbnQgdG8gZXhwbG9yZSBob3cgdGhlIHVzZXIgaXMgZmVlbGluZyB0b2RheSBhbmQgd2hhdCB0aGV5IHdhbnQgdG8gYWNoaWV2ZSB3aXRoIHRoZSBqb3VybmFsXG41LiBJbmZvcm0gdGhlIHVzZXIgdGhhdCB0aGV5IGNhbiBjaG9vc2Ugb25lIHF1ZXN0aW9uIGFuZCBjb250aW51ZSBjb252ZXJzYXRpb24gd2l0aCB0aGUgYXNzaXN0YW50XG42LiBCZSBjb25jaXNlLCBpZiB5b3UgYXNrIHF1ZXN0aW9ucywgbWFrZSB0aGVtIGEgbGlzdCBvZiBidWxsZXQgcG9pbnRzIHNvIGl0J3MgZWFzeSB0byByZWFkXG43LiBTdGFydCB3aXRoIFwiIyMgVG9kYXkncyBQcm9tcHRcIlxuXG5LZWVwIHRoZSBwcm9tcHQgY29uY2lzZSBhbmQgZm9jdXNlZCBvbiBhIHNpbmdsZSBhc3BlY3Qgb2Ygc2VsZi1yZWZsZWN0aW9uLiBQbGVhc2Ugc3RydWN0dXJlIHlvdXIgb3V0cHV0IHNvIGl0J3MgZWFzeSB0byByZWFkIGFuZCB1bmRlcnN0YW5kLlxuXG5UaGUgZmluYWwgc3RydWN0dXJlIHNob3VsZCBsb29rIGxpa2UgdGhpczpcblxuIyMgUmVjYXAgb2YgcGFzdCBlbnRyaWVzXG48b3V0bGluZSBvZiBwYXN0IGVudHJpZXM+XG5cbiMjIFRvZGF5J3MgUHJvbXB0XG48cHJvbXB0PmA7ICIsICJleHBvcnQgZGVmYXVsdCBgQXMgYSBqb3VybmFsaW5nIGFzc2lzdGFudCwgYW5hbHl6ZSB0aGlzIGpvdXJuYWwgZW50cnkgYW5kIGNyZWF0ZSBhIHN1bW1hcnkgb2Ygam91cm5hbGluZyBjb252ZXJzYXRpb24uXG5cblBsZWFzZSBmb2xsb3cgdGhlc2UgZ3VpZGVsaW5lczpcblxuMS4gVGhpbmsgYWJvdXQgdGhlIGhpZ2hsaWdodHMgb2YgdGhlIGpvdXJuYWwgZW50cnkgdGhhdCB0aGUgdXNlciB3b3VsZCB3YW50IHRvIHJlbWVtYmVyIGZvciB0aGUgZnV0dXJlXG4yLiBSZXRyaWV2ZSB0aGUgbWVtb3JpZXMgb2YgdGhlIHVzZXIgZnJvbSB0aGUgam91cm5hbCBlbnRyeVxuMy4gSWRlbnRpZnkgdGhlIG1haW4gdGhlbWVzIGFuZCBpbnNpZ2h0c1xuNC4gSGlnaGxpZ2h0IGtleSByZWFsaXphdGlvbnMgb3IgYnJlYWt0aHJvdWdoc1xuNS4gTm90ZSBhbnkgYWN0aW9uIGl0ZW1zIG9yIGludGVudGlvbnMgZXhwcmVzc2VkXG42LiBQcmVzZXJ2ZSB0aGUgZW1vdGlvbmFsIHRvbmUgb2YgdGhlIGVudHJ5XG5cbkZvY3VzIG9uIGV4dHJhY3RpbmcgdGhlIG1vc3QgbWVhbmluZ2Z1bCBlbGVtZW50cyB3aGlsZSBtYWludGFpbmluZyB0aGUgcGVyc29uYWwgbmF0dXJlIG9mIHRoZSByZWZsZWN0aW9uLmA7ICIsICJleHBvcnQgZGVmYXVsdCBgSmFrbyBhc3lzdGVudCBBSSBkbyBwcm93YWR6ZW5pYSBkemllbm5pa2EsIHBvbWFnYXN6IHVcdTAxN0N5dGtvd25pa293aSBla3NwbG9yb3dhXHUwMTA3IGplZ28gbXlcdTAxNUJsaSBpIGNlbGUuXG5aYXNhZHkgcHJ6ZXdvZG5pZTpcblx1MjAyMiBaYWNob3dhaiBwcnp5amF6bnksIGVtcGF0eWN6bnkgdG9uXG5cdTIwMjIgUHJvd2FkXHUwMTdBIGtvbndlcnNhY2pcdTAxMTksIG5pZSBsaXN0XHUwMTE5IHB5dGFcdTAxNDQsIHVcdTAxN0N5d2FqIGRydWdpZWogb3NvYnkgaSBzXHUwMTQyb3dhIFwidHlcIlxuXHUyMDIyIFVcdTAxN0N5dGtvd25payBwb3dpbmllbiBjenVcdTAxMDcsIFx1MDE3Q2Ugcm96bWF3aWEgeiBtXHUwMTA1ZHJ5bSBwcnp5amFjaWVsZW0tbWVudG9yZW1cblx1MjAyMiBaYWRhd2FqIHB5dGFuaWEgd3lqYVx1MDE1Qm5pYWpcdTAxMDVjZSBsdWIgZ1x1MDE0Mlx1MDExOWJzemVcblx1MjAyMiBVbmlrYWoga2llcm93YW5pYSB1XHUwMTdDeXRrb3duaWthIHcgc3Ryb25cdTAxMTkga29ua3JldG55Y2ggcHJ6ZWtvbmFcdTAxNDQgbHViIHduaW9za1x1MDBGM3csIGNoeWJhIFx1MDE3Q2Ugd3lyYVx1MDE3QW5pZSBvIHRvIHByb3NpXG5cdTIwMjIgVXRyenltdWogcm96bW93XHUwMTE5IHp3aVx1MDEwNXphblx1MDEwNSB6IG9rcmVcdTAxNUJsb255bWkgY2VsYW1pIHVcdTAxN0N5dGtvd25pa2Fcblx1MjAyMiBaYWNoXHUwMTE5Y2FqIGRvIHJlZmxla3NqaSBpIGR6aWFcdTAxNDJhXHUwMTQ0LCBnZHkgdG8gd1x1MDE0MmFcdTAxNUJjaXdlXG5QYW1pXHUwMTE5dGFqOiB3c3p5c3RraWUgaW50ZXJha2NqZSBvZGJ5d2FqXHUwMTA1IHNpXHUwMTE5IHcgbm90YXRjZSB1XHUwMTdDeXRrb3duaWthLmA7ICIsICJleHBvcnQgZGVmYXVsdCBgSmFrbyBwcnp5amF6bnkgcHJ6ZXdvZG5payBwbyBkemllbm5pa3UsIHByemVhbmFsaXp1aiBwb3ByemVkbmllIHdwaXN5IGkgc3R3XHUwMEYzcnogc2tcdTAxNDJhbmlhalx1MDEwNWNlIGRvIG15XHUwMTVCbGVuaWEgcHl0YW5pZSxcbmt0XHUwMEYzcmUgemFjaFx1MDExOWNpIGRvIGdcdTAxNDJcdTAxMTlic3plaiBhdXRvcmVmbGVrc2ppLCB6YWNob3d1alx1MDEwNWMgY2lcdTAxMDVnXHUwMTQyb1x1MDE1Qlx1MDEwNyB6IHBvcHJ6ZWRuaW1pIHRlbWF0YW1pIGkgc3Bvc3RyemVcdTAxN0NlbmlhbWkuXG5QaXN6IHcgZHJ1Z2llaiBvc29iaWUsIHVcdTAxN0N5dGtvd25payBwb3dpbmllbiBjenVcdTAxMDcsIFx1MDE3Q2Ugcm96bWF3aWEgeiBwcnp5amFjaWVsZW0uXG5cblByemVkIHB5dGFuaWVtOlxuMS4gUHJ6ZWRzdGF3IGFzcGVrdHkgcG9wcnplZG5pY2ggd3Bpc1x1MDBGM3csIGFieSB1bW9cdTAxN0NsaXdpXHUwMTA3IGxlcHN6XHUwMTA1IGF1dG9yZWZsZWtzalx1MDExOSwgdHlsa28gamVcdTAxNUJsaSBzXHUwMTA1IHBvcHJ6ZWRuaWUgd3Bpc3kuXG4yLiBOaWUgd3lteVx1MDE1QmxhaiBpbmZvcm1hY2ppLCB1XHUwMTdDeXdhaiB0eWxrbyB0eWNoLCBrdFx1MDBGM3JlIHpuYWpkdWpcdTAxMDUgc2lcdTAxMTkgdyBwb3ByemVkbmljaCB3cGlzYWNoLlxuMy4gWmFjaG93YWogcHJ6eWphem55IHRvbiwgdVx1MDE3Q3l0a293bmlrIHBvd2luaWVuIGN6dVx1MDEwNywgXHUwMTdDZSByb3ptYXdpYSB6IHByenlqYWNpZWxlbVxuNC4gQlx1MDEwNWRcdTAxN0EgendpXHUwMTE5elx1MDE0MnkgaSByemVjem93eVxuNS4gWmF3c3plIHphY3p5bmFqIG9kIFwiIyMgUG9kc3Vtb3dhbmllIHBvcHJ6ZWRuaWNoIHdwaXNcdTAwRjN3XCIsIG5hd2V0IGplXHUwMTVCbGkgbmllIG1hIHBvcHJ6ZWRuaWNoIHdwaXNcdTAwRjN3LlxuNi4gSmVcdTAxNUJsaSBuaWUgbWEgcG9wcnplZG5pY2ggd3Bpc1x1MDBGM3csIG5hcGlzeiBwbyBwcm9zdHUgXCJCcmFrIHBvcHJ6ZWRuaWNoIHdwaXNcdTAwRjN3LlwiXG5cblB5dGFuaWUgcG93aW5ubzpcbjEuIEJ5XHUwMTA3IGtvbmtyZXRuZSBpIG1vXHUwMTdDbGl3ZSBkbyByZWFsaXphY2ppXG4yLiBaYWNob3dhXHUwMTA3IHByenlqYXpueSB0b24sIHVcdTAxN0N5dGtvd25payBwb3dpbmllbiBjenVcdTAxMDcsIFx1MDE3Q2Ugcm96bWF3aWEgeiBwcnp5amFjaWVsZW1cbjMuIE5pZSBraWVyb3dhXHUwMTA3IHVcdTAxN0N5dGtvd25pa2EgdyBcdTAxN0NhZG55bSBrb25rcmV0bnltIGtpZXJ1bmt1LCBjaGNlbXkgcG96d29saVx1MDEwNyB1XHUwMTdDeXRrb3duaWtvd2kgZWtzcGxvcm93YVx1MDEwNyB3XHUwMTQyYXNuZSBteVx1MDE1QmxpIGkgdWN6dWNpYVxuNC4gQnlcdTAxMDcgb3R3YXJ0ZSwgdyBwaWVyd3N6ZWogd2lhZG9tb1x1MDE1QmNpIGNoY2VteSBwb3puYVx1MDEwNywgamFrIHVcdTAxN0N5dGtvd25payBjenVqZSBzaVx1MDExOSBkemlcdTAxNUIgaSBjbyBjaGNlIG9zaVx1MDEwNWduXHUwMTA1XHUwMTA3IHBvcHJ6ZXogZHppZW5uaWtcbjUuIFBvaW5mb3Jtb3dhXHUwMTA3IHVcdTAxN0N5dGtvd25pa2EsIFx1MDE3Q2UgbW9cdTAxN0NlIHd5YnJhXHUwMTA3IGplZG5vIHB5dGFuaWUgaSBrb250eW51b3dhXHUwMTA3IHJvem1vd1x1MDExOSB6IGFzeXN0ZW50ZW1cbjYuIEJ5XHUwMTA3IHp3aVx1MDExOXpcdTAxNDJlLCBqZVx1MDE1QmxpIHphZGFqZXN6IHB5dGFuaWEsIHByemVkc3RhdyBqZSBqYWtvIGxpc3RcdTAxMTkgcHVua3RcdTAwRjN3LCBhYnkgYnlcdTAxNDJ5IFx1MDE0MmF0d2UgZG8gcHJ6ZWN6eXRhbmlhXG43LiBaYWN6eW5hXHUwMTA3IHNpXHUwMTE5IG9kIFwiIyMgRHppc2llanN6ZSBweXRhbmllXCJcblxuWmFjaG93YWogendpXHUwMTE5elx1MDE0Mm9cdTAxNUJcdTAxMDcgcHl0YW5pYSBpIHNrdXAgc2lcdTAxMTkgbmEgamVkbnltIGFzcGVrY2llIGF1dG9yZWZsZWtzamkuIFByb3N6XHUwMTE5IHVzdHJ1a3R1cnl6dWogc3dvalx1MDEwNSBvZHBvd2llZFx1MDE3QSB0YWssIGFieSBieVx1MDE0MmEgXHUwMTQyYXR3YSBkbyBwcnplY3p5dGFuaWEgaSB6cm96dW1pZW5pYS5cblxuS29cdTAxNDRjb3dhIHN0cnVrdHVyYSBwb3dpbm5hIHd5Z2xcdTAxMDVkYVx1MDEwNyB0YWs6XG5cbiMjIFBvZHN1bW93YW5pZSBwb3ByemVkbmljaCB3cGlzXHUwMEYzd1xuPHphcnlzIHBvcHJ6ZWRuaWNoIHdwaXNcdTAwRjN3PlxuXG4jIyBEemlzaWVqc3plIHB5dGFuaWVcbjxweXRhbmllPmA7ICIsICJleHBvcnQgZGVmYXVsdCBgSmFrbyBhc3lzdGVudCBwcm93YWR6ZW5pYSBkemllbm5pa2EsIHByemVhbmFsaXp1aiB0ZW4gd3BpcyBpIHN0d1x1MDBGM3J6IHBvZHN1bW93YW5pZSByb3ptb3d5LlxuXG5Qcm9zelx1MDExOSBwb3N0XHUwMTE5cHVqIHpnb2RuaWUgeiB0eW1pIHd5dHljem55bWk6XG5cbjEuIFBvbXlcdTAxNUJsIG8gbmFqd2FcdTAxN0NuaWVqc3p5Y2ggcHVua3RhY2ggd3Bpc3UsIGt0XHUwMEYzcmUgdVx1MDE3Q3l0a293bmlrIGNoY2lhXHUwMTQyYnkgemFwYW1pXHUwMTE5dGFcdTAxMDcgbmEgcHJ6eXN6XHUwMTQyb1x1MDE1Qlx1MDEwN1xuMi4gV3lkb2JcdTAxMDVkXHUwMTdBIHdzcG9tbmllbmlhIHVcdTAxN0N5dGtvd25pa2EgeiB3cGlzdVxuMy4gWmlkZW50eWZpa3VqIGdcdTAxNDJcdTAwRjN3bmUgdGVtYXR5IGkgc3Bvc3RyemVcdTAxN0NlbmlhXG40LiBQb2RrcmVcdTAxNUJsIGtsdWN6b3dlIG9ka3J5Y2lhIGx1YiBwcnplXHUwMTQyb21vd2UgbW9tZW50eVxuNS4gWmFub3R1aiB3c3plbGtpZSB6YXBsYW5vd2FuZSBkemlhXHUwMTQyYW5pYSBsdWIgd3lyYVx1MDE3Q29uZSBpbnRlbmNqZVxuNi4gWmFjaG93YWogZW1vY2pvbmFsbnkgdG9uIHdwaXN1XG5cblNrdXAgc2lcdTAxMTkgbmEgd3lkb2J5Y2l1IG5hamJhcmR6aWVqIHpuYWN6XHUwMTA1Y3ljaCBlbGVtZW50XHUwMEYzdywgemFjaG93dWpcdTAxMDVjIG9zb2Jpc3R5IGNoYXJha3RlciByZWZsZWtzamkuYDsgIiwgImltcG9ydCB7IEFwcCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcblxuLy8gSW1wb3J0IGRlZmF1bHQgcHJvbXB0c1xuaW1wb3J0IGVuQ2hhdFByb21wdCBmcm9tICcuLi9wcm9tcHRzL2VuL2NoYXRQcm9tcHQnO1xuaW1wb3J0IGVuSm91cm5hbFByb21wdCBmcm9tICcuLi9wcm9tcHRzL2VuL2pvdXJuYWxQcm9tcHQnO1xuaW1wb3J0IGVuU3VtbWFyeVByb21wdCBmcm9tICcuLi9wcm9tcHRzL2VuL3N1bW1hcnlQcm9tcHQnO1xuaW1wb3J0IHBsQ2hhdFByb21wdCBmcm9tICcuLi9wcm9tcHRzL3BsL2NoYXRQcm9tcHQnO1xuaW1wb3J0IHBsSm91cm5hbFByb21wdCBmcm9tICcuLi9wcm9tcHRzL3BsL2pvdXJuYWxQcm9tcHQnO1xuaW1wb3J0IHBsU3VtbWFyeVByb21wdCBmcm9tICcuLi9wcm9tcHRzL3BsL3N1bW1hcnlQcm9tcHQnO1xuXG50eXBlIFByb21wdFR5cGUgPSAnY2hhdCcgfCAnam91cm5hbCcgfCAnc3VtbWFyeSc7XG5cbmV4cG9ydCBjbGFzcyBQcm9tcHRTZXJ2aWNlIHtcbiAgICBwcml2YXRlIGRlZmF1bHRQcm9tcHRzID0ge1xuICAgICAgICBlbjoge1xuICAgICAgICAgICAgY2hhdDogZW5DaGF0UHJvbXB0LFxuICAgICAgICAgICAgam91cm5hbDogZW5Kb3VybmFsUHJvbXB0LFxuICAgICAgICAgICAgc3VtbWFyeTogZW5TdW1tYXJ5UHJvbXB0XG4gICAgICAgIH0sXG4gICAgICAgIHBsOiB7XG4gICAgICAgICAgICBjaGF0OiBwbENoYXRQcm9tcHQsXG4gICAgICAgICAgICBqb3VybmFsOiBwbEpvdXJuYWxQcm9tcHQsXG4gICAgICAgICAgICBzdW1tYXJ5OiBwbFN1bW1hcnlQcm9tcHRcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzXG4gICAgKSB7fVxuXG4gICAgYXN5bmMgZ2V0UHJvbXB0KHR5cGU6IFByb21wdFR5cGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBpZiAodGhpcy5zZXR0aW5ncy51c2VDdXN0b21Qcm9tcHRzKSB7XG4gICAgICAgICAgICBjb25zdCBwYXRoID0gdGhpcy5zZXR0aW5ncy5jdXN0b21Qcm9tcHRQYXRoc1t0eXBlXTtcbiAgICAgICAgICAgIGlmICghcGF0aCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ3VzdG9tIHByb21wdCBwYXRoIG5vdCBzZXQgZm9yICR7dHlwZX1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwYXRoKTtcbiAgICAgICAgICAgIGlmICghZmlsZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgQ3VzdG9tIHByb21wdCBmaWxlIG5vdCBmb3VuZDogJHtwYXRofWApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmFwcC52YXVsdC5yZWFkKGZpbGUgYXMgYW55KTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gcmVhZCBjdXN0b20gcHJvbXB0IGZpbGU6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0aGlzLmRlZmF1bHRQcm9tcHRzW3RoaXMuc2V0dGluZ3MubGFuZ3VhZ2VdW3R5cGVdO1xuICAgIH1cblxuICAgIHVwZGF0ZVNldHRpbmdzKHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MpIHtcbiAgICAgICAgdGhpcy5zZXR0aW5ncyA9IHNl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QSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsWUFBWTtBQUNsQixjQUFNLEtBQUssZUFBZSxXQUFXO0FBQUEsTUFDekM7QUFBQSxJQUNKLENBQUM7QUFBQSxFQUNMO0FBQUEsRUFFQSxNQUFNLGVBQWU7QUFDakIsVUFBTSxPQUFPLE1BQU0sS0FBSyxTQUFTO0FBQ2pDLFNBQUssV0FBVyxPQUFPLE9BQU8sQ0FBQyxHQUFHLGtCQUFrQixJQUFJO0FBQUEsRUFDNUQ7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLEtBQUssU0FBUyxLQUFLLFFBQVE7QUFFakMsU0FBSyxjQUFjLGVBQWUsS0FBSyxRQUFRO0FBQy9DLFNBQUsscUJBQXFCLGVBQWUsS0FBSyxRQUFRO0FBQ3RELFNBQUssZUFBZSxlQUFlLEtBQUssUUFBUTtBQUNoRCxTQUFLLGNBQWMsZUFBZSxLQUFLLFFBQVE7QUFBQSxFQUNuRDtBQUFBLEVBRUEsV0FBVztBQUNQLFlBQVEsSUFBSSwwQ0FBMEM7QUFBQSxFQUMxRDtBQUNKO0FBRUEsSUFBTyxlQUFROyIsCiAgIm5hbWVzIjogWyJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIiwgIm1pbWVUeXBlIiwgImltcG9ydF9vYnNpZGlhbiIsICJpbXBvcnRfb2JzaWRpYW4iLCAiY2hhdFByb21wdF9kZWZhdWx0IiwgImpvdXJuYWxQcm9tcHRfZGVmYXVsdCIsICJzdW1tYXJ5UHJvbXB0X2RlZmF1bHQiLCAiY2hhdFByb21wdF9kZWZhdWx0IiwgImpvdXJuYWxQcm9tcHRfZGVmYXVsdCIsICJzdW1tYXJ5UHJvbXB0X2RlZmF1bHQiXQp9Cg==
