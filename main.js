/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);

// main.ts
var main_exports = {};
__export(main_exports, {
  JournalingAssistantPlugin: () => JournalingAssistantPlugin,
  default: () => main_default
});
module.exports = __toCommonJS(main_exports);
var import_obsidian5 = require("obsidian");

// src/types.ts
var DEFAULT_SETTINGS = {
  journalFolder: "Journal",
  inputsFolder: "Inputs",
  openAIApiKey: "",
  numberOfPastEntries: 3,
  useStreamingResponse: true
};

// src/core/journal/JournalService.ts
var import_obsidian3 = require("obsidian");

// src/core/transcription/AudioProcessingService.ts
var AudioProcessingService = class {
  constructor(vault) {
    this.vault = vault;
  }
  async convertM4AtoWAV(file) {
    try {
      const arrayBuffer = await this.vault.readBinary(file);
      const audioContext = new (window.AudioContext || window.webkitAudioContext)();
      const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);
      const offlineContext = new OfflineAudioContext(
        audioBuffer.numberOfChannels,
        audioBuffer.length,
        audioBuffer.sampleRate
      );
      const source = offlineContext.createBufferSource();
      source.buffer = audioBuffer;
      source.connect(offlineContext.destination);
      source.start(0);
      const renderedBuffer = await offlineContext.startRendering();
      return {
        buffer: this.createWAVFile(renderedBuffer),
        mimeType: "audio/wav"
      };
    } catch (error) {
      console.error("Error converting M4A to WAV:", error);
      throw new Error("Failed to convert M4A to WAV format");
    }
  }
  createWAVFile(audioBuffer) {
    const length = audioBuffer.length * 2;
    const outputBuffer = new ArrayBuffer(44 + length);
    const view = new DataView(outputBuffer);
    this.writeWAVHeader(view, length, audioBuffer);
    const data = new Float32Array(audioBuffer.getChannelData(0));
    let offset = 44;
    for (let i = 0; i < data.length; i++) {
      const sample = Math.max(-1, Math.min(1, data[i]));
      view.setInt16(offset, sample < 0 ? sample * 32768 : sample * 32767, true);
      offset += 2;
    }
    return outputBuffer;
  }
  writeWAVHeader(view, length, audioBuffer) {
    const writeString = (offset, string) => {
      for (let i = 0; i < string.length; i++) {
        view.setUint8(offset + i, string.charCodeAt(i));
      }
    };
    writeString(0, "RIFF");
    view.setUint32(4, 36 + length, true);
    writeString(8, "WAVE");
    writeString(12, "fmt ");
    view.setUint32(16, 16, true);
    view.setUint16(20, 1, true);
    view.setUint16(22, audioBuffer.numberOfChannels, true);
    view.setUint32(24, audioBuffer.sampleRate, true);
    view.setUint32(28, audioBuffer.sampleRate * 2, true);
    view.setUint16(32, 2, true);
    view.setUint16(34, 16, true);
    writeString(36, "data");
    view.setUint32(40, length, true);
  }
};

// src/core/ai/services/WhisperService.ts
var _WhisperService = class {
  constructor(vault, apiKey) {
    this.vault = vault;
    this.apiKey = apiKey;
    this.audioProcessor = new AudioProcessingService(vault);
  }
  setApiKey(apiKey) {
    this.apiKey = apiKey;
  }
  static isSupportedFormat(file) {
    const extension = file.extension.toLowerCase();
    return _WhisperService.SUPPORTED_FORMATS.includes(extension);
  }
  async prepareAudioForTranscription(file) {
    if (file.extension.toLowerCase() === "m4a") {
      console.log("Converting M4A to WAV format...");
      const { buffer, mimeType: mimeType2 } = await this.audioProcessor.convertM4AtoWAV(file);
      return {
        blob: new Blob([buffer], { type: mimeType2 }),
        mimeType: mimeType2
      };
    }
    const arrayBuffer = await this.vault.readBinary(file);
    const mimeType = _WhisperService.MIME_TYPES[file.extension.toLowerCase()];
    if (!mimeType) {
      throw new Error(`Unsupported MIME type for extension: ${file.extension}`);
    }
    return {
      blob: new Blob([arrayBuffer], { type: mimeType }),
      mimeType
    };
  }
  async transcribeFile(audioFile) {
    var _a;
    try {
      if (!this.apiKey) {
        throw new Error("OpenAI API key is required for transcription");
      }
      if (!_WhisperService.isSupportedFormat(audioFile)) {
        throw new Error(`Unsupported audio format: ${audioFile.extension}`);
      }
      const { blob, mimeType } = await this.prepareAudioForTranscription(audioFile);
      console.log(`Processing file: ${audioFile.name} with MIME type: ${mimeType}`);
      const formData = new FormData();
      const extension = audioFile.extension.toLowerCase() === "m4a" ? "wav" : audioFile.extension;
      formData.append("file", blob, `${audioFile.basename}.${extension}`);
      formData.append("model", "whisper-1");
      const response = await fetch("https://api.openai.com/v1/audio/transcriptions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${this.apiKey}`
        },
        body: formData
      });
      if (!response.ok) {
        const errorData = await response.json();
        console.error("OpenAI API Error:", {
          status: response.status,
          statusText: response.statusText,
          error: errorData
        });
        throw new Error(((_a = errorData.error) == null ? void 0 : _a.message) || `Transcription failed with status ${response.status}`);
      }
      const result = await response.json();
      return result.text;
    } catch (error) {
      console.error("Detailed transcription error:", {
        fileName: audioFile.name,
        extension: audioFile.extension,
        error: error instanceof Error ? {
          message: error.message,
          stack: error.stack
        } : error
      });
      throw error;
    }
  }
};
var WhisperService = _WhisperService;
WhisperService.SUPPORTED_FORMATS = ["flac", "mp3", "mp4", "mpeg", "mpga", "m4a", "ogg", "wav", "webm"];
WhisperService.MIME_TYPES = {
  "flac": "audio/flac",
  "mp3": "audio/mpeg",
  "mp4": "audio/mp4",
  "mpeg": "audio/mpeg",
  "mpga": "audio/mpeg",
  "m4a": "audio/mp4",
  "ogg": "audio/ogg",
  "wav": "audio/wav",
  "webm": "audio/webm"
};

// src/core/transcription/TranscriptionService.ts
var import_obsidian = require("obsidian");

// src/utils/helpers.ts
var getRecordingEmbedPattern = () => {
  return /!\[\[.+\.(flac|mp3|mp4|mpeg|mpga|m4a|ogg|wav|webm)\]\]/g;
};
var getTodayFileName = () => {
  const date = new Date();
  return date.toISOString().split("T")[0] + ".md";
};

// src/core/transcription/TranscriptionService.ts
var TranscriptionService = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
    this.whisperService = new WhisperService(this.app.vault, this.settings.openAIApiKey);
  }
  updateSettings(settings) {
    this.settings = settings;
    this.whisperService.setApiKey(settings.openAIApiKey);
  }
  async transcribeRecordings() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian.MarkdownView);
    if (!activeView) {
      new import_obsidian.Notice("Please open a note first");
      return;
    }
    if (!this.settings.openAIApiKey) {
      new import_obsidian.Notice("OpenAI API key not configured");
      return;
    }
    const editor = activeView.editor;
    const content = editor.getValue();
    const recordingPattern = getRecordingEmbedPattern();
    const recordings = content.match(recordingPattern);
    if (!recordings || recordings.length === 0) {
      new import_obsidian.Notice("No recordings found in the current note");
      return;
    }
    new import_obsidian.Notice("Starting transcription...");
    let updatedContent = content;
    let hasErrors = false;
    try {
      for (const recording of recordings) {
        const fileName = recording.slice(3, -2);
        const file = this.app.metadataCache.getFirstLinkpathDest(fileName, "");
        if (!(file instanceof import_obsidian.TFile)) {
          new import_obsidian.Notice(`Could not find file: ${fileName}`);
          hasErrors = true;
          continue;
        }
        try {
          const transcript = await this.whisperService.transcribeFile(file);
          updatedContent = updatedContent.replace(recording, transcript);
        } catch (error) {
          new import_obsidian.Notice(`Failed to transcribe ${fileName}: ${error.message}`);
          hasErrors = true;
          continue;
        }
      }
      editor.setValue(updatedContent);
      if (hasErrors) {
        new import_obsidian.Notice("Transcription completed with some errors");
      } else {
        new import_obsidian.Notice("Transcription completed successfully");
      }
    } catch (error) {
      new import_obsidian.Notice(`Transcription failed: ${error.message}`);
      console.error("Transcription error:", error);
    }
  }
};

// src/core/summary/SummarizationService.ts
var import_obsidian2 = require("obsidian");

// src/core/ai/prompts/summaryPrompt.ts
var summaryPrompt_default = `As a journaling assistant, analyze this journal entry and create a summary of journaling conversation.

Please follow these guidelines:

1. Think about the highlights of the journal entry that the user would want to remember for the future
2. Retrieve the memories of the user from the journal entry
3. Identify the main themes and insights
4. Highlight key realizations or breakthroughs
5. Note any action items or intentions expressed
6. Preserve the emotional tone of the entry

Focus on extracting the most meaningful elements while maintaining the personal nature of the reflection.`;

// src/core/summary/SummarizationService.ts
var SummarizationService = class {
  constructor(openAIService) {
    this.openAIService = openAIService;
  }
  async summarize(content, useStreaming = false, onChunk) {
    try {
      const prompt = `${summaryPrompt_default}

${content}`;
      return await this.openAIService.makeOpenAIRequest(
        prompt,
        useStreaming ? onChunk : void 0
      );
    } catch (error) {
      new import_obsidian2.Notice(`Error during summarization: ${error.message}`);
      throw error;
    }
  }
};

// src/core/ai/prompts/chatPrompt.ts
var chatPrompt_default = `As an AI journaling assistant, you are helping the user explore their thoughts and goals.
Guiding principles:
\u2022 Maintain a friendly, empathetic tone
\u2022 Please keep it a conversation, not a list of questions, use second person, and use the word "you"
\u2022 The user should feel like they are talking to a wise mentor friend
\u2022 Ask clarifying questions or deeper prompts
\u2022 Avoid steering the user to specific beliefs or conclusions unless they are explicitly asking for it
\u2022 Keep the conversation relevant to the user's stated goals
\u2022 Encourage reflection and actionable outcomes where appropriate
Remember: all interactions take place in the user's note.`;

// src/core/ai/services/ChatService.ts
var ChatService = class {
  constructor(openAIService) {
    this.openAIService = openAIService;
  }
  async chat(transcribedText) {
    const prompt = `${chatPrompt_default}

User: ${transcribedText}

Assistant:`;
    return this.openAIService.makeOpenAIRequest(prompt);
  }
};

// src/core/journal/JournalManager.ts
var JournalManager = class {
  constructor(app, settings) {
    this.app = app;
    this.settings = settings;
  }
  async ensureFolder(folderPath) {
    if (!await this.app.vault.adapter.exists(folderPath)) {
      await this.app.vault.createFolder(folderPath);
    }
  }
  getTodayFileName() {
    return getTodayFileName();
  }
  async getPastJournalEntries(count) {
    const folder = this.app.vault.getAbstractFileByPath(this.settings.journalFolder);
    if (!folder)
      return [];
    const files = this.app.vault.getMarkdownFiles().filter((file) => file.path.startsWith(this.settings.journalFolder + "/")).sort((a, b) => b.stat.mtime - a.stat.mtime).slice(1, count + 1);
    const entries = await Promise.all(
      files.map(async (file) => {
        const content = await this.app.vault.read(file);
        return {
          date: file.basename,
          content
        };
      })
    );
    return entries.map((entry) => `Date: ${entry.date}
${entry.content}`);
  }
  async createNewJournalEntry() {
    const fileName = this.getTodayFileName();
    const filePath = `${this.settings.journalFolder}/${fileName}`;
    const initialContent = `# Journal Entry - ${new Date().toLocaleDateString()}

`;
    return await this.app.vault.create(filePath, initialContent);
  }
};

// src/core/ai/prompts/journalPrompt.ts
var journalPrompt_default = `As a friendly journaling guide, analyze these past journal entries and create a thought-provoking prompt 
that encourages deeper self-reflection while maintaining continuity with previous themes and insights. 
Write the outline in a second person, the user should feel like they are talking to a friend.

Before the prompt:
1. Outline the aspects of past entries to allow for better self-reflection, only if there are past entries.
2. Don't make up information, only use the information that is provided in the past entries.
3. Keep a friendly tone, the user should feel like they are talking to a friend
4. Be concise and to the point
5. Always start with "## Recap of past entries", even if there are no past entries.
6. If there's an information that there are no past entries, just write "No past entries available."

The prompt should:
1. Be specific and actionable
2. Keep a friendly tone, the user should feel like they are talking to a friend
3. Don't steer the user into any particular direction, we want to let the user explore their own thoughts and feelings
4. Make the prompt open-ended, in the first message we want to explore how the user is feeling today and what they want to achieve with the journal
5. Inform the user that they can choose one question and continue conversation with the assistant
6. Be concise, if you ask questions, make them a list of bullet points so it's easy to read
7. Start with "## Today's Prompt"

Keep the prompt concise and focused on a single aspect of self-reflection. Please structure your output so it's easy to read and understand.

The final structure should look like this:

## Recap of past entries
<outline of past entries>

## Today's Prompt
<prompt>`;

// src/core/journal/JournalService.ts
var _JournalService = class {
  constructor(app, settings, openAIService) {
    this.app = app;
    this.settings = settings;
    this.openAIService = openAIService;
    this.journalManager = new JournalManager(this.app, this.settings);
    this.whisperService = new WhisperService(this.app.vault, this.settings.openAIApiKey);
    this.summarizationService = new SummarizationService(this.openAIService);
    this.chatService = new ChatService(this.openAIService);
    this.transcriptionService = new TranscriptionService(this.app, this.settings);
  }
  updateSettings(settings) {
    this.settings = settings;
    this.whisperService.setApiKey(settings.openAIApiKey);
    this.transcriptionService.updateSettings(settings);
    this.openAIService.updateSettings(settings);
  }
  async openTodaysJournal() {
    try {
      await this.journalManager.ensureFolder(this.settings.journalFolder);
      const filePath = `${this.settings.journalFolder}/${this.journalManager.getTodayFileName()}`;
      let file = this.app.vault.getAbstractFileByPath(filePath);
      if (!file) {
        const loadingNotice = new import_obsidian3.Notice("Generating journal prompt...", 0);
        try {
          file = await this.journalManager.createNewJournalEntry();
          const pastEntries = await this.journalManager.getPastJournalEntries(this.settings.numberOfPastEntries);
          const leaf = this.app.workspace.getLeaf(false);
          await leaf.openFile(file);
          const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
          if (view) {
            if (this.settings.useStreamingResponse) {
              await this.openAIService.makeOpenAIRequest(
                this.createJournalPrompt(pastEntries),
                (chunk) => {
                  const currentContent = view.editor.getValue();
                  view.editor.setValue(currentContent + chunk);
                }
              );
            } else {
              const aiPrompt = await this.openAIService.makeOpenAIRequest(
                this.createJournalPrompt(pastEntries)
              );
              view.editor.setValue(view.editor.getValue() + aiPrompt);
            }
            view.editor.setValue(view.editor.getValue() + "\n\n## Your Journal Response\n\n");
          }
          loadingNotice.hide();
          new import_obsidian3.Notice("Created new journal entry for today");
        } catch (error) {
          new import_obsidian3.Notice("Error generating prompt: " + error.message);
          const view = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
          if (view) {
            view.editor.setValue(view.editor.getValue() + "\n\n## Your Journal Response\n\n");
          }
        }
      } else {
        const leaf = this.app.workspace.getLeaf(false);
        await leaf.openFile(file);
      }
    } catch (error) {
      new import_obsidian3.Notice("Error opening today's journal: " + error.message);
      console.error("Error opening today's journal:", error);
    }
  }
  createJournalPrompt(pastEntries) {
    const pastEntriesText = pastEntries.length > 0 ? `Past Entries:

${pastEntries.join("\n\n---\n\n")}` : "No past entries available.";
    return `${journalPrompt_default}

${pastEntriesText}`;
  }
  async summarizeJournalingSession() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView || !activeView.file) {
      new import_obsidian3.Notice("Please open a note first");
      return;
    }
    try {
      const originalContent = activeView.editor.getValue();
      const fileName = activeView.file.name;
      const inputPath = `${this.settings.inputsFolder}/${fileName}`;
      await this.journalManager.ensureFolder(this.settings.inputsFolder);
      await this.app.vault.create(inputPath, originalContent);
      await this.transcriptionService.transcribeRecordings();
      const processedContent = activeView.editor.getValue();
      const responseMatch = processedContent.match(_JournalService.JOURNAL_RESPONSE_PATTERN);
      if (!responseMatch) {
        new import_obsidian3.Notice("Could not find journal response section");
        return;
      }
      const userResponse = responseMatch[1].trim();
      let summary;
      if (this.settings.useStreamingResponse) {
        let streamedSummary = "";
        summary = await this.summarizationService.summarize(
          userResponse,
          true,
          (chunk) => {
            streamedSummary += chunk;
            const updatedContent = processedContent.replace(
              _JournalService.JOURNAL_RESPONSE_PATTERN,
              `## Your Journal Response

${streamedSummary}`
            );
            activeView.editor.setValue(updatedContent);
          }
        );
      } else {
        summary = await this.summarizationService.summarize(userResponse);
        const updatedContent = processedContent.replace(
          _JournalService.JOURNAL_RESPONSE_PATTERN,
          `## Your Journal Response

${summary}`
        );
        activeView.editor.setValue(updatedContent);
      }
      new import_obsidian3.Notice("Journal session summarized");
    } catch (error) {
      new import_obsidian3.Notice(`Error: ${error.message}`);
      console.error("Summarization error:", error);
    }
  }
  async chatWithAI() {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian3.MarkdownView);
    if (!activeView) {
      new import_obsidian3.Notice("Please open a note first");
      return;
    }
    try {
      await this.transcriptionService.transcribeRecordings();
      const content = activeView.editor.getValue();
      const chatResponse = await this.chatService.chat(content);
      activeView.editor.setValue(
        content + "\n\n---\n## AI Chat\n\n" + chatResponse + "\n\n---\n## Me\n"
      );
      new import_obsidian3.Notice("AI responded in note");
    } catch (error) {
      new import_obsidian3.Notice(`Error during chat: ${error.message}`);
    }
  }
};
var JournalService = _JournalService;
JournalService.JOURNAL_RESPONSE_PATTERN = /## Your Journal Response\s*([\s\S]*$)/;

// src/core/ai/services/OpenAIService.ts
var OpenAIService = class {
  constructor(settings) {
    this.settings = settings;
  }
  updateSettings(settings) {
    this.settings = settings;
  }
  async makeOpenAIRequest(prompt, onChunk) {
    var _a, _b, _c, _d;
    if (!this.settings.openAIApiKey) {
      throw new Error("OpenAI API key not configured");
    }
    try {
      const response = await fetch("https://api.openai.com/v1/chat/completions", {
        method: "POST",
        headers: {
          "Authorization": `Bearer ${this.settings.openAIApiKey}`,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          model: "gpt-4o-mini",
          messages: [{ role: "user", content: prompt }],
          temperature: 0.7,
          stream: !!onChunk
        })
      });
      if (!response.ok) {
        const error = await response.json();
        throw new Error(((_a = error.error) == null ? void 0 : _a.message) || "API request failed");
      }
      if (onChunk) {
        const reader = (_b = response.body) == null ? void 0 : _b.getReader();
        const decoder = new TextDecoder();
        let fullResponse = "";
        if (!reader)
          throw new Error("Response body is null");
        while (true) {
          const { done, value } = await reader.read();
          if (done)
            break;
          const chunk = decoder.decode(value);
          const lines = chunk.split("\n").filter((line) => line.trim() !== "");
          for (const line of lines) {
            if (line.includes("[DONE]"))
              continue;
            if (!line.startsWith("data:"))
              continue;
            try {
              const json = JSON.parse(line.slice(5));
              const content = (_d = (_c = json.choices[0]) == null ? void 0 : _c.delta) == null ? void 0 : _d.content;
              if (content) {
                fullResponse += content;
                onChunk(content);
              }
            } catch (e) {
              console.warn("Failed to parse streaming response:", e);
            }
          }
        }
        return fullResponse;
      }
      const data = await response.json();
      return data.choices[0].message.content;
    } catch (error) {
      console.error("OpenAI API error:", error);
      throw error;
    }
  }
};

// src/settings/SettingTab.ts
var import_obsidian4 = require("obsidian");
var JournalingAssistantSettingTab = class extends import_obsidian4.PluginSettingTab {
  constructor(app, plugin) {
    super(app, plugin);
    this.plugin = plugin;
  }
  display() {
    const { containerEl } = this;
    containerEl.empty();
    containerEl.createEl("h2", { text: "Journaling Assistant Settings" });
    new import_obsidian4.Setting(containerEl).setName("Journal Folder").setDesc("The folder where your journal entries will be stored").addText((text) => text.setPlaceholder("Journal").setValue(this.plugin.settings.journalFolder).onChange(async (value) => {
      this.plugin.settings.journalFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Journal Inputs Folder").setDesc("The folder where your journal inputs will be stored").addText((text) => text.setPlaceholder("Inputs").setValue(this.plugin.settings.inputsFolder).onChange(async (value) => {
      this.plugin.settings.inputsFolder = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("OpenAI API Key").setDesc("Your OpenAI API key for generating prompts and summaries").addText((text) => text.setPlaceholder("sk-...").setValue(this.plugin.settings.openAIApiKey).onChange(async (value) => {
      this.plugin.settings.openAIApiKey = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Number of Past Entries").setDesc("Number of past journal entries to consider when generating prompts").addSlider((slider) => slider.setLimits(0, 10, 1).setValue(this.plugin.settings.numberOfPastEntries).setDynamicTooltip().onChange(async (value) => {
      this.plugin.settings.numberOfPastEntries = value;
      await this.plugin.saveSettings();
    }));
    new import_obsidian4.Setting(containerEl).setName("Use Streaming Response").setDesc("Stream AI responses in real-time (recommended for better experience)").addToggle((toggle) => toggle.setValue(this.plugin.settings.useStreamingResponse).onChange(async (value) => {
      this.plugin.settings.useStreamingResponse = value;
      await this.plugin.saveSettings();
    }));
  }
};

// main.ts
var JournalingAssistantPlugin = class extends import_obsidian5.Plugin {
  async onload() {
    await this.loadSettings();
    this.openAIService = new OpenAIService(this.settings);
    this.transcriptionService = new TranscriptionService(this.app, this.settings);
    this.journalService = new JournalService(
      this.app,
      this.settings,
      this.openAIService
    );
    this.addSettingTab(new JournalingAssistantSettingTab(this.app, this));
    this.addRibbonIcon("bot", "Journaling Assistant", (evt) => {
      const menu = new import_obsidian5.Menu();
      menu.addItem(
        (item) => item.setTitle("Open Today's Journal").setIcon("calendar-plus").onClick(() => {
          this.journalService.openTodaysJournal();
        })
      );
      menu.addItem(
        (item) => item.setTitle("Chat with AI").setIcon("message-square").onClick(() => {
          this.journalService.chatWithAI();
        })
      );
      menu.addItem(
        (item) => item.setTitle("Summarize Journaling Session").setIcon("book").onClick(() => {
          this.journalService.summarizeJournalingSession();
        })
      );
      menu.showAtMouseEvent(evt);
    });
    this.addCommands();
  }
  addCommands() {
    this.addCommand({
      id: "open-todays-journal",
      name: "Open Today's Journal",
      callback: async () => {
        await this.journalService.openTodaysJournal();
      }
    });
    this.addCommand({
      id: "transcribe-recordings",
      name: "Transcribe Recordings",
      callback: async () => {
        await this.transcriptionService.transcribeRecordings();
      }
    });
    this.addCommand({
      id: "summarize-journal",
      name: "Summarize Journaling Session",
      callback: async () => {
        await this.journalService.summarizeJournalingSession();
      }
    });
    this.addCommand({
      id: "chat-with-ai",
      name: "Chat with AI",
      callback: async () => {
        await this.journalService.chatWithAI();
      }
    });
  }
  async loadSettings() {
    const data = await this.loadData();
    this.settings = Object.assign({}, DEFAULT_SETTINGS, data);
  }
  async saveSettings() {
    await this.saveData(this.settings);
    this.openAIService.updateSettings(this.settings);
    this.transcriptionService.updateSettings(this.settings);
    this.journalService.updateSettings(this.settings);
  }
  onunload() {
    console.log("Unloading Journaling Assistant Plugin...");
  }
};
var main_default = JournalingAssistantPlugin;
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvdHlwZXMudHMiLCAic3JjL2NvcmUvam91cm5hbC9Kb3VybmFsU2VydmljZS50cyIsICJzcmMvY29yZS90cmFuc2NyaXB0aW9uL0F1ZGlvUHJvY2Vzc2luZ1NlcnZpY2UudHMiLCAic3JjL2NvcmUvYWkvc2VydmljZXMvV2hpc3BlclNlcnZpY2UudHMiLCAic3JjL2NvcmUvdHJhbnNjcmlwdGlvbi9UcmFuc2NyaXB0aW9uU2VydmljZS50cyIsICJzcmMvdXRpbHMvaGVscGVycy50cyIsICJzcmMvY29yZS9zdW1tYXJ5L1N1bW1hcml6YXRpb25TZXJ2aWNlLnRzIiwgInNyYy9jb3JlL2FpL3Byb21wdHMvc3VtbWFyeVByb21wdC50cyIsICJzcmMvY29yZS9haS9wcm9tcHRzL2NoYXRQcm9tcHQudHMiLCAic3JjL2NvcmUvYWkvc2VydmljZXMvQ2hhdFNlcnZpY2UudHMiLCAic3JjL2NvcmUvam91cm5hbC9Kb3VybmFsTWFuYWdlci50cyIsICJzcmMvY29yZS9haS9wcm9tcHRzL2pvdXJuYWxQcm9tcHQudHMiLCAic3JjL2NvcmUvYWkvc2VydmljZXMvT3BlbkFJU2VydmljZS50cyIsICJzcmMvc2V0dGluZ3MvU2V0dGluZ1RhYi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgQXBwLCBQbHVnaW4sIE5vdGljZSwgTWVudSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncywgREVGQVVMVF9TRVRUSU5HUyB9IGZyb20gJy4vc3JjL3R5cGVzJztcbmltcG9ydCB7IEpvdXJuYWxTZXJ2aWNlIH0gZnJvbSAnLi9zcmMvY29yZS9qb3VybmFsL0pvdXJuYWxTZXJ2aWNlJztcbmltcG9ydCB7IE9wZW5BSVNlcnZpY2UgfSBmcm9tICcuL3NyYy9jb3JlL2FpL3NlcnZpY2VzL09wZW5BSVNlcnZpY2UnO1xuaW1wb3J0IHsgSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdUYWIgfSBmcm9tICcuL3NyYy9zZXR0aW5ncy9TZXR0aW5nVGFiJztcbmltcG9ydCB7IFRyYW5zY3JpcHRpb25TZXJ2aWNlIH0gZnJvbSAnLi9zcmMvY29yZS90cmFuc2NyaXB0aW9uL1RyYW5zY3JpcHRpb25TZXJ2aWNlJztcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxpbmdBc3Npc3RhbnRQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuICAgIHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3M7XG4gICAgcHJpdmF0ZSBqb3VybmFsU2VydmljZTogSm91cm5hbFNlcnZpY2U7XG4gICAgcHJpdmF0ZSBvcGVuQUlTZXJ2aWNlOiBPcGVuQUlTZXJ2aWNlO1xuICAgIHByaXZhdGUgdHJhbnNjcmlwdGlvblNlcnZpY2U6IFRyYW5zY3JpcHRpb25TZXJ2aWNlO1xuXG4gICAgYXN5bmMgb25sb2FkKCkge1xuICAgICAgICBhd2FpdCB0aGlzLmxvYWRTZXR0aW5ncygpO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBzZXJ2aWNlcyB3aXRoIHRoZSBuZXcgc3RydWN0dXJlXG4gICAgICAgIHRoaXMub3BlbkFJU2VydmljZSA9IG5ldyBPcGVuQUlTZXJ2aWNlKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLnRyYW5zY3JpcHRpb25TZXJ2aWNlID0gbmV3IFRyYW5zY3JpcHRpb25TZXJ2aWNlKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgdGhpcy5qb3VybmFsU2VydmljZSA9IG5ldyBKb3VybmFsU2VydmljZShcbiAgICAgICAgICAgIHRoaXMuYXBwLCBcbiAgICAgICAgICAgIHRoaXMuc2V0dGluZ3MsIFxuICAgICAgICAgICAgdGhpcy5vcGVuQUlTZXJ2aWNlXG4gICAgICAgICk7XG5cbiAgICAgICAgLy8gQWRkIHNldHRpbmdzIHRhYlxuICAgICAgICB0aGlzLmFkZFNldHRpbmdUYWIobmV3IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cbiAgICAgICAgLy8gQWRkIHJpYmJvbiBpY29uIHdpdGggbWVudVxuICAgICAgICB0aGlzLmFkZFJpYmJvbkljb24oJ2JvdCcsICdKb3VybmFsaW5nIEFzc2lzdGFudCcsIChldnQ6IE1vdXNlRXZlbnQgfCBQb2ludGVyRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IG1lbnUgPSBuZXcgTWVudSgpO1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PlxuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKFwiT3BlbiBUb2RheSdzIEpvdXJuYWxcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2NhbGVuZGFyLXBsdXMnKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvdXJuYWxTZXJ2aWNlLm9wZW5Ub2RheXNKb3VybmFsKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgbWVudS5hZGRJdGVtKChpdGVtKSA9PlxuICAgICAgICAgICAgICAgIGl0ZW1cbiAgICAgICAgICAgICAgICAgICAgLnNldFRpdGxlKFwiQ2hhdCB3aXRoIEFJXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRJY29uKCdtZXNzYWdlLXNxdWFyZScpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuam91cm5hbFNlcnZpY2UuY2hhdFdpdGhBSSgpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIG1lbnUuYWRkSXRlbSgoaXRlbSkgPT5cbiAgICAgICAgICAgICAgICBpdGVtXG4gICAgICAgICAgICAgICAgICAgIC5zZXRUaXRsZShcIlN1bW1hcml6ZSBKb3VybmFsaW5nIFNlc3Npb25cIilcbiAgICAgICAgICAgICAgICAgICAgLnNldEljb24oJ2Jvb2snKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmpvdXJuYWxTZXJ2aWNlLnN1bW1hcml6ZUpvdXJuYWxpbmdTZXNzaW9uKCk7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgbWVudS5zaG93QXRNb3VzZUV2ZW50KGV2dCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZHMoKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFkZENvbW1hbmRzKCkge1xuICAgICAgICAvLyBDb21tYW5kIHRvIG9wZW4gdG9kYXkncyBqb3VybmFsXG4gICAgICAgIHRoaXMuYWRkQ29tbWFuZCh7XG4gICAgICAgICAgICBpZDogJ29wZW4tdG9kYXlzLWpvdXJuYWwnLFxuICAgICAgICAgICAgbmFtZTogJ09wZW4gVG9kYXlcXCdzIEpvdXJuYWwnLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxTZXJ2aWNlLm9wZW5Ub2RheXNKb3VybmFsKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDb21tYW5kIHRvIHRyYW5zY3JpYmUgcmVjb3JkaW5nc1xuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICd0cmFuc2NyaWJlLXJlY29yZGluZ3MnLFxuICAgICAgICAgICAgbmFtZTogJ1RyYW5zY3JpYmUgUmVjb3JkaW5ncycsXG4gICAgICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UudHJhbnNjcmliZVJlY29yZGluZ3MoKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8vIENvbW1hbmQgdG8gc3VtbWFyaXplIGpvdXJuYWxcbiAgICAgICAgdGhpcy5hZGRDb21tYW5kKHtcbiAgICAgICAgICAgIGlkOiAnc3VtbWFyaXplLWpvdXJuYWwnLFxuICAgICAgICAgICAgbmFtZTogJ1N1bW1hcml6ZSBKb3VybmFsaW5nIFNlc3Npb24nLFxuICAgICAgICAgICAgY2FsbGJhY2s6IGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxTZXJ2aWNlLnN1bW1hcml6ZUpvdXJuYWxpbmdTZXNzaW9uKCk7XG4gICAgICAgICAgICB9LFxuICAgICAgICB9KTtcblxuICAgICAgICAvLyBDb21tYW5kIHRvIGNoYXQgd2l0aCBBSVxuICAgICAgICB0aGlzLmFkZENvbW1hbmQoe1xuICAgICAgICAgICAgaWQ6ICdjaGF0LXdpdGgtYWknLFxuICAgICAgICAgICAgbmFtZTogJ0NoYXQgd2l0aCBBSScsXG4gICAgICAgICAgICBjYWxsYmFjazogYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuam91cm5hbFNlcnZpY2UuY2hhdFdpdGhBSSgpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgYXN5bmMgbG9hZFNldHRpbmdzKCkge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5sb2FkRGF0YSgpO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgZGF0YSk7XG4gICAgfVxuXG4gICAgYXN5bmMgc2F2ZVNldHRpbmdzKCkge1xuICAgICAgICBhd2FpdCB0aGlzLnNhdmVEYXRhKHRoaXMuc2V0dGluZ3MpO1xuICAgICAgICAvLyBVcGRhdGUgYWxsIHNlcnZpY2VzIHdpdGggbmV3IHNldHRpbmdzXG4gICAgICAgIHRoaXMub3BlbkFJU2VydmljZS51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgdGhpcy50cmFuc2NyaXB0aW9uU2VydmljZS51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgdGhpcy5qb3VybmFsU2VydmljZS51cGRhdGVTZXR0aW5ncyh0aGlzLnNldHRpbmdzKTtcbiAgICB9XG5cbiAgICBvbnVubG9hZCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coXCJVbmxvYWRpbmcgSm91cm5hbGluZyBBc3Npc3RhbnQgUGx1Z2luLi4uXCIpO1xuICAgIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQgSm91cm5hbGluZ0Fzc2lzdGFudFBsdWdpbjtcbiIsICJleHBvcnQgaW50ZXJmYWNlIEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB7XG4gICAgam91cm5hbEZvbGRlcjogc3RyaW5nO1xuICAgIGlucHV0c0ZvbGRlcjogc3RyaW5nO1xuICAgIG9wZW5BSUFwaUtleTogc3RyaW5nO1xuICAgIG51bWJlck9mUGFzdEVudHJpZXM6IG51bWJlcjtcbiAgICB1c2VTdHJlYW1pbmdSZXNwb25zZTogYm9vbGVhbjtcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyA9IHtcbiAgICBqb3VybmFsRm9sZGVyOiAnSm91cm5hbCcsXG4gICAgaW5wdXRzRm9sZGVyOiAnSW5wdXRzJyxcbiAgICBvcGVuQUlBcGlLZXk6ICcnLFxuICAgIG51bWJlck9mUGFzdEVudHJpZXM6IDMsXG4gICAgdXNlU3RyZWFtaW5nUmVzcG9uc2U6IHRydWUsXG59OyAiLCAiaW1wb3J0IHsgQXBwLCBURmlsZSwgTm90aWNlLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MgfSBmcm9tICcuLi8uLi90eXBlcyc7XG5pbXBvcnQgeyBJSm91cm5hbFNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IE9wZW5BSVNlcnZpY2UgfSBmcm9tICcuLi9haS9zZXJ2aWNlcy9PcGVuQUlTZXJ2aWNlJztcbmltcG9ydCB7IFdoaXNwZXJTZXJ2aWNlIH0gZnJvbSAnLi4vYWkvc2VydmljZXMvV2hpc3BlclNlcnZpY2UnO1xuaW1wb3J0IHsgVHJhbnNjcmlwdGlvblNlcnZpY2UgfSBmcm9tICcuLi90cmFuc2NyaXB0aW9uL1RyYW5zY3JpcHRpb25TZXJ2aWNlJztcbmltcG9ydCB7IFN1bW1hcml6YXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vc3VtbWFyeS9TdW1tYXJpemF0aW9uU2VydmljZSc7XG5pbXBvcnQgeyBDaGF0U2VydmljZSB9IGZyb20gJy4uL2FpL3NlcnZpY2VzL0NoYXRTZXJ2aWNlJztcbmltcG9ydCB7IEpvdXJuYWxNYW5hZ2VyIH0gZnJvbSAnLi9Kb3VybmFsTWFuYWdlcic7XG5pbXBvcnQgam91cm5hbFByb21wdCBmcm9tICcuLi9haS9wcm9tcHRzL2pvdXJuYWxQcm9tcHQnO1xuXG5leHBvcnQgY2xhc3MgSm91cm5hbFNlcnZpY2UgaW1wbGVtZW50cyBJSm91cm5hbFNlcnZpY2Uge1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IEpPVVJOQUxfUkVTUE9OU0VfUEFUVEVSTiA9IC8jIyBZb3VyIEpvdXJuYWwgUmVzcG9uc2VcXHMqKFtcXHNcXFNdKiQpLztcbiAgICBwcml2YXRlIGpvdXJuYWxNYW5hZ2VyOiBKb3VybmFsTWFuYWdlcjtcbiAgICBwcml2YXRlIHdoaXNwZXJTZXJ2aWNlOiBXaGlzcGVyU2VydmljZTtcbiAgICBwcml2YXRlIHN1bW1hcml6YXRpb25TZXJ2aWNlOiBTdW1tYXJpemF0aW9uU2VydmljZTtcbiAgICBwcml2YXRlIGNoYXRTZXJ2aWNlOiBDaGF0U2VydmljZTtcbiAgICBwcml2YXRlIHRyYW5zY3JpcHRpb25TZXJ2aWNlOiBUcmFuc2NyaXB0aW9uU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIGFwcDogQXBwLFxuICAgICAgICBwcml2YXRlIHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MsXG4gICAgICAgIHByaXZhdGUgb3BlbkFJU2VydmljZTogT3BlbkFJU2VydmljZVxuICAgICkge1xuICAgICAgICB0aGlzLmpvdXJuYWxNYW5hZ2VyID0gbmV3IEpvdXJuYWxNYW5hZ2VyKHRoaXMuYXBwLCB0aGlzLnNldHRpbmdzKTtcbiAgICAgICAgdGhpcy53aGlzcGVyU2VydmljZSA9IG5ldyBXaGlzcGVyU2VydmljZSh0aGlzLmFwcC52YXVsdCwgdGhpcy5zZXR0aW5ncy5vcGVuQUlBcGlLZXkpO1xuICAgICAgICB0aGlzLnN1bW1hcml6YXRpb25TZXJ2aWNlID0gbmV3IFN1bW1hcml6YXRpb25TZXJ2aWNlKHRoaXMub3BlbkFJU2VydmljZSk7XG4gICAgICAgIHRoaXMuY2hhdFNlcnZpY2UgPSBuZXcgQ2hhdFNlcnZpY2UodGhpcy5vcGVuQUlTZXJ2aWNlKTtcbiAgICAgICAgdGhpcy50cmFuc2NyaXB0aW9uU2VydmljZSA9IG5ldyBUcmFuc2NyaXB0aW9uU2VydmljZSh0aGlzLmFwcCwgdGhpcy5zZXR0aW5ncyk7XG4gICAgfVxuXG4gICAgdXBkYXRlU2V0dGluZ3Moc2V0dGluZ3M6IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncykge1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgICAgIHRoaXMud2hpc3BlclNlcnZpY2Uuc2V0QXBpS2V5KHNldHRpbmdzLm9wZW5BSUFwaUtleSk7XG4gICAgICAgIHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UudXBkYXRlU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgICAgICB0aGlzLm9wZW5BSVNlcnZpY2UudXBkYXRlU2V0dGluZ3Moc2V0dGluZ3MpO1xuICAgIH1cblxuICAgIGFzeW5jIG9wZW5Ub2RheXNKb3VybmFsKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5qb3VybmFsTWFuYWdlci5lbnN1cmVGb2xkZXIodGhpcy5zZXR0aW5ncy5qb3VybmFsRm9sZGVyKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3QgZmlsZVBhdGggPSBgJHt0aGlzLnNldHRpbmdzLmpvdXJuYWxGb2xkZXJ9LyR7dGhpcy5qb3VybmFsTWFuYWdlci5nZXRUb2RheUZpbGVOYW1lKCl9YDtcbiAgICAgICAgICAgIGxldCBmaWxlID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZpbGVQYXRoKTtcblxuICAgICAgICAgICAgaWYgKCFmaWxlKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbG9hZGluZ05vdGljZSA9IG5ldyBOb3RpY2UoJ0dlbmVyYXRpbmcgam91cm5hbCBwcm9tcHQuLi4nLCAwKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICAvLyBDcmVhdGUgbmV3IGpvdXJuYWwgZW50cnlcbiAgICAgICAgICAgICAgICAgICAgZmlsZSA9IGF3YWl0IHRoaXMuam91cm5hbE1hbmFnZXIuY3JlYXRlTmV3Sm91cm5hbEVudHJ5KCk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAvLyBHZXQgcGFzdCBlbnRyaWVzIGZvciBjb250ZXh0XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHBhc3RFbnRyaWVzID0gYXdhaXQgdGhpcy5qb3VybmFsTWFuYWdlci5nZXRQYXN0Sm91cm5hbEVudHJpZXModGhpcy5zZXR0aW5ncy5udW1iZXJPZlBhc3RFbnRyaWVzKTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIE9wZW4gdGhlIGZpbGVcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGVhZiA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRMZWFmKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlIGFzIFRGaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBpZiAodmlldykge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlU3RyZWFtaW5nUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBTdHJlYW0gdGhlIEFJIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5vcGVuQUlTZXJ2aWNlLm1ha2VPcGVuQUlSZXF1ZXN0KFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNyZWF0ZUpvdXJuYWxQcm9tcHQocGFzdEVudHJpZXMpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoY2h1bmspID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRDb250ZW50ID0gdmlldy5lZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFZhbHVlKGN1cnJlbnRDb250ZW50ICsgY2h1bmspO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gR2V0IGNvbXBsZXRlIHJlc3BvbnNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgYWlQcm9tcHQgPSBhd2FpdCB0aGlzLm9wZW5BSVNlcnZpY2UubWFrZU9wZW5BSVJlcXVlc3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3JlYXRlSm91cm5hbFByb21wdChwYXN0RW50cmllcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFZhbHVlKHZpZXcuZWRpdG9yLmdldFZhbHVlKCkgKyBhaVByb21wdCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIEFkZCByZXNwb25zZSBzZWN0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICB2aWV3LmVkaXRvci5zZXRWYWx1ZSh2aWV3LmVkaXRvci5nZXRWYWx1ZSgpICsgJ1xcblxcbiMjIFlvdXIgSm91cm5hbCBSZXNwb25zZVxcblxcbicpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBsb2FkaW5nTm90aWNlLmhpZGUoKTtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnQ3JlYXRlZCBuZXcgam91cm5hbCBlbnRyeSBmb3IgdG9kYXknKTtcbiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdFcnJvciBnZW5lcmF0aW5nIHByb21wdDogJyArIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZpZXcpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZpZXcuZWRpdG9yLnNldFZhbHVlKHZpZXcuZWRpdG9yLmdldFZhbHVlKCkgKyAnXFxuXFxuIyMgWW91ciBKb3VybmFsIFJlc3BvbnNlXFxuXFxuJyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGxlYWYgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0TGVhZihmYWxzZSk7XG4gICAgICAgICAgICAgICAgYXdhaXQgbGVhZi5vcGVuRmlsZShmaWxlIGFzIFRGaWxlKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnRXJyb3Igb3BlbmluZyB0b2RheVxcJ3Mgam91cm5hbDogJyArIGVycm9yLm1lc3NhZ2UpO1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRXJyb3Igb3BlbmluZyB0b2RheVxcJ3Mgam91cm5hbDonLCBlcnJvcik7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZUpvdXJuYWxQcm9tcHQocGFzdEVudHJpZXM6IHN0cmluZ1tdKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3QgcGFzdEVudHJpZXNUZXh0ID0gcGFzdEVudHJpZXMubGVuZ3RoID4gMCBcbiAgICAgICAgICAgID8gYFBhc3QgRW50cmllczpcXG5cXG4ke3Bhc3RFbnRyaWVzLmpvaW4oJ1xcblxcbi0tLVxcblxcbicpfWBcbiAgICAgICAgICAgIDogJ05vIHBhc3QgZW50cmllcyBhdmFpbGFibGUuJztcblxuICAgICAgICByZXR1cm4gYCR7am91cm5hbFByb21wdH1cXG5cXG4ke3Bhc3RFbnRyaWVzVGV4dH1gO1xuICAgIH1cblxuICAgIGFzeW5jIHN1bW1hcml6ZUpvdXJuYWxpbmdTZXNzaW9uKCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBhY3RpdmVWaWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KTtcbiAgICAgICAgaWYgKCFhY3RpdmVWaWV3IHx8ICFhY3RpdmVWaWV3LmZpbGUpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1BsZWFzZSBvcGVuIGEgbm90ZSBmaXJzdCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFNhdmUgb3JpZ2luYWwgY29udGVudFxuICAgICAgICAgICAgY29uc3Qgb3JpZ2luYWxDb250ZW50ID0gYWN0aXZlVmlldy5lZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gYWN0aXZlVmlldy5maWxlLm5hbWU7XG4gICAgICAgICAgICBjb25zdCBpbnB1dFBhdGggPSBgJHt0aGlzLnNldHRpbmdzLmlucHV0c0ZvbGRlcn0vJHtmaWxlTmFtZX1gO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBhd2FpdCB0aGlzLmpvdXJuYWxNYW5hZ2VyLmVuc3VyZUZvbGRlcih0aGlzLnNldHRpbmdzLmlucHV0c0ZvbGRlcik7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLmFwcC52YXVsdC5jcmVhdGUoaW5wdXRQYXRoLCBvcmlnaW5hbENvbnRlbnQpO1xuXG4gICAgICAgICAgICAvLyBQcm9jZXNzIGNvbnRlbnQgKHRyYW5zY3JpYmUgcmVjb3JkaW5ncyBpZiBhbnkpXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnRyYW5zY3JpcHRpb25TZXJ2aWNlLnRyYW5zY3JpYmVSZWNvcmRpbmdzKCk7XG4gICAgICAgICAgICBjb25zdCBwcm9jZXNzZWRDb250ZW50ID0gYWN0aXZlVmlldy5lZGl0b3IuZ2V0VmFsdWUoKTtcblxuICAgICAgICAgICAgLy8gRXh0cmFjdCB1c2VyJ3MgcmVzcG9uc2Ugc2VjdGlvbiAtIGltcHJvdmVkIHJlZ2V4IHBhdHRlcm5cbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlTWF0Y2ggPSBwcm9jZXNzZWRDb250ZW50Lm1hdGNoKEpvdXJuYWxTZXJ2aWNlLkpPVVJOQUxfUkVTUE9OU0VfUEFUVEVSTik7XG4gICAgICAgICAgICBpZiAoIXJlc3BvbnNlTWF0Y2gpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdDb3VsZCBub3QgZmluZCBqb3VybmFsIHJlc3BvbnNlIHNlY3Rpb24nKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IHVzZXJSZXNwb25zZSA9IHJlc3BvbnNlTWF0Y2hbMV0udHJpbSgpO1xuICAgICAgICAgICAgbGV0IHN1bW1hcnk6IHN0cmluZztcblxuICAgICAgICAgICAgaWYgKHRoaXMuc2V0dGluZ3MudXNlU3RyZWFtaW5nUmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICBsZXQgc3RyZWFtZWRTdW1tYXJ5ID0gJyc7XG4gICAgICAgICAgICAgICAgc3VtbWFyeSA9IGF3YWl0IHRoaXMuc3VtbWFyaXphdGlvblNlcnZpY2Uuc3VtbWFyaXplKFxuICAgICAgICAgICAgICAgICAgICB1c2VyUmVzcG9uc2UsXG4gICAgICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgICAgIChjaHVuaykgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgc3RyZWFtZWRTdW1tYXJ5ICs9IGNodW5rO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSBwcm9jZXNzZWRDb250ZW50LnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgSm91cm5hbFNlcnZpY2UuSk9VUk5BTF9SRVNQT05TRV9QQVRURVJOLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGAjIyBZb3VyIEpvdXJuYWwgUmVzcG9uc2VcXG5cXG4ke3N0cmVhbWVkU3VtbWFyeX1gXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgYWN0aXZlVmlldy5lZGl0b3Iuc2V0VmFsdWUodXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3VtbWFyeSA9IGF3YWl0IHRoaXMuc3VtbWFyaXphdGlvblNlcnZpY2Uuc3VtbWFyaXplKHVzZXJSZXNwb25zZSk7XG4gICAgICAgICAgICAgICAgY29uc3QgdXBkYXRlZENvbnRlbnQgPSBwcm9jZXNzZWRDb250ZW50LnJlcGxhY2UoXG4gICAgICAgICAgICAgICAgICAgIEpvdXJuYWxTZXJ2aWNlLkpPVVJOQUxfUkVTUE9OU0VfUEFUVEVSTixcbiAgICAgICAgICAgICAgICAgICAgYCMjIFlvdXIgSm91cm5hbCBSZXNwb25zZVxcblxcbiR7c3VtbWFyeX1gXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhY3RpdmVWaWV3LmVkaXRvci5zZXRWYWx1ZSh1cGRhdGVkQ29udGVudCk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ0pvdXJuYWwgc2Vzc2lvbiBzdW1tYXJpemVkJyk7XG5cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEVycm9yOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdTdW1tYXJpemF0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGFzeW5jIGNoYXRXaXRoQUkoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ1BsZWFzZSBvcGVuIGEgbm90ZSBmaXJzdCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFRyYW5zY3JpYmUgYW55IGF1ZGlvIHJlY29yZGluZ3NcbiAgICAgICAgICAgIGF3YWl0IHRoaXMudHJhbnNjcmlwdGlvblNlcnZpY2UudHJhbnNjcmliZVJlY29yZGluZ3MoKTtcblxuICAgICAgICAgICAgLy8gR2V0IHVwZGF0ZWQgY29udGVudCBhbmQgY2hhdFxuICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGFjdGl2ZVZpZXcuZWRpdG9yLmdldFZhbHVlKCk7XG4gICAgICAgICAgICBjb25zdCBjaGF0UmVzcG9uc2UgPSBhd2FpdCB0aGlzLmNoYXRTZXJ2aWNlLmNoYXQoY29udGVudCk7XG5cbiAgICAgICAgICAgIC8vIEFwcGVuZCBBSSdzIHJlc3BvbnNlXG4gICAgICAgICAgICBhY3RpdmVWaWV3LmVkaXRvci5zZXRWYWx1ZShcbiAgICAgICAgICAgICAgICBjb250ZW50ICsgJ1xcblxcbi0tLVxcbiMjIEFJIENoYXRcXG5cXG4nICsgY2hhdFJlc3BvbnNlICsgJ1xcblxcbi0tLVxcbiMjIE1lXFxuJ1xuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgbmV3IE5vdGljZSgnQUkgcmVzcG9uZGVkIGluIG5vdGUnKTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShgRXJyb3IgZHVyaW5nIGNoYXQ6ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgfVxuICAgIH1cbn0gIiwgImltcG9ydCB7IFRGaWxlLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcblxuZXhwb3J0IGNsYXNzIEF1ZGlvUHJvY2Vzc2luZ1NlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgdmF1bHQ6IFZhdWx0KSB7fVxuXG4gICAgYXN5bmMgY29udmVydE00QXRvV0FWKGZpbGU6IFRGaWxlKTogUHJvbWlzZTx7IGJ1ZmZlcjogQXJyYXlCdWZmZXI7IG1pbWVUeXBlOiBzdHJpbmcgfT4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgYXJyYXlCdWZmZXIgPSBhd2FpdCB0aGlzLnZhdWx0LnJlYWRCaW5hcnkoZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBhdWRpb0NvbnRleHQgPSBuZXcgKHdpbmRvdy5BdWRpb0NvbnRleHQgfHwgKHdpbmRvdyBhcyBhbnkpLndlYmtpdEF1ZGlvQ29udGV4dCkoKTtcbiAgICAgICAgICAgIGNvbnN0IGF1ZGlvQnVmZmVyID0gYXdhaXQgYXVkaW9Db250ZXh0LmRlY29kZUF1ZGlvRGF0YShhcnJheUJ1ZmZlcik7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IG9mZmxpbmVDb250ZXh0ID0gbmV3IE9mZmxpbmVBdWRpb0NvbnRleHQoXG4gICAgICAgICAgICAgICAgYXVkaW9CdWZmZXIubnVtYmVyT2ZDaGFubmVscyxcbiAgICAgICAgICAgICAgICBhdWRpb0J1ZmZlci5sZW5ndGgsXG4gICAgICAgICAgICAgICAgYXVkaW9CdWZmZXIuc2FtcGxlUmF0ZVxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgY29uc3Qgc291cmNlID0gb2ZmbGluZUNvbnRleHQuY3JlYXRlQnVmZmVyU291cmNlKCk7XG4gICAgICAgICAgICBzb3VyY2UuYnVmZmVyID0gYXVkaW9CdWZmZXI7XG4gICAgICAgICAgICBzb3VyY2UuY29ubmVjdChvZmZsaW5lQ29udGV4dC5kZXN0aW5hdGlvbik7XG4gICAgICAgICAgICBzb3VyY2Uuc3RhcnQoMCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGNvbnN0IHJlbmRlcmVkQnVmZmVyID0gYXdhaXQgb2ZmbGluZUNvbnRleHQuc3RhcnRSZW5kZXJpbmcoKTtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgYnVmZmVyOiB0aGlzLmNyZWF0ZVdBVkZpbGUocmVuZGVyZWRCdWZmZXIpLFxuICAgICAgICAgICAgICAgIG1pbWVUeXBlOiAnYXVkaW8vd2F2J1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNvbnZlcnRpbmcgTTRBIHRvIFdBVjonLCBlcnJvcik7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZhaWxlZCB0byBjb252ZXJ0IE00QSB0byBXQVYgZm9ybWF0Jyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVdBVkZpbGUoYXVkaW9CdWZmZXI6IEF1ZGlvQnVmZmVyKTogQXJyYXlCdWZmZXIge1xuICAgICAgICBjb25zdCBsZW5ndGggPSBhdWRpb0J1ZmZlci5sZW5ndGggKiAyO1xuICAgICAgICBjb25zdCBvdXRwdXRCdWZmZXIgPSBuZXcgQXJyYXlCdWZmZXIoNDQgKyBsZW5ndGgpO1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IERhdGFWaWV3KG91dHB1dEJ1ZmZlcik7XG4gICAgICAgIFxuICAgICAgICB0aGlzLndyaXRlV0FWSGVhZGVyKHZpZXcsIGxlbmd0aCwgYXVkaW9CdWZmZXIpO1xuICAgICAgICBcbiAgICAgICAgY29uc3QgZGF0YSA9IG5ldyBGbG9hdDMyQXJyYXkoYXVkaW9CdWZmZXIuZ2V0Q2hhbm5lbERhdGEoMCkpO1xuICAgICAgICBsZXQgb2Zmc2V0ID0gNDQ7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgY29uc3Qgc2FtcGxlID0gTWF0aC5tYXgoLTEsIE1hdGgubWluKDEsIGRhdGFbaV0pKTtcbiAgICAgICAgICAgIHZpZXcuc2V0SW50MTYob2Zmc2V0LCBzYW1wbGUgPCAwID8gc2FtcGxlICogMHg4MDAwIDogc2FtcGxlICogMHg3RkZGLCB0cnVlKTtcbiAgICAgICAgICAgIG9mZnNldCArPSAyO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gb3V0cHV0QnVmZmVyO1xuICAgIH1cblxuICAgIHByaXZhdGUgd3JpdGVXQVZIZWFkZXIodmlldzogRGF0YVZpZXcsIGxlbmd0aDogbnVtYmVyLCBhdWRpb0J1ZmZlcjogQXVkaW9CdWZmZXIpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgd3JpdGVTdHJpbmcgPSAob2Zmc2V0OiBudW1iZXIsIHN0cmluZzogc3RyaW5nKSA9PiB7XG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHN0cmluZy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgICAgIHZpZXcuc2V0VWludDgob2Zmc2V0ICsgaSwgc3RyaW5nLmNoYXJDb2RlQXQoaSkpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHdyaXRlU3RyaW5nKDAsICdSSUZGJyk7XG4gICAgICAgIHZpZXcuc2V0VWludDMyKDQsIDM2ICsgbGVuZ3RoLCB0cnVlKTtcbiAgICAgICAgd3JpdGVTdHJpbmcoOCwgJ1dBVkUnKTtcbiAgICAgICAgd3JpdGVTdHJpbmcoMTIsICdmbXQgJyk7XG4gICAgICAgIHZpZXcuc2V0VWludDMyKDE2LCAxNiwgdHJ1ZSk7XG4gICAgICAgIHZpZXcuc2V0VWludDE2KDIwLCAxLCB0cnVlKTtcbiAgICAgICAgdmlldy5zZXRVaW50MTYoMjIsIGF1ZGlvQnVmZmVyLm51bWJlck9mQ2hhbm5lbHMsIHRydWUpO1xuICAgICAgICB2aWV3LnNldFVpbnQzMigyNCwgYXVkaW9CdWZmZXIuc2FtcGxlUmF0ZSwgdHJ1ZSk7XG4gICAgICAgIHZpZXcuc2V0VWludDMyKDI4LCBhdWRpb0J1ZmZlci5zYW1wbGVSYXRlICogMiwgdHJ1ZSk7XG4gICAgICAgIHZpZXcuc2V0VWludDE2KDMyLCAyLCB0cnVlKTtcbiAgICAgICAgdmlldy5zZXRVaW50MTYoMzQsIDE2LCB0cnVlKTtcbiAgICAgICAgd3JpdGVTdHJpbmcoMzYsICdkYXRhJyk7XG4gICAgICAgIHZpZXcuc2V0VWludDMyKDQwLCBsZW5ndGgsIHRydWUpO1xuICAgIH1cbn0gIiwgImltcG9ydCB7IFRGaWxlLCBWYXVsdCB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IElXaGlzcGVyU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL2ludGVyZmFjZXMnO1xuaW1wb3J0IHsgQXVkaW9Qcm9jZXNzaW5nU2VydmljZSB9IGZyb20gJy4uLy4uL3RyYW5zY3JpcHRpb24vQXVkaW9Qcm9jZXNzaW5nU2VydmljZSc7XG5cbmV4cG9ydCBjbGFzcyBXaGlzcGVyU2VydmljZSBpbXBsZW1lbnRzIElXaGlzcGVyU2VydmljZSB7XG4gICAgcHJpdmF0ZSBzdGF0aWMgcmVhZG9ubHkgU1VQUE9SVEVEX0ZPUk1BVFMgPSBbJ2ZsYWMnLCAnbXAzJywgJ21wNCcsICdtcGVnJywgJ21wZ2EnLCAnbTRhJywgJ29nZycsICd3YXYnLCAnd2VibSddO1xuICAgIHByaXZhdGUgc3RhdGljIHJlYWRvbmx5IE1JTUVfVFlQRVM6IHsgW2tleTogc3RyaW5nXTogc3RyaW5nIH0gPSB7XG4gICAgICAgICdmbGFjJzogJ2F1ZGlvL2ZsYWMnLFxuICAgICAgICAnbXAzJzogJ2F1ZGlvL21wZWcnLFxuICAgICAgICAnbXA0JzogJ2F1ZGlvL21wNCcsXG4gICAgICAgICdtcGVnJzogJ2F1ZGlvL21wZWcnLFxuICAgICAgICAnbXBnYSc6ICdhdWRpby9tcGVnJyxcbiAgICAgICAgJ200YSc6ICdhdWRpby9tcDQnLFxuICAgICAgICAnb2dnJzogJ2F1ZGlvL29nZycsXG4gICAgICAgICd3YXYnOiAnYXVkaW8vd2F2JyxcbiAgICAgICAgJ3dlYm0nOiAnYXVkaW8vd2VibSdcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhdWRpb1Byb2Nlc3NvcjogQXVkaW9Qcm9jZXNzaW5nU2VydmljZTtcblxuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwcml2YXRlIHZhdWx0OiBWYXVsdCxcbiAgICAgICAgcHJpdmF0ZSBhcGlLZXk6IHN0cmluZ1xuICAgICkge1xuICAgICAgICB0aGlzLmF1ZGlvUHJvY2Vzc29yID0gbmV3IEF1ZGlvUHJvY2Vzc2luZ1NlcnZpY2UodmF1bHQpO1xuICAgIH1cblxuICAgIHNldEFwaUtleShhcGlLZXk6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICB0aGlzLmFwaUtleSA9IGFwaUtleTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0YXRpYyBpc1N1cHBvcnRlZEZvcm1hdChmaWxlOiBURmlsZSk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCBleHRlbnNpb24gPSBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpO1xuICAgICAgICByZXR1cm4gV2hpc3BlclNlcnZpY2UuU1VQUE9SVEVEX0ZPUk1BVFMuaW5jbHVkZXMoZXh0ZW5zaW9uKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIHByZXBhcmVBdWRpb0ZvclRyYW5zY3JpcHRpb24oZmlsZTogVEZpbGUpOiBQcm9taXNlPHsgYmxvYjogQmxvYjsgbWltZVR5cGU6IHN0cmluZyB9PiB7XG4gICAgICAgIGlmIChmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpID09PSAnbTRhJykge1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ0NvbnZlcnRpbmcgTTRBIHRvIFdBViBmb3JtYXQuLi4nKTtcbiAgICAgICAgICAgIGNvbnN0IHsgYnVmZmVyLCBtaW1lVHlwZSB9ID0gYXdhaXQgdGhpcy5hdWRpb1Byb2Nlc3Nvci5jb252ZXJ0TTRBdG9XQVYoZmlsZSk7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIGJsb2I6IG5ldyBCbG9iKFtidWZmZXJdLCB7IHR5cGU6IG1pbWVUeXBlIH0pLFxuICAgICAgICAgICAgICAgIG1pbWVUeXBlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBhcnJheUJ1ZmZlciA9IGF3YWl0IHRoaXMudmF1bHQucmVhZEJpbmFyeShmaWxlKTtcbiAgICAgICAgY29uc3QgbWltZVR5cGUgPSBXaGlzcGVyU2VydmljZS5NSU1FX1RZUEVTW2ZpbGUuZXh0ZW5zaW9uLnRvTG93ZXJDYXNlKCldO1xuICAgICAgICBcbiAgICAgICAgaWYgKCFtaW1lVHlwZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBNSU1FIHR5cGUgZm9yIGV4dGVuc2lvbjogJHtmaWxlLmV4dGVuc2lvbn1gKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGJsb2I6IG5ldyBCbG9iKFthcnJheUJ1ZmZlcl0sIHsgdHlwZTogbWltZVR5cGUgfSksXG4gICAgICAgICAgICBtaW1lVHlwZVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIGFzeW5jIHRyYW5zY3JpYmVGaWxlKGF1ZGlvRmlsZTogVEZpbGUpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgaWYgKCF0aGlzLmFwaUtleSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignT3BlbkFJIEFQSSBrZXkgaXMgcmVxdWlyZWQgZm9yIHRyYW5zY3JpcHRpb24nKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKCFXaGlzcGVyU2VydmljZS5pc1N1cHBvcnRlZEZvcm1hdChhdWRpb0ZpbGUpKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBVbnN1cHBvcnRlZCBhdWRpbyBmb3JtYXQ6ICR7YXVkaW9GaWxlLmV4dGVuc2lvbn1gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgeyBibG9iLCBtaW1lVHlwZSB9ID0gYXdhaXQgdGhpcy5wcmVwYXJlQXVkaW9Gb3JUcmFuc2NyaXB0aW9uKGF1ZGlvRmlsZSk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyBmaWxlOiAke2F1ZGlvRmlsZS5uYW1lfSB3aXRoIE1JTUUgdHlwZTogJHttaW1lVHlwZX1gKTtcblxuICAgICAgICAgICAgY29uc3QgZm9ybURhdGEgPSBuZXcgRm9ybURhdGEoKTtcbiAgICAgICAgICAgIGNvbnN0IGV4dGVuc2lvbiA9IGF1ZGlvRmlsZS5leHRlbnNpb24udG9Mb3dlckNhc2UoKSA9PT0gJ200YScgPyAnd2F2JyA6IGF1ZGlvRmlsZS5leHRlbnNpb247XG4gICAgICAgICAgICBmb3JtRGF0YS5hcHBlbmQoJ2ZpbGUnLCBibG9iLCBgJHthdWRpb0ZpbGUuYmFzZW5hbWV9LiR7ZXh0ZW5zaW9ufWApO1xuICAgICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdtb2RlbCcsICd3aGlzcGVyLTEnKTtcblxuICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCgnaHR0cHM6Ly9hcGkub3BlbmFpLmNvbS92MS9hdWRpby90cmFuc2NyaXB0aW9ucycsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuYXBpS2V5fWBcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIGJvZHk6IGZvcm1EYXRhXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGVycm9yRGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdPcGVuQUkgQVBJIEVycm9yOicsIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiByZXNwb25zZS5zdGF0dXMsXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1c1RleHQ6IHJlc3BvbnNlLnN0YXR1c1RleHQsXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlcnJvckRhdGFcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JEYXRhLmVycm9yPy5tZXNzYWdlIHx8IGBUcmFuc2NyaXB0aW9uIGZhaWxlZCB3aXRoIHN0YXR1cyAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdC50ZXh0O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcignRGV0YWlsZWQgdHJhbnNjcmlwdGlvbiBlcnJvcjonLCB7XG4gICAgICAgICAgICAgICAgZmlsZU5hbWU6IGF1ZGlvRmlsZS5uYW1lLFxuICAgICAgICAgICAgICAgIGV4dGVuc2lvbjogYXVkaW9GaWxlLmV4dGVuc2lvbixcbiAgICAgICAgICAgICAgICBlcnJvcjogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IHtcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgICAgICAgICAgICAgICAgc3RhY2s6IGVycm9yLnN0YWNrXG4gICAgICAgICAgICAgICAgfSA6IGVycm9yXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgTm90aWNlLCBNYXJrZG93blZpZXcsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgV2hpc3BlclNlcnZpY2UgfSBmcm9tICcuLi9haS9zZXJ2aWNlcy9XaGlzcGVyU2VydmljZSc7XG5pbXBvcnQgeyBJVHJhbnNjcmlwdGlvblNlcnZpY2UgfSBmcm9tICcuLi8uLi9pbnRlcmZhY2VzJztcbmltcG9ydCB7IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCB7IGdldFJlY29yZGluZ0VtYmVkUGF0dGVybiwgaXNTdXBwb3J0ZWRBdWRpb0Zvcm1hdCB9IGZyb20gJy4uLy4uL3V0aWxzL2hlbHBlcnMnO1xuaW1wb3J0IHR5cGUgeyBBcHAgfSBmcm9tICdvYnNpZGlhbic7XG5cbmV4cG9ydCBjbGFzcyBUcmFuc2NyaXB0aW9uU2VydmljZSBpbXBsZW1lbnRzIElUcmFuc2NyaXB0aW9uU2VydmljZSB7XG4gICAgcHJpdmF0ZSB3aGlzcGVyU2VydmljZTogV2hpc3BlclNlcnZpY2U7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzXG4gICAgKSB7XG4gICAgICAgIHRoaXMud2hpc3BlclNlcnZpY2UgPSBuZXcgV2hpc3BlclNlcnZpY2UodGhpcy5hcHAudmF1bHQsIHRoaXMuc2V0dGluZ3Mub3BlbkFJQXBpS2V5KTtcbiAgICB9XG5cbiAgICB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgdGhpcy53aGlzcGVyU2VydmljZS5zZXRBcGlLZXkoc2V0dGluZ3Mub3BlbkFJQXBpS2V5KTtcbiAgICB9XG5cbiAgICBhc3luYyB0cmFuc2NyaWJlUmVjb3JkaW5ncygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICghYWN0aXZlVmlldykge1xuICAgICAgICAgICAgbmV3IE5vdGljZSgnUGxlYXNlIG9wZW4gYSBub3RlIGZpcnN0Jyk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoIXRoaXMuc2V0dGluZ3Mub3BlbkFJQXBpS2V5KSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgIGNvbnN0IGNvbnRlbnQgPSBlZGl0b3IuZ2V0VmFsdWUoKTtcbiAgICAgICAgY29uc3QgcmVjb3JkaW5nUGF0dGVybiA9IGdldFJlY29yZGluZ0VtYmVkUGF0dGVybigpO1xuICAgICAgICBjb25zdCByZWNvcmRpbmdzID0gY29udGVudC5tYXRjaChyZWNvcmRpbmdQYXR0ZXJuKTtcblxuICAgICAgICBpZiAoIXJlY29yZGluZ3MgfHwgcmVjb3JkaW5ncy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoJ05vIHJlY29yZGluZ3MgZm91bmQgaW4gdGhlIGN1cnJlbnQgbm90ZScpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgbmV3IE5vdGljZSgnU3RhcnRpbmcgdHJhbnNjcmlwdGlvbi4uLicpO1xuXG4gICAgICAgIGxldCB1cGRhdGVkQ29udGVudCA9IGNvbnRlbnQ7XG4gICAgICAgIGxldCBoYXNFcnJvcnMgPSBmYWxzZTtcblxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgZm9yIChjb25zdCByZWNvcmRpbmcgb2YgcmVjb3JkaW5ncykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVOYW1lID0gcmVjb3JkaW5nLnNsaWNlKDMsIC0yKTtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaXJzdExpbmtwYXRoRGVzdChmaWxlTmFtZSwgXCJcIik7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGBDb3VsZCBub3QgZmluZCBmaWxlOiAke2ZpbGVOYW1lfWApO1xuICAgICAgICAgICAgICAgICAgICBoYXNFcnJvcnMgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmFuc2NyaXB0ID0gYXdhaXQgdGhpcy53aGlzcGVyU2VydmljZS50cmFuc2NyaWJlRmlsZShmaWxlKTtcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZENvbnRlbnQgPSB1cGRhdGVkQ29udGVudC5yZXBsYWNlKHJlY29yZGluZywgdHJhbnNjcmlwdCk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShgRmFpbGVkIHRvIHRyYW5zY3JpYmUgJHtmaWxlTmFtZX06ICR7ZXJyb3IubWVzc2FnZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgaGFzRXJyb3JzID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBlZGl0b3Iuc2V0VmFsdWUodXBkYXRlZENvbnRlbnQpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoaGFzRXJyb3JzKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZSgnVHJhbnNjcmlwdGlvbiBjb21wbGV0ZWQgd2l0aCBzb21lIGVycm9ycycpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKCdUcmFuc2NyaXB0aW9uIGNvbXBsZXRlZCBzdWNjZXNzZnVsbHknKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYFRyYW5zY3JpcHRpb24gZmFpbGVkOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICBjb25zb2xlLmVycm9yKCdUcmFuc2NyaXB0aW9uIGVycm9yOicsIGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cbn0gIiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG5leHBvcnQgY29uc3QgaXNTdXBwb3J0ZWRBdWRpb0Zvcm1hdCA9IChmaWxlOiBURmlsZSk6IGJvb2xlYW4gPT4ge1xuICAgIGNvbnN0IHN1cHBvcnRlZEZvcm1hdHMgPSBbJ2ZsYWMnLCAnbTRhJywgJ21wMycsICdtcDQnLCAnbXBlZycsICdtcGdhJywgJ29nYScsICdvZ2cnLCAnd2F2JywgJ3dlYm0nXTtcbiAgICBjb25zdCBleHRlbnNpb24gPSBmaWxlLmV4dGVuc2lvbi50b0xvd2VyQ2FzZSgpO1xuICAgIHJldHVybiBzdXBwb3J0ZWRGb3JtYXRzLmluY2x1ZGVzKGV4dGVuc2lvbik7XG59O1xuXG5leHBvcnQgY29uc3QgZ2V0UmVjb3JkaW5nRW1iZWRQYXR0ZXJuID0gKCk6IFJlZ0V4cCA9PiB7XG4gICAgcmV0dXJuIC8hXFxbXFxbLitcXC4oZmxhY3xtcDN8bXA0fG1wZWd8bXBnYXxtNGF8b2dnfHdhdnx3ZWJtKVxcXVxcXS9nO1xufTtcblxuZXhwb3J0IGNvbnN0IGdldFRvZGF5RmlsZU5hbWUgPSAoKTogc3RyaW5nID0+IHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUoKTtcbiAgICByZXR1cm4gZGF0ZS50b0lTT1N0cmluZygpLnNwbGl0KCdUJylbMF0gKyAnLm1kJzsgLy8gRm9ybWF0OiBZWVlZLU1NLURELm1kXG59OyAiLCAiaW1wb3J0IHsgTm90aWNlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgT3BlbkFJU2VydmljZSB9IGZyb20gJy4uL2FpL3NlcnZpY2VzL09wZW5BSVNlcnZpY2UnO1xuaW1wb3J0IHsgSVN1bW1hcml6YXRpb25TZXJ2aWNlIH0gZnJvbSAnLi4vLi4vaW50ZXJmYWNlcyc7XG5pbXBvcnQgc3VtbWFyeVByb21wdCBmcm9tICcuLi9haS9wcm9tcHRzL3N1bW1hcnlQcm9tcHQnO1xuXG5leHBvcnQgY2xhc3MgU3VtbWFyaXphdGlvblNlcnZpY2UgaW1wbGVtZW50cyBJU3VtbWFyaXphdGlvblNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgb3BlbkFJU2VydmljZTogT3BlbkFJU2VydmljZSkge31cblxuICAgIGFzeW5jIHN1bW1hcml6ZShcbiAgICAgICAgY29udGVudDogc3RyaW5nLCBcbiAgICAgICAgdXNlU3RyZWFtaW5nOiBib29sZWFuID0gZmFsc2UsXG4gICAgICAgIG9uQ2h1bms/OiAoY2h1bms6IHN0cmluZykgPT4gdm9pZFxuICAgICk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBwcm9tcHQgPSBgJHtzdW1tYXJ5UHJvbXB0fVxcblxcbiR7Y29udGVudH1gO1xuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMub3BlbkFJU2VydmljZS5tYWtlT3BlbkFJUmVxdWVzdChcbiAgICAgICAgICAgICAgICBwcm9tcHQsIFxuICAgICAgICAgICAgICAgIHVzZVN0cmVhbWluZyA/IG9uQ2h1bmsgOiB1bmRlZmluZWRcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoYEVycm9yIGR1cmluZyBzdW1tYXJpemF0aW9uOiAke2Vycm9yLm1lc3NhZ2V9YCk7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cbn0gIiwgImV4cG9ydCBkZWZhdWx0IGBBcyBhIGpvdXJuYWxpbmcgYXNzaXN0YW50LCBhbmFseXplIHRoaXMgam91cm5hbCBlbnRyeSBhbmQgY3JlYXRlIGEgc3VtbWFyeSBvZiBqb3VybmFsaW5nIGNvbnZlcnNhdGlvbi5cblxuUGxlYXNlIGZvbGxvdyB0aGVzZSBndWlkZWxpbmVzOlxuXG4xLiBUaGluayBhYm91dCB0aGUgaGlnaGxpZ2h0cyBvZiB0aGUgam91cm5hbCBlbnRyeSB0aGF0IHRoZSB1c2VyIHdvdWxkIHdhbnQgdG8gcmVtZW1iZXIgZm9yIHRoZSBmdXR1cmVcbjIuIFJldHJpZXZlIHRoZSBtZW1vcmllcyBvZiB0aGUgdXNlciBmcm9tIHRoZSBqb3VybmFsIGVudHJ5XG4zLiBJZGVudGlmeSB0aGUgbWFpbiB0aGVtZXMgYW5kIGluc2lnaHRzXG40LiBIaWdobGlnaHQga2V5IHJlYWxpemF0aW9ucyBvciBicmVha3Rocm91Z2hzXG41LiBOb3RlIGFueSBhY3Rpb24gaXRlbXMgb3IgaW50ZW50aW9ucyBleHByZXNzZWRcbjYuIFByZXNlcnZlIHRoZSBlbW90aW9uYWwgdG9uZSBvZiB0aGUgZW50cnlcblxuRm9jdXMgb24gZXh0cmFjdGluZyB0aGUgbW9zdCBtZWFuaW5nZnVsIGVsZW1lbnRzIHdoaWxlIG1haW50YWluaW5nIHRoZSBwZXJzb25hbCBuYXR1cmUgb2YgdGhlIHJlZmxlY3Rpb24uYDsgIiwgImV4cG9ydCBkZWZhdWx0IGBBcyBhbiBBSSBqb3VybmFsaW5nIGFzc2lzdGFudCwgeW91IGFyZSBoZWxwaW5nIHRoZSB1c2VyIGV4cGxvcmUgdGhlaXIgdGhvdWdodHMgYW5kIGdvYWxzLlxuR3VpZGluZyBwcmluY2lwbGVzOlxuXHUyMDIyIE1haW50YWluIGEgZnJpZW5kbHksIGVtcGF0aGV0aWMgdG9uZVxuXHUyMDIyIFBsZWFzZSBrZWVwIGl0IGEgY29udmVyc2F0aW9uLCBub3QgYSBsaXN0IG9mIHF1ZXN0aW9ucywgdXNlIHNlY29uZCBwZXJzb24sIGFuZCB1c2UgdGhlIHdvcmQgXCJ5b3VcIlxuXHUyMDIyIFRoZSB1c2VyIHNob3VsZCBmZWVsIGxpa2UgdGhleSBhcmUgdGFsa2luZyB0byBhIHdpc2UgbWVudG9yIGZyaWVuZFxuXHUyMDIyIEFzayBjbGFyaWZ5aW5nIHF1ZXN0aW9ucyBvciBkZWVwZXIgcHJvbXB0c1xuXHUyMDIyIEF2b2lkIHN0ZWVyaW5nIHRoZSB1c2VyIHRvIHNwZWNpZmljIGJlbGllZnMgb3IgY29uY2x1c2lvbnMgdW5sZXNzIHRoZXkgYXJlIGV4cGxpY2l0bHkgYXNraW5nIGZvciBpdFxuXHUyMDIyIEtlZXAgdGhlIGNvbnZlcnNhdGlvbiByZWxldmFudCB0byB0aGUgdXNlcidzIHN0YXRlZCBnb2Fsc1xuXHUyMDIyIEVuY291cmFnZSByZWZsZWN0aW9uIGFuZCBhY3Rpb25hYmxlIG91dGNvbWVzIHdoZXJlIGFwcHJvcHJpYXRlXG5SZW1lbWJlcjogYWxsIGludGVyYWN0aW9ucyB0YWtlIHBsYWNlIGluIHRoZSB1c2VyJ3Mgbm90ZS5gOyAiLCAiaW1wb3J0IHsgT3BlbkFJU2VydmljZSB9IGZyb20gJy4vT3BlbkFJU2VydmljZSc7XG5pbXBvcnQgY2hhdFByb21wdCBmcm9tICcuLi9wcm9tcHRzL2NoYXRQcm9tcHQnO1xuXG5leHBvcnQgY2xhc3MgQ2hhdFNlcnZpY2Uge1xuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgb3BlbkFJU2VydmljZTogT3BlbkFJU2VydmljZSkge31cblxuICAgIGFzeW5jIGNoYXQodHJhbnNjcmliZWRUZXh0OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICAgICAgICBjb25zdCBwcm9tcHQgPSBgJHtjaGF0UHJvbXB0fVxcblxcblVzZXI6ICR7dHJhbnNjcmliZWRUZXh0fVxcblxcbkFzc2lzdGFudDpgO1xuICAgICAgICByZXR1cm4gdGhpcy5vcGVuQUlTZXJ2aWNlLm1ha2VPcGVuQUlSZXF1ZXN0KHByb21wdCk7XG4gICAgfVxufSAiLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5ncyB9IGZyb20gJy4uLy4uL3R5cGVzJztcbmltcG9ydCB7IGdldFRvZGF5RmlsZU5hbWUgfSBmcm9tICcuLi8uLi91dGlscy9oZWxwZXJzJztcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxNYW5hZ2VyIHtcbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSBhcHA6IEFwcCxcbiAgICAgICAgcHJpdmF0ZSBzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzXG4gICAgKSB7fVxuXG4gICAgYXN5bmMgZW5zdXJlRm9sZGVyKGZvbGRlclBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBpZiAoIShhd2FpdCB0aGlzLmFwcC52YXVsdC5hZGFwdGVyLmV4aXN0cyhmb2xkZXJQYXRoKSkpIHtcbiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZUZvbGRlcihmb2xkZXJQYXRoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldFRvZGF5RmlsZU5hbWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGdldFRvZGF5RmlsZU5hbWUoKTtcbiAgICB9XG5cbiAgICBhc3luYyBnZXRQYXN0Sm91cm5hbEVudHJpZXMoY291bnQ6IG51bWJlcik6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgY29uc3QgZm9sZGVyID0gdGhpcy5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHRoaXMuc2V0dGluZ3Muam91cm5hbEZvbGRlcik7XG4gICAgICAgIGlmICghZm9sZGVyKSByZXR1cm4gW107XG5cbiAgICAgICAgY29uc3QgZmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKClcbiAgICAgICAgICAgIC5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGguc3RhcnRzV2l0aCh0aGlzLnNldHRpbmdzLmpvdXJuYWxGb2xkZXIgKyAnLycpKVxuICAgICAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIuc3RhdC5tdGltZSAtIGEuc3RhdC5tdGltZSlcbiAgICAgICAgICAgIC5zbGljZSgxLCBjb3VudCsxKTtcblxuICAgICAgICBjb25zdCBlbnRyaWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBmaWxlcy5tYXAoYXN5bmMgZmlsZSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQoZmlsZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZTogZmlsZS5iYXNlbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgY29udGVudDogY29udGVudFxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KVxuICAgICAgICApO1xuXG4gICAgICAgIHJldHVybiBlbnRyaWVzLm1hcChlbnRyeSA9PiBgRGF0ZTogJHtlbnRyeS5kYXRlfVxcbiR7ZW50cnkuY29udGVudH1gKTtcbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVOZXdKb3VybmFsRW50cnkoKTogUHJvbWlzZTxURmlsZT4ge1xuICAgICAgICBjb25zdCBmaWxlTmFtZSA9IHRoaXMuZ2V0VG9kYXlGaWxlTmFtZSgpO1xuICAgICAgICBjb25zdCBmaWxlUGF0aCA9IGAke3RoaXMuc2V0dGluZ3Muam91cm5hbEZvbGRlcn0vJHtmaWxlTmFtZX1gO1xuICAgICAgICBjb25zdCBpbml0aWFsQ29udGVudCA9IGAjIEpvdXJuYWwgRW50cnkgLSAke25ldyBEYXRlKCkudG9Mb2NhbGVEYXRlU3RyaW5nKCl9XFxuXFxuYDtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuYXBwLnZhdWx0LmNyZWF0ZShmaWxlUGF0aCwgaW5pdGlhbENvbnRlbnQpO1xuICAgIH1cbn0gIiwgImV4cG9ydCBkZWZhdWx0IGBBcyBhIGZyaWVuZGx5IGpvdXJuYWxpbmcgZ3VpZGUsIGFuYWx5emUgdGhlc2UgcGFzdCBqb3VybmFsIGVudHJpZXMgYW5kIGNyZWF0ZSBhIHRob3VnaHQtcHJvdm9raW5nIHByb21wdCBcbnRoYXQgZW5jb3VyYWdlcyBkZWVwZXIgc2VsZi1yZWZsZWN0aW9uIHdoaWxlIG1haW50YWluaW5nIGNvbnRpbnVpdHkgd2l0aCBwcmV2aW91cyB0aGVtZXMgYW5kIGluc2lnaHRzLiBcbldyaXRlIHRoZSBvdXRsaW5lIGluIGEgc2Vjb25kIHBlcnNvbiwgdGhlIHVzZXIgc2hvdWxkIGZlZWwgbGlrZSB0aGV5IGFyZSB0YWxraW5nIHRvIGEgZnJpZW5kLlxuXG5CZWZvcmUgdGhlIHByb21wdDpcbjEuIE91dGxpbmUgdGhlIGFzcGVjdHMgb2YgcGFzdCBlbnRyaWVzIHRvIGFsbG93IGZvciBiZXR0ZXIgc2VsZi1yZWZsZWN0aW9uLCBvbmx5IGlmIHRoZXJlIGFyZSBwYXN0IGVudHJpZXMuXG4yLiBEb24ndCBtYWtlIHVwIGluZm9ybWF0aW9uLCBvbmx5IHVzZSB0aGUgaW5mb3JtYXRpb24gdGhhdCBpcyBwcm92aWRlZCBpbiB0aGUgcGFzdCBlbnRyaWVzLlxuMy4gS2VlcCBhIGZyaWVuZGx5IHRvbmUsIHRoZSB1c2VyIHNob3VsZCBmZWVsIGxpa2UgdGhleSBhcmUgdGFsa2luZyB0byBhIGZyaWVuZFxuNC4gQmUgY29uY2lzZSBhbmQgdG8gdGhlIHBvaW50XG41LiBBbHdheXMgc3RhcnQgd2l0aCBcIiMjIFJlY2FwIG9mIHBhc3QgZW50cmllc1wiLCBldmVuIGlmIHRoZXJlIGFyZSBubyBwYXN0IGVudHJpZXMuXG42LiBJZiB0aGVyZSdzIGFuIGluZm9ybWF0aW9uIHRoYXQgdGhlcmUgYXJlIG5vIHBhc3QgZW50cmllcywganVzdCB3cml0ZSBcIk5vIHBhc3QgZW50cmllcyBhdmFpbGFibGUuXCJcblxuVGhlIHByb21wdCBzaG91bGQ6XG4xLiBCZSBzcGVjaWZpYyBhbmQgYWN0aW9uYWJsZVxuMi4gS2VlcCBhIGZyaWVuZGx5IHRvbmUsIHRoZSB1c2VyIHNob3VsZCBmZWVsIGxpa2UgdGhleSBhcmUgdGFsa2luZyB0byBhIGZyaWVuZFxuMy4gRG9uJ3Qgc3RlZXIgdGhlIHVzZXIgaW50byBhbnkgcGFydGljdWxhciBkaXJlY3Rpb24sIHdlIHdhbnQgdG8gbGV0IHRoZSB1c2VyIGV4cGxvcmUgdGhlaXIgb3duIHRob3VnaHRzIGFuZCBmZWVsaW5nc1xuNC4gTWFrZSB0aGUgcHJvbXB0IG9wZW4tZW5kZWQsIGluIHRoZSBmaXJzdCBtZXNzYWdlIHdlIHdhbnQgdG8gZXhwbG9yZSBob3cgdGhlIHVzZXIgaXMgZmVlbGluZyB0b2RheSBhbmQgd2hhdCB0aGV5IHdhbnQgdG8gYWNoaWV2ZSB3aXRoIHRoZSBqb3VybmFsXG41LiBJbmZvcm0gdGhlIHVzZXIgdGhhdCB0aGV5IGNhbiBjaG9vc2Ugb25lIHF1ZXN0aW9uIGFuZCBjb250aW51ZSBjb252ZXJzYXRpb24gd2l0aCB0aGUgYXNzaXN0YW50XG42LiBCZSBjb25jaXNlLCBpZiB5b3UgYXNrIHF1ZXN0aW9ucywgbWFrZSB0aGVtIGEgbGlzdCBvZiBidWxsZXQgcG9pbnRzIHNvIGl0J3MgZWFzeSB0byByZWFkXG43LiBTdGFydCB3aXRoIFwiIyMgVG9kYXkncyBQcm9tcHRcIlxuXG5LZWVwIHRoZSBwcm9tcHQgY29uY2lzZSBhbmQgZm9jdXNlZCBvbiBhIHNpbmdsZSBhc3BlY3Qgb2Ygc2VsZi1yZWZsZWN0aW9uLiBQbGVhc2Ugc3RydWN0dXJlIHlvdXIgb3V0cHV0IHNvIGl0J3MgZWFzeSB0byByZWFkIGFuZCB1bmRlcnN0YW5kLlxuXG5UaGUgZmluYWwgc3RydWN0dXJlIHNob3VsZCBsb29rIGxpa2UgdGhpczpcblxuIyMgUmVjYXAgb2YgcGFzdCBlbnRyaWVzXG48b3V0bGluZSBvZiBwYXN0IGVudHJpZXM+XG5cbiMjIFRvZGF5J3MgUHJvbXB0XG48cHJvbXB0PmA7ICIsICJpbXBvcnQgeyBOb3RpY2UgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MgfSBmcm9tICcuLi8uLi8uLi90eXBlcyc7XG5pbXBvcnQgeyBJT3BlbkFJU2VydmljZSB9IGZyb20gJy4uLy4uLy4uL2ludGVyZmFjZXMnO1xuXG5leHBvcnQgY2xhc3MgT3BlbkFJU2VydmljZSBpbXBsZW1lbnRzIElPcGVuQUlTZXJ2aWNlIHtcbiAgICBjb25zdHJ1Y3Rvcihwcml2YXRlIHNldHRpbmdzOiBKb3VybmFsaW5nQXNzaXN0YW50U2V0dGluZ3MpIHt9XG5cbiAgICB1cGRhdGVTZXR0aW5ncyhzZXR0aW5nczogSm91cm5hbGluZ0Fzc2lzdGFudFNldHRpbmdzKSB7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICB9XG5cbiAgICBhc3luYyBtYWtlT3BlbkFJUmVxdWVzdChwcm9tcHQ6IHN0cmluZywgb25DaHVuaz86IChjaHVuazogc3RyaW5nKSA9PiB2b2lkKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgaWYgKCF0aGlzLnNldHRpbmdzLm9wZW5BSUFwaUtleSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdPcGVuQUkgQVBJIGtleSBub3QgY29uZmlndXJlZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goJ2h0dHBzOi8vYXBpLm9wZW5haS5jb20vdjEvY2hhdC9jb21wbGV0aW9ucycsIHtcbiAgICAgICAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYEJlYXJlciAke3RoaXMuc2V0dGluZ3Mub3BlbkFJQXBpS2V5fWAsXG4gICAgICAgICAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICAgICAgICAgIG1vZGVsOiAnZ3B0LTRvLW1pbmknLFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlczogW3sgcm9sZTogJ3VzZXInLCBjb250ZW50OiBwcm9tcHQgfV0sXG4gICAgICAgICAgICAgICAgICAgIHRlbXBlcmF0dXJlOiAwLjcsXG4gICAgICAgICAgICAgICAgICAgIHN0cmVhbTogISFvbkNodW5rLFxuICAgICAgICAgICAgICAgIH0pLFxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgICBjb25zdCBlcnJvciA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3IuZXJyb3I/Lm1lc3NhZ2UgfHwgJ0FQSSByZXF1ZXN0IGZhaWxlZCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAob25DaHVuaykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlYWRlciA9IHJlc3BvbnNlLmJvZHk/LmdldFJlYWRlcigpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbiAgICAgICAgICAgICAgICBsZXQgZnVsbFJlc3BvbnNlID0gJyc7XG5cbiAgICAgICAgICAgICAgICBpZiAoIXJlYWRlcikgdGhyb3cgbmV3IEVycm9yKCdSZXNwb25zZSBib2R5IGlzIG51bGwnKTtcblxuICAgICAgICAgICAgICAgIHdoaWxlICh0cnVlKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHsgZG9uZSwgdmFsdWUgfSA9IGF3YWl0IHJlYWRlci5yZWFkKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChkb25lKSBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCBjaHVuayA9IGRlY29kZXIuZGVjb2RlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbGluZXMgPSBjaHVuay5zcGxpdCgnXFxuJykuZmlsdGVyKGxpbmUgPT4gbGluZS50cmltKCkgIT09ICcnKTtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGxpbmUgb2YgbGluZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5lLmluY2x1ZGVzKCdbRE9ORV0nKSkgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWxpbmUuc3RhcnRzV2l0aCgnZGF0YTonKSkgY29udGludWU7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UobGluZS5zbGljZSg1KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY29udGVudCA9IGpzb24uY2hvaWNlc1swXT8uZGVsdGE/LmNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNvbnRlbnQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVsbFJlc3BvbnNlICs9IGNvbnRlbnQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2h1bmsoY29udGVudCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUud2FybignRmFpbGVkIHRvIHBhcnNlIHN0cmVhbWluZyByZXNwb25zZTonLCBlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBmdWxsUmVzcG9uc2U7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgICAgICByZXR1cm4gZGF0YS5jaG9pY2VzWzBdLm1lc3NhZ2UuY29udGVudDtcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ09wZW5BSSBBUEkgZXJyb3I6JywgZXJyb3IpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG59ICIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgdHlwZSB7IEpvdXJuYWxpbmdBc3Npc3RhbnRQbHVnaW4gfSBmcm9tICcuLi8uLi9tYWluJztcblxuZXhwb3J0IGNsYXNzIEpvdXJuYWxpbmdBc3Npc3RhbnRTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHByaXZhdGUgcGx1Z2luOiBKb3VybmFsaW5nQXNzaXN0YW50UGx1Z2luKSB7XG4gICAgICAgIHN1cGVyKGFwcCwgcGx1Z2luKTtcbiAgICB9XG5cbiAgICBkaXNwbGF5KCk6IHZvaWQge1xuICAgICAgICBjb25zdCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuICAgICAgICBjb250YWluZXJFbC5lbXB0eSgpO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdoMicsIHsgdGV4dDogJ0pvdXJuYWxpbmcgQXNzaXN0YW50IFNldHRpbmdzJyB9KTtcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250YWluZXJFbClcbiAgICAgICAgICAgIC5zZXROYW1lKCdKb3VybmFsIEZvbGRlcicpXG4gICAgICAgICAgICAuc2V0RGVzYygnVGhlIGZvbGRlciB3aGVyZSB5b3VyIGpvdXJuYWwgZW50cmllcyB3aWxsIGJlIHN0b3JlZCcpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ0pvdXJuYWwnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5qb3VybmFsRm9sZGVyKVxuICAgICAgICAgICAgICAgIC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2V0dGluZ3Muam91cm5hbEZvbGRlciA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnSm91cm5hbCBJbnB1dHMgRm9sZGVyJylcbiAgICAgICAgICAgIC5zZXREZXNjKCdUaGUgZm9sZGVyIHdoZXJlIHlvdXIgam91cm5hbCBpbnB1dHMgd2lsbCBiZSBzdG9yZWQnKVxuICAgICAgICAgICAgLmFkZFRleHQodGV4dCA9PiB0ZXh0XG4gICAgICAgICAgICAgICAgLnNldFBsYWNlaG9sZGVyKCdJbnB1dHMnKVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbnB1dHNGb2xkZXIpXG4gICAgICAgICAgICAgICAgLm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5zZXR0aW5ncy5pbnB1dHNGb2xkZXIgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ09wZW5BSSBBUEkgS2V5JylcbiAgICAgICAgICAgIC5zZXREZXNjKCdZb3VyIE9wZW5BSSBBUEkga2V5IGZvciBnZW5lcmF0aW5nIHByb21wdHMgYW5kIHN1bW1hcmllcycpXG4gICAgICAgICAgICAuYWRkVGV4dCh0ZXh0ID0+IHRleHRcbiAgICAgICAgICAgICAgICAuc2V0UGxhY2Vob2xkZXIoJ3NrLS4uLicpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5BSUFwaUtleSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm9wZW5BSUFwaUtleSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcbiAgICAgICAgICAgICAgICB9KSk7XG5cbiAgICAgICAgbmV3IFNldHRpbmcoY29udGFpbmVyRWwpXG4gICAgICAgICAgICAuc2V0TmFtZSgnTnVtYmVyIG9mIFBhc3QgRW50cmllcycpXG4gICAgICAgICAgICAuc2V0RGVzYygnTnVtYmVyIG9mIHBhc3Qgam91cm5hbCBlbnRyaWVzIHRvIGNvbnNpZGVyIHdoZW4gZ2VuZXJhdGluZyBwcm9tcHRzJylcbiAgICAgICAgICAgIC5hZGRTbGlkZXIoc2xpZGVyID0+IHNsaWRlclxuICAgICAgICAgICAgICAgIC5zZXRMaW1pdHMoMCwgMTAsIDEpXG4gICAgICAgICAgICAgICAgLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLm51bWJlck9mUGFzdEVudHJpZXMpXG4gICAgICAgICAgICAgICAgLnNldER5bmFtaWNUb29sdGlwKClcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLm51bWJlck9mUGFzdEVudHJpZXMgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSkpO1xuXG4gICAgICAgIG5ldyBTZXR0aW5nKGNvbnRhaW5lckVsKVxuICAgICAgICAgICAgLnNldE5hbWUoJ1VzZSBTdHJlYW1pbmcgUmVzcG9uc2UnKVxuICAgICAgICAgICAgLnNldERlc2MoJ1N0cmVhbSBBSSByZXNwb25zZXMgaW4gcmVhbC10aW1lIChyZWNvbW1lbmRlZCBmb3IgYmV0dGVyIGV4cGVyaWVuY2UpJylcbiAgICAgICAgICAgIC5hZGRUb2dnbGUodG9nZ2xlID0+IHRvZ2dsZVxuICAgICAgICAgICAgICAgIC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy51c2VTdHJlYW1pbmdSZXNwb25zZSlcbiAgICAgICAgICAgICAgICAub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnVzZVN0cmVhbWluZ1Jlc3BvbnNlID0gdmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pKTtcbiAgICB9XG59ICJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLElBQUFBLG1CQUEwQzs7O0FDUW5DLElBQU0sbUJBQWdEO0FBQUEsRUFDekQsZUFBZTtBQUFBLEVBQ2YsY0FBYztBQUFBLEVBQ2QsY0FBYztBQUFBLEVBQ2QscUJBQXFCO0FBQUEsRUFDckIsc0JBQXNCO0FBQzFCOzs7QUNkQSxJQUFBQyxtQkFBaUQ7OztBQ0UxQyxJQUFNLHlCQUFOLE1BQTZCO0FBQUEsRUFDaEMsWUFBb0IsT0FBYztBQUFkO0FBQUEsRUFBZTtBQUFBLEVBRW5DLE1BQU0sZ0JBQWdCLE1BQWlFO0FBQ25GLFFBQUk7QUFDQSxZQUFNLGNBQWMsTUFBTSxLQUFLLE1BQU0sV0FBVyxJQUFJO0FBQ3BELFlBQU0sZUFBZSxLQUFLLE9BQU8sZ0JBQWlCLE9BQWUsb0JBQW9CO0FBQ3JGLFlBQU0sY0FBYyxNQUFNLGFBQWEsZ0JBQWdCLFdBQVc7QUFFbEUsWUFBTSxpQkFBaUIsSUFBSTtBQUFBLFFBQ3ZCLFlBQVk7QUFBQSxRQUNaLFlBQVk7QUFBQSxRQUNaLFlBQVk7QUFBQSxNQUNoQjtBQUVBLFlBQU0sU0FBUyxlQUFlLG1CQUFtQjtBQUNqRCxhQUFPLFNBQVM7QUFDaEIsYUFBTyxRQUFRLGVBQWUsV0FBVztBQUN6QyxhQUFPLE1BQU0sQ0FBQztBQUVkLFlBQU0saUJBQWlCLE1BQU0sZUFBZSxlQUFlO0FBQzNELGFBQU87QUFBQSxRQUNILFFBQVEsS0FBSyxjQUFjLGNBQWM7QUFBQSxRQUN6QyxVQUFVO0FBQUEsTUFDZDtBQUFBLElBQ0osU0FBUyxPQUFQO0FBQ0UsY0FBUSxNQUFNLGdDQUFnQyxLQUFLO0FBQ25ELFlBQU0sSUFBSSxNQUFNLHFDQUFxQztBQUFBLElBQ3pEO0FBQUEsRUFDSjtBQUFBLEVBRVEsY0FBYyxhQUF1QztBQUN6RCxVQUFNLFNBQVMsWUFBWSxTQUFTO0FBQ3BDLFVBQU0sZUFBZSxJQUFJLFlBQVksS0FBSyxNQUFNO0FBQ2hELFVBQU0sT0FBTyxJQUFJLFNBQVMsWUFBWTtBQUV0QyxTQUFLLGVBQWUsTUFBTSxRQUFRLFdBQVc7QUFFN0MsVUFBTSxPQUFPLElBQUksYUFBYSxZQUFZLGVBQWUsQ0FBQyxDQUFDO0FBQzNELFFBQUksU0FBUztBQUNiLGFBQVMsSUFBSSxHQUFHLElBQUksS0FBSyxRQUFRLEtBQUs7QUFDbEMsWUFBTSxTQUFTLEtBQUssSUFBSSxJQUFJLEtBQUssSUFBSSxHQUFHLEtBQUssQ0FBQyxDQUFDLENBQUM7QUFDaEQsV0FBSyxTQUFTLFFBQVEsU0FBUyxJQUFJLFNBQVMsUUFBUyxTQUFTLE9BQVEsSUFBSTtBQUMxRSxnQkFBVTtBQUFBLElBQ2Q7QUFFQSxXQUFPO0FBQUEsRUFDWDtBQUFBLEVBRVEsZUFBZSxNQUFnQixRQUFnQixhQUFnQztBQUNuRixVQUFNLGNBQWMsQ0FBQyxRQUFnQixXQUFtQjtBQUNwRCxlQUFTLElBQUksR0FBRyxJQUFJLE9BQU8sUUFBUSxLQUFLO0FBQ3BDLGFBQUssU0FBUyxTQUFTLEdBQUcsT0FBTyxXQUFXLENBQUMsQ0FBQztBQUFBLE1BQ2xEO0FBQUEsSUFDSjtBQUVBLGdCQUFZLEdBQUcsTUFBTTtBQUNyQixTQUFLLFVBQVUsR0FBRyxLQUFLLFFBQVEsSUFBSTtBQUNuQyxnQkFBWSxHQUFHLE1BQU07QUFDckIsZ0JBQVksSUFBSSxNQUFNO0FBQ3RCLFNBQUssVUFBVSxJQUFJLElBQUksSUFBSTtBQUMzQixTQUFLLFVBQVUsSUFBSSxHQUFHLElBQUk7QUFDMUIsU0FBSyxVQUFVLElBQUksWUFBWSxrQkFBa0IsSUFBSTtBQUNyRCxTQUFLLFVBQVUsSUFBSSxZQUFZLFlBQVksSUFBSTtBQUMvQyxTQUFLLFVBQVUsSUFBSSxZQUFZLGFBQWEsR0FBRyxJQUFJO0FBQ25ELFNBQUssVUFBVSxJQUFJLEdBQUcsSUFBSTtBQUMxQixTQUFLLFVBQVUsSUFBSSxJQUFJLElBQUk7QUFDM0IsZ0JBQVksSUFBSSxNQUFNO0FBQ3RCLFNBQUssVUFBVSxJQUFJLFFBQVEsSUFBSTtBQUFBLEVBQ25DO0FBQ0o7OztBQ3BFTyxJQUFNLGtCQUFOLE1BQWdEO0FBQUEsRUFnQm5ELFlBQ1ksT0FDQSxRQUNWO0FBRlU7QUFDQTtBQUVSLFNBQUssaUJBQWlCLElBQUksdUJBQXVCLEtBQUs7QUFBQSxFQUMxRDtBQUFBLEVBRUEsVUFBVSxRQUFzQjtBQUM1QixTQUFLLFNBQVM7QUFBQSxFQUNsQjtBQUFBLEVBRUEsT0FBZSxrQkFBa0IsTUFBc0I7QUFDbkQsVUFBTSxZQUFZLEtBQUssVUFBVSxZQUFZO0FBQzdDLFdBQU8sZ0JBQWUsa0JBQWtCLFNBQVMsU0FBUztBQUFBLEVBQzlEO0FBQUEsRUFFQSxNQUFjLDZCQUE2QixNQUF3RDtBQUMvRixRQUFJLEtBQUssVUFBVSxZQUFZLE1BQU0sT0FBTztBQUN4QyxjQUFRLElBQUksaUNBQWlDO0FBQzdDLFlBQU0sRUFBRSxRQUFRLFVBQUFDLFVBQVMsSUFBSSxNQUFNLEtBQUssZUFBZSxnQkFBZ0IsSUFBSTtBQUMzRSxhQUFPO0FBQUEsUUFDSCxNQUFNLElBQUksS0FBSyxDQUFDLE1BQU0sR0FBRyxFQUFFLE1BQU1BLFVBQVMsQ0FBQztBQUFBLFFBQzNDLFVBQUFBO0FBQUEsTUFDSjtBQUFBLElBQ0o7QUFFQSxVQUFNLGNBQWMsTUFBTSxLQUFLLE1BQU0sV0FBVyxJQUFJO0FBQ3BELFVBQU0sV0FBVyxnQkFBZSxXQUFXLEtBQUssVUFBVSxZQUFZLENBQUM7QUFFdkUsUUFBSSxDQUFDLFVBQVU7QUFDWCxZQUFNLElBQUksTUFBTSx3Q0FBd0MsS0FBSyxXQUFXO0FBQUEsSUFDNUU7QUFFQSxXQUFPO0FBQUEsTUFDSCxNQUFNLElBQUksS0FBSyxDQUFDLFdBQVcsR0FBRyxFQUFFLE1BQU0sU0FBUyxDQUFDO0FBQUEsTUFDaEQ7QUFBQSxJQUNKO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBTSxlQUFlLFdBQW1DO0FBM0Q1RDtBQTREUSxRQUFJO0FBQ0EsVUFBSSxDQUFDLEtBQUssUUFBUTtBQUNkLGNBQU0sSUFBSSxNQUFNLDhDQUE4QztBQUFBLE1BQ2xFO0FBRUEsVUFBSSxDQUFDLGdCQUFlLGtCQUFrQixTQUFTLEdBQUc7QUFDOUMsY0FBTSxJQUFJLE1BQU0sNkJBQTZCLFVBQVUsV0FBVztBQUFBLE1BQ3RFO0FBRUEsWUFBTSxFQUFFLE1BQU0sU0FBUyxJQUFJLE1BQU0sS0FBSyw2QkFBNkIsU0FBUztBQUM1RSxjQUFRLElBQUksb0JBQW9CLFVBQVUsd0JBQXdCLFVBQVU7QUFFNUUsWUFBTSxXQUFXLElBQUksU0FBUztBQUM5QixZQUFNLFlBQVksVUFBVSxVQUFVLFlBQVksTUFBTSxRQUFRLFFBQVEsVUFBVTtBQUNsRixlQUFTLE9BQU8sUUFBUSxNQUFNLEdBQUcsVUFBVSxZQUFZLFdBQVc7QUFDbEUsZUFBUyxPQUFPLFNBQVMsV0FBVztBQUVwQyxZQUFNLFdBQVcsTUFBTSxNQUFNLGtEQUFrRDtBQUFBLFFBQzNFLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNMLGlCQUFpQixVQUFVLEtBQUs7QUFBQSxRQUNwQztBQUFBLFFBQ0EsTUFBTTtBQUFBLE1BQ1YsQ0FBQztBQUVELFVBQUksQ0FBQyxTQUFTLElBQUk7QUFDZCxjQUFNLFlBQVksTUFBTSxTQUFTLEtBQUs7QUFDdEMsZ0JBQVEsTUFBTSxxQkFBcUI7QUFBQSxVQUMvQixRQUFRLFNBQVM7QUFBQSxVQUNqQixZQUFZLFNBQVM7QUFBQSxVQUNyQixPQUFPO0FBQUEsUUFDWCxDQUFDO0FBQ0QsY0FBTSxJQUFJLFFBQU0sZUFBVSxVQUFWLG1CQUFpQixZQUFXLG9DQUFvQyxTQUFTLFFBQVE7QUFBQSxNQUNyRztBQUVBLFlBQU0sU0FBUyxNQUFNLFNBQVMsS0FBSztBQUNuQyxhQUFPLE9BQU87QUFBQSxJQUNsQixTQUFTLE9BQVA7QUFDRSxjQUFRLE1BQU0saUNBQWlDO0FBQUEsUUFDM0MsVUFBVSxVQUFVO0FBQUEsUUFDcEIsV0FBVyxVQUFVO0FBQUEsUUFDckIsT0FBTyxpQkFBaUIsUUFBUTtBQUFBLFVBQzVCLFNBQVMsTUFBTTtBQUFBLFVBQ2YsT0FBTyxNQUFNO0FBQUEsUUFDakIsSUFBSTtBQUFBLE1BQ1IsQ0FBQztBQUNELFlBQU07QUFBQSxJQUNWO0FBQUEsRUFDSjtBQUNKO0FBekdPLElBQU0saUJBQU47QUFBTSxlQUNlLG9CQUFvQixDQUFDLFFBQVEsT0FBTyxPQUFPLFFBQVEsUUFBUSxPQUFPLE9BQU8sT0FBTyxNQUFNO0FBRHJHLGVBRWUsYUFBd0M7QUFBQSxFQUM1RCxRQUFRO0FBQUEsRUFDUixPQUFPO0FBQUEsRUFDUCxPQUFPO0FBQUEsRUFDUCxRQUFRO0FBQUEsRUFDUixRQUFRO0FBQUEsRUFDUixPQUFPO0FBQUEsRUFDUCxPQUFPO0FBQUEsRUFDUCxPQUFPO0FBQUEsRUFDUCxRQUFRO0FBQ1o7OztBQ2hCSixzQkFBNEM7OztBQ1FyQyxJQUFNLDJCQUEyQixNQUFjO0FBQ2xELFNBQU87QUFDWDtBQUVPLElBQU0sbUJBQW1CLE1BQWM7QUFDMUMsUUFBTSxPQUFPLElBQUksS0FBSztBQUN0QixTQUFPLEtBQUssWUFBWSxFQUFFLE1BQU0sR0FBRyxFQUFFLENBQUMsSUFBSTtBQUM5Qzs7O0FEUk8sSUFBTSx1QkFBTixNQUE0RDtBQUFBLEVBRy9ELFlBQ1ksS0FDQSxVQUNWO0FBRlU7QUFDQTtBQUVSLFNBQUssaUJBQWlCLElBQUksZUFBZSxLQUFLLElBQUksT0FBTyxLQUFLLFNBQVMsWUFBWTtBQUFBLEVBQ3ZGO0FBQUEsRUFFQSxlQUFlLFVBQXVDO0FBQ2xELFNBQUssV0FBVztBQUNoQixTQUFLLGVBQWUsVUFBVSxTQUFTLFlBQVk7QUFBQSxFQUN2RDtBQUFBLEVBRUEsTUFBTSx1QkFBc0M7QUFDeEMsVUFBTSxhQUFhLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw0QkFBWTtBQUN0RSxRQUFJLENBQUMsWUFBWTtBQUNiLFVBQUksdUJBQU8sMEJBQTBCO0FBQ3JDO0FBQUEsSUFDSjtBQUVBLFFBQUksQ0FBQyxLQUFLLFNBQVMsY0FBYztBQUM3QixVQUFJLHVCQUFPLCtCQUErQjtBQUMxQztBQUFBLElBQ0o7QUFFQSxVQUFNLFNBQVMsV0FBVztBQUMxQixVQUFNLFVBQVUsT0FBTyxTQUFTO0FBQ2hDLFVBQU0sbUJBQW1CLHlCQUF5QjtBQUNsRCxVQUFNLGFBQWEsUUFBUSxNQUFNLGdCQUFnQjtBQUVqRCxRQUFJLENBQUMsY0FBYyxXQUFXLFdBQVcsR0FBRztBQUN4QyxVQUFJLHVCQUFPLHlDQUF5QztBQUNwRDtBQUFBLElBQ0o7QUFFQSxRQUFJLHVCQUFPLDJCQUEyQjtBQUV0QyxRQUFJLGlCQUFpQjtBQUNyQixRQUFJLFlBQVk7QUFFaEIsUUFBSTtBQUNBLGlCQUFXLGFBQWEsWUFBWTtBQUNoQyxjQUFNLFdBQVcsVUFBVSxNQUFNLEdBQUcsRUFBRTtBQUN0QyxjQUFNLE9BQU8sS0FBSyxJQUFJLGNBQWMscUJBQXFCLFVBQVUsRUFBRTtBQUVyRSxZQUFJLEVBQUUsZ0JBQWdCLHdCQUFRO0FBQzFCLGNBQUksdUJBQU8sd0JBQXdCLFVBQVU7QUFDN0Msc0JBQVk7QUFDWjtBQUFBLFFBQ0o7QUFFQSxZQUFJO0FBQ0EsZ0JBQU0sYUFBYSxNQUFNLEtBQUssZUFBZSxlQUFlLElBQUk7QUFDaEUsMkJBQWlCLGVBQWUsUUFBUSxXQUFXLFVBQVU7QUFBQSxRQUNqRSxTQUFTLE9BQVA7QUFDRSxjQUFJLHVCQUFPLHdCQUF3QixhQUFhLE1BQU0sU0FBUztBQUMvRCxzQkFBWTtBQUNaO0FBQUEsUUFDSjtBQUFBLE1BQ0o7QUFFQSxhQUFPLFNBQVMsY0FBYztBQUU5QixVQUFJLFdBQVc7QUFDWCxZQUFJLHVCQUFPLDBDQUEwQztBQUFBLE1BQ3pELE9BQU87QUFDSCxZQUFJLHVCQUFPLHNDQUFzQztBQUFBLE1BQ3JEO0FBQUEsSUFDSixTQUFTLE9BQVA7QUFDRSxVQUFJLHVCQUFPLHlCQUF5QixNQUFNLFNBQVM7QUFDbkQsY0FBUSxNQUFNLHdCQUF3QixLQUFLO0FBQUEsSUFDL0M7QUFBQSxFQUNKO0FBQ0o7OztBRWxGQSxJQUFBQyxtQkFBdUI7OztBQ0F2QixJQUFPLHdCQUFRO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FES1IsSUFBTSx1QkFBTixNQUE0RDtBQUFBLEVBQy9ELFlBQW9CLGVBQThCO0FBQTlCO0FBQUEsRUFBK0I7QUFBQSxFQUVuRCxNQUFNLFVBQ0YsU0FDQSxlQUF3QixPQUN4QixTQUNlO0FBQ2YsUUFBSTtBQUNBLFlBQU0sU0FBUyxHQUFHO0FBQUE7QUFBQSxFQUFvQjtBQUN0QyxhQUFPLE1BQU0sS0FBSyxjQUFjO0FBQUEsUUFDNUI7QUFBQSxRQUNBLGVBQWUsVUFBVTtBQUFBLE1BQzdCO0FBQUEsSUFDSixTQUFTLE9BQVA7QUFDRSxVQUFJLHdCQUFPLCtCQUErQixNQUFNLFNBQVM7QUFDekQsWUFBTTtBQUFBLElBQ1Y7QUFBQSxFQUNKO0FBQ0o7OztBRXhCQSxJQUFPLHFCQUFRO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBOzs7QUNHUixJQUFNLGNBQU4sTUFBa0I7QUFBQSxFQUNyQixZQUFvQixlQUE4QjtBQUE5QjtBQUFBLEVBQStCO0FBQUEsRUFFbkQsTUFBTSxLQUFLLGlCQUEwQztBQUNqRCxVQUFNLFNBQVMsR0FBRztBQUFBO0FBQUEsUUFBdUI7QUFBQTtBQUFBO0FBQ3pDLFdBQU8sS0FBSyxjQUFjLGtCQUFrQixNQUFNO0FBQUEsRUFDdEQ7QUFDSjs7O0FDTk8sSUFBTSxpQkFBTixNQUFxQjtBQUFBLEVBQ3hCLFlBQ1ksS0FDQSxVQUNWO0FBRlU7QUFDQTtBQUFBLEVBQ1Q7QUFBQSxFQUVILE1BQU0sYUFBYSxZQUFtQztBQUNsRCxRQUFJLENBQUUsTUFBTSxLQUFLLElBQUksTUFBTSxRQUFRLE9BQU8sVUFBVSxHQUFJO0FBQ3BELFlBQU0sS0FBSyxJQUFJLE1BQU0sYUFBYSxVQUFVO0FBQUEsSUFDaEQ7QUFBQSxFQUNKO0FBQUEsRUFFQSxtQkFBMkI7QUFDdkIsV0FBTyxpQkFBaUI7QUFBQSxFQUM1QjtBQUFBLEVBRUEsTUFBTSxzQkFBc0IsT0FBa0M7QUFDMUQsVUFBTSxTQUFTLEtBQUssSUFBSSxNQUFNLHNCQUFzQixLQUFLLFNBQVMsYUFBYTtBQUMvRSxRQUFJLENBQUM7QUFBUSxhQUFPLENBQUM7QUFFckIsVUFBTSxRQUFRLEtBQUssSUFBSSxNQUFNLGlCQUFpQixFQUN6QyxPQUFPLFVBQVEsS0FBSyxLQUFLLFdBQVcsS0FBSyxTQUFTLGdCQUFnQixHQUFHLENBQUMsRUFDdEUsS0FBSyxDQUFDLEdBQUcsTUFBTSxFQUFFLEtBQUssUUFBUSxFQUFFLEtBQUssS0FBSyxFQUMxQyxNQUFNLEdBQUcsUUFBTSxDQUFDO0FBRXJCLFVBQU0sVUFBVSxNQUFNLFFBQVE7QUFBQSxNQUMxQixNQUFNLElBQUksT0FBTSxTQUFRO0FBQ3BCLGNBQU0sVUFBVSxNQUFNLEtBQUssSUFBSSxNQUFNLEtBQUssSUFBSTtBQUM5QyxlQUFPO0FBQUEsVUFDSCxNQUFNLEtBQUs7QUFBQSxVQUNYO0FBQUEsUUFDSjtBQUFBLE1BQ0osQ0FBQztBQUFBLElBQ0w7QUFFQSxXQUFPLFFBQVEsSUFBSSxXQUFTLFNBQVMsTUFBTTtBQUFBLEVBQVMsTUFBTSxTQUFTO0FBQUEsRUFDdkU7QUFBQSxFQUVBLE1BQU0sd0JBQXdDO0FBQzFDLFVBQU0sV0FBVyxLQUFLLGlCQUFpQjtBQUN2QyxVQUFNLFdBQVcsR0FBRyxLQUFLLFNBQVMsaUJBQWlCO0FBQ25ELFVBQU0saUJBQWlCLHFCQUFxQixJQUFJLEtBQUssRUFBRSxtQkFBbUI7QUFBQTtBQUFBO0FBQzFFLFdBQU8sTUFBTSxLQUFLLElBQUksTUFBTSxPQUFPLFVBQVUsY0FBYztBQUFBLEVBQy9EO0FBQ0o7OztBQ2hEQSxJQUFPLHdCQUFRO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTs7O0FWV1IsSUFBTSxrQkFBTixNQUFnRDtBQUFBLEVBUW5ELFlBQ1ksS0FDQSxVQUNBLGVBQ1Y7QUFIVTtBQUNBO0FBQ0E7QUFFUixTQUFLLGlCQUFpQixJQUFJLGVBQWUsS0FBSyxLQUFLLEtBQUssUUFBUTtBQUNoRSxTQUFLLGlCQUFpQixJQUFJLGVBQWUsS0FBSyxJQUFJLE9BQU8sS0FBSyxTQUFTLFlBQVk7QUFDbkYsU0FBSyx1QkFBdUIsSUFBSSxxQkFBcUIsS0FBSyxhQUFhO0FBQ3ZFLFNBQUssY0FBYyxJQUFJLFlBQVksS0FBSyxhQUFhO0FBQ3JELFNBQUssdUJBQXVCLElBQUkscUJBQXFCLEtBQUssS0FBSyxLQUFLLFFBQVE7QUFBQSxFQUNoRjtBQUFBLEVBRUEsZUFBZSxVQUF1QztBQUNsRCxTQUFLLFdBQVc7QUFDaEIsU0FBSyxlQUFlLFVBQVUsU0FBUyxZQUFZO0FBQ25ELFNBQUsscUJBQXFCLGVBQWUsUUFBUTtBQUNqRCxTQUFLLGNBQWMsZUFBZSxRQUFRO0FBQUEsRUFDOUM7QUFBQSxFQUVBLE1BQU0sb0JBQW1DO0FBQ3JDLFFBQUk7QUFDQSxZQUFNLEtBQUssZUFBZSxhQUFhLEtBQUssU0FBUyxhQUFhO0FBRWxFLFlBQU0sV0FBVyxHQUFHLEtBQUssU0FBUyxpQkFBaUIsS0FBSyxlQUFlLGlCQUFpQjtBQUN4RixVQUFJLE9BQU8sS0FBSyxJQUFJLE1BQU0sc0JBQXNCLFFBQVE7QUFFeEQsVUFBSSxDQUFDLE1BQU07QUFDUCxjQUFNLGdCQUFnQixJQUFJLHdCQUFPLGdDQUFnQyxDQUFDO0FBRWxFLFlBQUk7QUFFQSxpQkFBTyxNQUFNLEtBQUssZUFBZSxzQkFBc0I7QUFHdkQsZ0JBQU0sY0FBYyxNQUFNLEtBQUssZUFBZSxzQkFBc0IsS0FBSyxTQUFTLG1CQUFtQjtBQUdyRyxnQkFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLFFBQVEsS0FBSztBQUM3QyxnQkFBTSxLQUFLLFNBQVMsSUFBYTtBQUNqQyxnQkFBTSxPQUFPLEtBQUssSUFBSSxVQUFVLG9CQUFvQiw2QkFBWTtBQUVoRSxjQUFJLE1BQU07QUFDTixnQkFBSSxLQUFLLFNBQVMsc0JBQXNCO0FBRXBDLG9CQUFNLEtBQUssY0FBYztBQUFBLGdCQUNyQixLQUFLLG9CQUFvQixXQUFXO0FBQUEsZ0JBQ3BDLENBQUMsVUFBVTtBQUNQLHdCQUFNLGlCQUFpQixLQUFLLE9BQU8sU0FBUztBQUM1Qyx1QkFBSyxPQUFPLFNBQVMsaUJBQWlCLEtBQUs7QUFBQSxnQkFDL0M7QUFBQSxjQUNKO0FBQUEsWUFDSixPQUFPO0FBRUgsb0JBQU0sV0FBVyxNQUFNLEtBQUssY0FBYztBQUFBLGdCQUN0QyxLQUFLLG9CQUFvQixXQUFXO0FBQUEsY0FDeEM7QUFDQSxtQkFBSyxPQUFPLFNBQVMsS0FBSyxPQUFPLFNBQVMsSUFBSSxRQUFRO0FBQUEsWUFDMUQ7QUFHQSxpQkFBSyxPQUFPLFNBQVMsS0FBSyxPQUFPLFNBQVMsSUFBSSxrQ0FBa0M7QUFBQSxVQUNwRjtBQUVBLHdCQUFjLEtBQUs7QUFDbkIsY0FBSSx3QkFBTyxxQ0FBcUM7QUFBQSxRQUNwRCxTQUFTLE9BQVA7QUFDRSxjQUFJLHdCQUFPLDhCQUE4QixNQUFNLE9BQU87QUFDdEQsZ0JBQU0sT0FBTyxLQUFLLElBQUksVUFBVSxvQkFBb0IsNkJBQVk7QUFDaEUsY0FBSSxNQUFNO0FBQ04saUJBQUssT0FBTyxTQUFTLEtBQUssT0FBTyxTQUFTLElBQUksa0NBQWtDO0FBQUEsVUFDcEY7QUFBQSxRQUNKO0FBQUEsTUFDSixPQUFPO0FBQ0gsY0FBTSxPQUFPLEtBQUssSUFBSSxVQUFVLFFBQVEsS0FBSztBQUM3QyxjQUFNLEtBQUssU0FBUyxJQUFhO0FBQUEsTUFDckM7QUFBQSxJQUVKLFNBQVMsT0FBUDtBQUNFLFVBQUksd0JBQU8sb0NBQXFDLE1BQU0sT0FBTztBQUM3RCxjQUFRLE1BQU0sa0NBQW1DLEtBQUs7QUFBQSxJQUMxRDtBQUFBLEVBQ0o7QUFBQSxFQUVRLG9CQUFvQixhQUErQjtBQUN2RCxVQUFNLGtCQUFrQixZQUFZLFNBQVMsSUFDdkM7QUFBQTtBQUFBLEVBQW9CLFlBQVksS0FBSyxhQUFhLE1BQ2xEO0FBRU4sV0FBTyxHQUFHO0FBQUE7QUFBQSxFQUFvQjtBQUFBLEVBQ2xDO0FBQUEsRUFFQSxNQUFNLDZCQUE0QztBQUM5QyxVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBQ3RFLFFBQUksQ0FBQyxjQUFjLENBQUMsV0FBVyxNQUFNO0FBQ2pDLFVBQUksd0JBQU8sMEJBQTBCO0FBQ3JDO0FBQUEsSUFDSjtBQUVBLFFBQUk7QUFFQSxZQUFNLGtCQUFrQixXQUFXLE9BQU8sU0FBUztBQUNuRCxZQUFNLFdBQVcsV0FBVyxLQUFLO0FBQ2pDLFlBQU0sWUFBWSxHQUFHLEtBQUssU0FBUyxnQkFBZ0I7QUFFbkQsWUFBTSxLQUFLLGVBQWUsYUFBYSxLQUFLLFNBQVMsWUFBWTtBQUNqRSxZQUFNLEtBQUssSUFBSSxNQUFNLE9BQU8sV0FBVyxlQUFlO0FBR3RELFlBQU0sS0FBSyxxQkFBcUIscUJBQXFCO0FBQ3JELFlBQU0sbUJBQW1CLFdBQVcsT0FBTyxTQUFTO0FBR3BELFlBQU0sZ0JBQWdCLGlCQUFpQixNQUFNLGdCQUFlLHdCQUF3QjtBQUNwRixVQUFJLENBQUMsZUFBZTtBQUNoQixZQUFJLHdCQUFPLHlDQUF5QztBQUNwRDtBQUFBLE1BQ0o7QUFFQSxZQUFNLGVBQWUsY0FBYyxDQUFDLEVBQUUsS0FBSztBQUMzQyxVQUFJO0FBRUosVUFBSSxLQUFLLFNBQVMsc0JBQXNCO0FBQ3BDLFlBQUksa0JBQWtCO0FBQ3RCLGtCQUFVLE1BQU0sS0FBSyxxQkFBcUI7QUFBQSxVQUN0QztBQUFBLFVBQ0E7QUFBQSxVQUNBLENBQUMsVUFBVTtBQUNQLCtCQUFtQjtBQUNuQixrQkFBTSxpQkFBaUIsaUJBQWlCO0FBQUEsY0FDcEMsZ0JBQWU7QUFBQSxjQUNmO0FBQUE7QUFBQSxFQUErQjtBQUFBLFlBQ25DO0FBQ0EsdUJBQVcsT0FBTyxTQUFTLGNBQWM7QUFBQSxVQUM3QztBQUFBLFFBQ0o7QUFBQSxNQUNKLE9BQU87QUFDSCxrQkFBVSxNQUFNLEtBQUsscUJBQXFCLFVBQVUsWUFBWTtBQUNoRSxjQUFNLGlCQUFpQixpQkFBaUI7QUFBQSxVQUNwQyxnQkFBZTtBQUFBLFVBQ2Y7QUFBQTtBQUFBLEVBQStCO0FBQUEsUUFDbkM7QUFDQSxtQkFBVyxPQUFPLFNBQVMsY0FBYztBQUFBLE1BQzdDO0FBRUEsVUFBSSx3QkFBTyw0QkFBNEI7QUFBQSxJQUUzQyxTQUFTLE9BQVA7QUFDRSxVQUFJLHdCQUFPLFVBQVUsTUFBTSxTQUFTO0FBQ3BDLGNBQVEsTUFBTSx3QkFBd0IsS0FBSztBQUFBLElBQy9DO0FBQUEsRUFDSjtBQUFBLEVBRUEsTUFBTSxhQUE0QjtBQUM5QixVQUFNLGFBQWEsS0FBSyxJQUFJLFVBQVUsb0JBQW9CLDZCQUFZO0FBQ3RFLFFBQUksQ0FBQyxZQUFZO0FBQ2IsVUFBSSx3QkFBTywwQkFBMEI7QUFDckM7QUFBQSxJQUNKO0FBRUEsUUFBSTtBQUVBLFlBQU0sS0FBSyxxQkFBcUIscUJBQXFCO0FBR3JELFlBQU0sVUFBVSxXQUFXLE9BQU8sU0FBUztBQUMzQyxZQUFNLGVBQWUsTUFBTSxLQUFLLFlBQVksS0FBSyxPQUFPO0FBR3hELGlCQUFXLE9BQU87QUFBQSxRQUNkLFVBQVUsNEJBQTRCLGVBQWU7QUFBQSxNQUN6RDtBQUVBLFVBQUksd0JBQU8sc0JBQXNCO0FBQUEsSUFDckMsU0FBUyxPQUFQO0FBQ0UsVUFBSSx3QkFBTyxzQkFBc0IsTUFBTSxTQUFTO0FBQUEsSUFDcEQ7QUFBQSxFQUNKO0FBQ0o7QUF6TE8sSUFBTSxpQkFBTjtBQUFNLGVBQ2UsMkJBQTJCOzs7QVdSaEQsSUFBTSxnQkFBTixNQUE4QztBQUFBLEVBQ2pELFlBQW9CLFVBQXVDO0FBQXZDO0FBQUEsRUFBd0M7QUFBQSxFQUU1RCxlQUFlLFVBQXVDO0FBQ2xELFNBQUssV0FBVztBQUFBLEVBQ3BCO0FBQUEsRUFFQSxNQUFNLGtCQUFrQixRQUFnQixTQUFvRDtBQVhoRztBQVlRLFFBQUksQ0FBQyxLQUFLLFNBQVMsY0FBYztBQUM3QixZQUFNLElBQUksTUFBTSwrQkFBK0I7QUFBQSxJQUNuRDtBQUVBLFFBQUk7QUFDQSxZQUFNLFdBQVcsTUFBTSxNQUFNLDhDQUE4QztBQUFBLFFBQ3ZFLFFBQVE7QUFBQSxRQUNSLFNBQVM7QUFBQSxVQUNMLGlCQUFpQixVQUFVLEtBQUssU0FBUztBQUFBLFVBQ3pDLGdCQUFnQjtBQUFBLFFBQ3BCO0FBQUEsUUFDQSxNQUFNLEtBQUssVUFBVTtBQUFBLFVBQ2pCLE9BQU87QUFBQSxVQUNQLFVBQVUsQ0FBQyxFQUFFLE1BQU0sUUFBUSxTQUFTLE9BQU8sQ0FBQztBQUFBLFVBQzVDLGFBQWE7QUFBQSxVQUNiLFFBQVEsQ0FBQyxDQUFDO0FBQUEsUUFDZCxDQUFDO0FBQUEsTUFDTCxDQUFDO0FBRUQsVUFBSSxDQUFDLFNBQVMsSUFBSTtBQUNkLGNBQU0sUUFBUSxNQUFNLFNBQVMsS0FBSztBQUNsQyxjQUFNLElBQUksUUFBTSxXQUFNLFVBQU4sbUJBQWEsWUFBVyxvQkFBb0I7QUFBQSxNQUNoRTtBQUVBLFVBQUksU0FBUztBQUNULGNBQU0sVUFBUyxjQUFTLFNBQVQsbUJBQWU7QUFDOUIsY0FBTSxVQUFVLElBQUksWUFBWTtBQUNoQyxZQUFJLGVBQWU7QUFFbkIsWUFBSSxDQUFDO0FBQVEsZ0JBQU0sSUFBSSxNQUFNLHVCQUF1QjtBQUVwRCxlQUFPLE1BQU07QUFDVCxnQkFBTSxFQUFFLE1BQU0sTUFBTSxJQUFJLE1BQU0sT0FBTyxLQUFLO0FBQzFDLGNBQUk7QUFBTTtBQUVWLGdCQUFNLFFBQVEsUUFBUSxPQUFPLEtBQUs7QUFDbEMsZ0JBQU0sUUFBUSxNQUFNLE1BQU0sSUFBSSxFQUFFLE9BQU8sVUFBUSxLQUFLLEtBQUssTUFBTSxFQUFFO0FBRWpFLHFCQUFXLFFBQVEsT0FBTztBQUN0QixnQkFBSSxLQUFLLFNBQVMsUUFBUTtBQUFHO0FBQzdCLGdCQUFJLENBQUMsS0FBSyxXQUFXLE9BQU87QUFBRztBQUUvQixnQkFBSTtBQUNBLG9CQUFNLE9BQU8sS0FBSyxNQUFNLEtBQUssTUFBTSxDQUFDLENBQUM7QUFDckMsb0JBQU0sV0FBVSxnQkFBSyxRQUFRLENBQUMsTUFBZCxtQkFBaUIsVUFBakIsbUJBQXdCO0FBQ3hDLGtCQUFJLFNBQVM7QUFDVCxnQ0FBZ0I7QUFDaEIsd0JBQVEsT0FBTztBQUFBLGNBQ25CO0FBQUEsWUFDSixTQUFTLEdBQVA7QUFDRSxzQkFBUSxLQUFLLHVDQUF1QyxDQUFDO0FBQUEsWUFDekQ7QUFBQSxVQUNKO0FBQUEsUUFDSjtBQUVBLGVBQU87QUFBQSxNQUNYO0FBRUEsWUFBTSxPQUFPLE1BQU0sU0FBUyxLQUFLO0FBQ2pDLGFBQU8sS0FBSyxRQUFRLENBQUMsRUFBRSxRQUFRO0FBQUEsSUFDbkMsU0FBUyxPQUFQO0FBQ0UsY0FBUSxNQUFNLHFCQUFxQixLQUFLO0FBQ3hDLFlBQU07QUFBQSxJQUNWO0FBQUEsRUFDSjtBQUNKOzs7QUM3RUEsSUFBQUMsbUJBQStDO0FBR3hDLElBQU0sZ0NBQU4sY0FBNEMsa0NBQWlCO0FBQUEsRUFDaEUsWUFBWSxLQUFrQixRQUFtQztBQUM3RCxVQUFNLEtBQUssTUFBTTtBQURTO0FBQUEsRUFFOUI7QUFBQSxFQUVBLFVBQWdCO0FBQ1osVUFBTSxFQUFFLFlBQVksSUFBSTtBQUN4QixnQkFBWSxNQUFNO0FBRWxCLGdCQUFZLFNBQVMsTUFBTSxFQUFFLE1BQU0sZ0NBQWdDLENBQUM7QUFFcEUsUUFBSSx5QkFBUSxXQUFXLEVBQ2xCLFFBQVEsZ0JBQWdCLEVBQ3hCLFFBQVEsc0RBQXNELEVBQzlELFFBQVEsVUFBUSxLQUNaLGVBQWUsU0FBUyxFQUN4QixTQUFTLEtBQUssT0FBTyxTQUFTLGFBQWEsRUFDM0MsU0FBUyxPQUFPLFVBQVU7QUFDdkIsV0FBSyxPQUFPLFNBQVMsZ0JBQWdCO0FBQ3JDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHlCQUFRLFdBQVcsRUFDbEIsUUFBUSx1QkFBdUIsRUFDL0IsUUFBUSxxREFBcUQsRUFDN0QsUUFBUSxVQUFRLEtBQ1osZUFBZSxRQUFRLEVBQ3ZCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxFQUMxQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHlCQUFRLFdBQVcsRUFDbEIsUUFBUSxnQkFBZ0IsRUFDeEIsUUFBUSwwREFBMEQsRUFDbEUsUUFBUSxVQUFRLEtBQ1osZUFBZSxRQUFRLEVBQ3ZCLFNBQVMsS0FBSyxPQUFPLFNBQVMsWUFBWSxFQUMxQyxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyxlQUFlO0FBQ3BDLFlBQU0sS0FBSyxPQUFPLGFBQWE7QUFBQSxJQUNuQyxDQUFDLENBQUM7QUFFVixRQUFJLHlCQUFRLFdBQVcsRUFDbEIsUUFBUSx3QkFBd0IsRUFDaEMsUUFBUSxvRUFBb0UsRUFDNUUsVUFBVSxZQUFVLE9BQ2hCLFVBQVUsR0FBRyxJQUFJLENBQUMsRUFDbEIsU0FBUyxLQUFLLE9BQU8sU0FBUyxtQkFBbUIsRUFDakQsa0JBQWtCLEVBQ2xCLFNBQVMsT0FBTyxVQUFVO0FBQ3ZCLFdBQUssT0FBTyxTQUFTLHNCQUFzQjtBQUMzQyxZQUFNLEtBQUssT0FBTyxhQUFhO0FBQUEsSUFDbkMsQ0FBQyxDQUFDO0FBRVYsUUFBSSx5QkFBUSxXQUFXLEVBQ2xCLFFBQVEsd0JBQXdCLEVBQ2hDLFFBQVEsc0VBQXNFLEVBQzlFLFVBQVUsWUFBVSxPQUNoQixTQUFTLEtBQUssT0FBTyxTQUFTLG9CQUFvQixFQUNsRCxTQUFTLE9BQU8sVUFBVTtBQUN2QixXQUFLLE9BQU8sU0FBUyx1QkFBdUI7QUFDNUMsWUFBTSxLQUFLLE9BQU8sYUFBYTtBQUFBLElBQ25DLENBQUMsQ0FBQztBQUFBLEVBQ2Q7QUFDSjs7O0FkOURPLElBQU0sNEJBQU4sY0FBd0Msd0JBQU87QUFBQSxFQU1sRCxNQUFNLFNBQVM7QUFDWCxVQUFNLEtBQUssYUFBYTtBQUd4QixTQUFLLGdCQUFnQixJQUFJLGNBQWMsS0FBSyxRQUFRO0FBQ3BELFNBQUssdUJBQXVCLElBQUkscUJBQXFCLEtBQUssS0FBSyxLQUFLLFFBQVE7QUFDNUUsU0FBSyxpQkFBaUIsSUFBSTtBQUFBLE1BQ3RCLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxNQUNMLEtBQUs7QUFBQSxJQUNUO0FBR0EsU0FBSyxjQUFjLElBQUksOEJBQThCLEtBQUssS0FBSyxJQUFJLENBQUM7QUFHcEUsU0FBSyxjQUFjLE9BQU8sd0JBQXdCLENBQUMsUUFBbUM7QUFDbEYsWUFBTSxPQUFPLElBQUksc0JBQUs7QUFDdEIsV0FBSztBQUFBLFFBQVEsQ0FBQyxTQUNWLEtBQ0ssU0FBUyxzQkFBc0IsRUFDL0IsUUFBUSxlQUFlLEVBQ3ZCLFFBQVEsTUFBTTtBQUNYLGVBQUssZUFBZSxrQkFBa0I7QUFBQSxRQUMxQyxDQUFDO0FBQUEsTUFDVDtBQUNBLFdBQUs7QUFBQSxRQUFRLENBQUMsU0FDVixLQUNLLFNBQVMsY0FBYyxFQUN2QixRQUFRLGdCQUFnQixFQUN4QixRQUFRLE1BQU07QUFDWCxlQUFLLGVBQWUsV0FBVztBQUFBLFFBQ25DLENBQUM7QUFBQSxNQUNUO0FBQ0EsV0FBSztBQUFBLFFBQVEsQ0FBQyxTQUNWLEtBQ0ssU0FBUyw4QkFBOEIsRUFDdkMsUUFBUSxNQUFNLEVBQ2QsUUFBUSxNQUFNO0FBQ1gsZUFBSyxlQUFlLDJCQUEyQjtBQUFBLFFBQ25ELENBQUM7QUFBQSxNQUNUO0FBQ0EsV0FBSyxpQkFBaUIsR0FBRztBQUFBLElBQzdCLENBQUM7QUFFRCxTQUFLLFlBQVk7QUFBQSxFQUNyQjtBQUFBLEVBRVEsY0FBYztBQUVsQixTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsWUFBWTtBQUNsQixjQUFNLEtBQUssZUFBZSxrQkFBa0I7QUFBQSxNQUNoRDtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxZQUFZO0FBQ2xCLGNBQU0sS0FBSyxxQkFBcUIscUJBQXFCO0FBQUEsTUFDekQ7QUFBQSxJQUNKLENBQUM7QUFHRCxTQUFLLFdBQVc7QUFBQSxNQUNaLElBQUk7QUFBQSxNQUNKLE1BQU07QUFBQSxNQUNOLFVBQVUsWUFBWTtBQUNsQixjQUFNLEtBQUssZUFBZSwyQkFBMkI7QUFBQSxNQUN6RDtBQUFBLElBQ0osQ0FBQztBQUdELFNBQUssV0FBVztBQUFBLE1BQ1osSUFBSTtBQUFBLE1BQ0osTUFBTTtBQUFBLE1BQ04sVUFBVSxZQUFZO0FBQ2xCLGNBQU0sS0FBSyxlQUFlLFdBQVc7QUFBQSxNQUN6QztBQUFBLElBQ0osQ0FBQztBQUFBLEVBQ0w7QUFBQSxFQUVBLE1BQU0sZUFBZTtBQUNqQixVQUFNLE9BQU8sTUFBTSxLQUFLLFNBQVM7QUFDakMsU0FBSyxXQUFXLE9BQU8sT0FBTyxDQUFDLEdBQUcsa0JBQWtCLElBQUk7QUFBQSxFQUM1RDtBQUFBLEVBRUEsTUFBTSxlQUFlO0FBQ2pCLFVBQU0sS0FBSyxTQUFTLEtBQUssUUFBUTtBQUVqQyxTQUFLLGNBQWMsZUFBZSxLQUFLLFFBQVE7QUFDL0MsU0FBSyxxQkFBcUIsZUFBZSxLQUFLLFFBQVE7QUFDdEQsU0FBSyxlQUFlLGVBQWUsS0FBSyxRQUFRO0FBQUEsRUFDcEQ7QUFBQSxFQUVBLFdBQVc7QUFDUCxZQUFRLElBQUksMENBQTBDO0FBQUEsRUFDMUQ7QUFDSjtBQUVBLElBQU8sZUFBUTsiLAogICJuYW1lcyI6IFsiaW1wb3J0X29ic2lkaWFuIiwgImltcG9ydF9vYnNpZGlhbiIsICJtaW1lVHlwZSIsICJpbXBvcnRfb2JzaWRpYW4iLCAiaW1wb3J0X29ic2lkaWFuIl0KfQo=
